{"version":3,"sources":["../src/schemas/index.ts","../src/routes/api-content-crud.ts","../src/routes/api.ts","../src/routes/api-media.ts","../src/routes/api-system.ts","../src/routes/admin-api.ts","../src/templates/pages/auth-login.template.ts","../src/templates/pages/auth-register.template.ts","../src/services/auth-validation.ts","../src/routes/auth.ts","../src/routes/test-cleanup.ts","../src/templates/pages/admin-content-form.template.ts","../src/templates/pages/admin-content-list.template.ts","../src/templates/components/version-history.template.ts","../src/content-types.ts","../src/routes/admin-content.ts","../src/templates/pages/admin-profile.template.ts","../src/templates/components/alert.template.ts","../src/templates/pages/admin-activity-logs.template.ts","../src/templates/pages/admin-user-edit.template.ts","../src/templates/components/confirmation-dialog.template.ts","../src/templates/pages/admin-user-new.template.ts","../src/templates/pages/admin-users-list.template.ts","../src/routes/admin-users.ts","../src/templates/pages/admin-logs-list.template.ts","../src/templates/pages/admin-log-details.template.ts","../src/templates/pages/admin-log-config.template.ts","../src/routes/admin-logs.ts","../src/templates/pages/admin-dashboard.template.ts","../src/routes/admin-dashboard.ts","../src/templates/pages/admin-settings.template.ts","../src/routes/admin-settings.ts","../src/routes/index.ts"],"names":["Hono","requireAuth","getCacheService","CACHE_CONFIGS","isPluginActive","cors","QueryFilterBuilder","z","requireRole","MigrationService","renderAlert","error","AuthManager","setCookie","html","passwordHash","c","init_admin_layout_catalyst_template","escapeHtml","renderConfirmationDialog","getConfirmationDialogScript","renderAdminLayoutCatalyst","renderTable","renderPagination","renderAdminLayout","sanitizeInput","logActivity","adminLayoutV2","getLogger","getCoreVersion","metricsTracker","SettingsService"],"mappings":"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O1B,SAAS,CAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA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","file":"chunk-QMGOE3O5.cjs","sourcesContent":["/**\n * Schema Definitions\n *\n * Placeholder for schema definitions - to be populated as needed\n */\n\nexport interface SchemaDefinition {\n  name: string\n  fields: any[]\n}\n\n// Empty array for now - schemas will be migrated incrementally\nexport const schemaDefinitions: SchemaDefinition[] = []\n","import { Hono } from 'hono'\nimport { requireAuth } from '../middleware'\nimport { getCacheService, CACHE_CONFIGS } from '../services'\nimport type { Bindings, Variables } from '../app'\n\nconst apiContentCrudRoutes = new Hono<{ Bindings: Bindings; Variables: Variables }>()\n\n// GET /api/content/check-slug - Check if slug is available in collection\n// Query params: collectionId, slug, excludeId (optional - when editing)\n// NOTE: This MUST come before /:id route to avoid route conflict\napiContentCrudRoutes.get('/check-slug', async (c) => {\n  try {\n    const db = c.env.DB\n    const collectionId = c.req.query('collectionId')\n    const slug = c.req.query('slug')\n    const excludeId = c.req.query('excludeId') // When editing, exclude current item\n    \n    if (!collectionId || !slug) {\n      return c.json({ error: 'collectionId and slug are required' }, 400)\n    }\n    \n    // Check for existing content with this slug in the collection\n    let query = 'SELECT id FROM content WHERE collection_id = ? AND slug = ?'\n    const params: string[] = [collectionId, slug]\n    \n    if (excludeId) {\n      query += ' AND id != ?'\n      params.push(excludeId)\n    }\n    \n    const existing = await db.prepare(query).bind(...params).first()\n    \n    if (existing) {\n      return c.json({ \n        available: false, \n        message: 'This URL slug is already in use in this collection' \n      })\n    }\n    \n    return c.json({ available: true })\n  } catch (error: unknown) {\n    console.error('Error checking slug:', error)\n    return c.json({ \n      error: 'Failed to check slug availability',\n      details: error instanceof Error ? error.message : String(error)\n    }, 500)\n  }\n})\n\n// GET /api/content/:id - Get single content item by ID\napiContentCrudRoutes.get('/:id', async (c) => {\n  try {\n    const id = c.req.param('id')\n    const db = c.env.DB\n\n    const stmt = db.prepare('SELECT * FROM content WHERE id = ?')\n    const content = await stmt.bind(id).first()\n\n    if (!content) {\n      return c.json({ error: 'Content not found' }, 404)\n    }\n\n    const transformedContent = {\n      id: (content as any).id,\n      title: (content as any).title,\n      slug: (content as any).slug,\n      status: (content as any).status,\n      collectionId: (content as any).collection_id,\n      data: (content as any).data ? JSON.parse((content as any).data) : {},\n      created_at: (content as any).created_at,\n      updated_at: (content as any).updated_at\n    }\n\n    return c.json({ data: transformedContent })\n  } catch (error) {\n    console.error('Error fetching content:', error)\n    return c.json({\n      error: 'Failed to fetch content',\n      details: error instanceof Error ? error.message : String(error)\n    }, 500)\n  }\n})\n\n// POST /api/content - Create new content (requires authentication)\napiContentCrudRoutes.post('/', requireAuth(), async (c) => {\n  try {\n    const db = c.env.DB\n    const user = c.get('user')\n    const body = await c.req.json()\n\n    const { collectionId, title, slug, status, data } = body\n\n    // Validate required fields\n    if (!collectionId) {\n      return c.json({ error: 'collectionId is required' }, 400)\n    }\n\n    if (!title) {\n      return c.json({ error: 'title is required' }, 400)\n    }\n\n    // Generate slug from title if not provided\n    let finalSlug = slug || title\n    finalSlug = finalSlug.toLowerCase()\n      .replace(/[^a-z0-9\\s-]/g, '')\n      .replace(/\\s+/g, '-')\n      .replace(/-+/g, '-')\n      .trim()\n\n    // Check for duplicate slug within the same collection\n    const duplicateCheck = db.prepare(\n      'SELECT id FROM content WHERE collection_id = ? AND slug = ?'\n    )\n    const existing = await duplicateCheck.bind(collectionId, finalSlug).first()\n\n    if (existing) {\n      return c.json({ error: 'A content item with this slug already exists in this collection' }, 409)\n    }\n\n    // Create new content\n    const contentId = crypto.randomUUID()\n    const now = Date.now()\n\n    const insertStmt = db.prepare(`\n      INSERT INTO content (\n        id, collection_id, slug, title, data, status,\n        author_id, created_at, updated_at\n      )\n      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n    `)\n\n    await insertStmt.bind(\n      contentId,\n      collectionId,\n      finalSlug,\n      title,\n      JSON.stringify(data || {}),\n      status || 'draft',\n      user?.userId || 'system',\n      now,\n      now\n    ).run()\n\n    // Invalidate cache\n    const cache = getCacheService(CACHE_CONFIGS.api!)\n    await cache.invalidate(`content:list:${collectionId}:*`)\n    await cache.invalidate('content-filtered:*')\n\n    // Get the created content\n    const getStmt = db.prepare('SELECT * FROM content WHERE id = ?')\n    const createdContent = await getStmt.bind(contentId).first() as any\n\n    return c.json({\n      data: {\n        id: createdContent.id,\n        title: createdContent.title,\n        slug: createdContent.slug,\n        status: createdContent.status,\n        collectionId: createdContent.collection_id,\n        data: createdContent.data ? JSON.parse(createdContent.data) : {},\n        created_at: createdContent.created_at,\n        updated_at: createdContent.updated_at\n      }\n    }, 201)\n  } catch (error) {\n    console.error('Error creating content:', error)\n    return c.json({\n      error: 'Failed to create content',\n      details: error instanceof Error ? error.message : String(error)\n    }, 500)\n  }\n})\n\n// PUT /api/content/:id - Update content (requires authentication)\napiContentCrudRoutes.put('/:id', requireAuth(), async (c) => {\n  try {\n    const id = c.req.param('id')\n    const db = c.env.DB\n    const body = await c.req.json()\n\n    // Check if content exists\n    const existingStmt = db.prepare('SELECT * FROM content WHERE id = ?')\n    const existing = await existingStmt.bind(id).first() as any\n\n    if (!existing) {\n      return c.json({ error: 'Content not found' }, 404)\n    }\n\n    // Build update fields dynamically\n    const updates: string[] = []\n    const params: any[] = []\n\n    if (body.title !== undefined) {\n      updates.push('title = ?')\n      params.push(body.title)\n    }\n\n    if (body.slug !== undefined) {\n      let finalSlug = body.slug.toLowerCase()\n        .replace(/[^a-z0-9\\s-]/g, '')\n        .replace(/\\s+/g, '-')\n        .replace(/-+/g, '-')\n        .trim()\n      updates.push('slug = ?')\n      params.push(finalSlug)\n    }\n\n    if (body.status !== undefined) {\n      updates.push('status = ?')\n      params.push(body.status)\n    }\n\n    if (body.data !== undefined) {\n      updates.push('data = ?')\n      params.push(JSON.stringify(body.data))\n    }\n\n    // Always update updated_at\n    const now = Date.now()\n    updates.push('updated_at = ?')\n    params.push(now)\n\n    // Add id to params for WHERE clause\n    params.push(id)\n\n    // Execute update\n    const updateStmt = db.prepare(`\n      UPDATE content SET ${updates.join(', ')}\n      WHERE id = ?\n    `)\n\n    await updateStmt.bind(...params).run()\n\n    // Invalidate cache\n    const cache = getCacheService(CACHE_CONFIGS.api!)\n    await cache.delete(cache.generateKey('content', id))\n    await cache.invalidate(`content:list:${existing.collection_id}:*`)\n    await cache.invalidate('content-filtered:*')\n\n    // Get updated content\n    const getStmt = db.prepare('SELECT * FROM content WHERE id = ?')\n    const updatedContent = await getStmt.bind(id).first() as any\n\n    return c.json({\n      data: {\n        id: updatedContent.id,\n        title: updatedContent.title,\n        slug: updatedContent.slug,\n        status: updatedContent.status,\n        collectionId: updatedContent.collection_id,\n        data: updatedContent.data ? JSON.parse(updatedContent.data) : {},\n        created_at: updatedContent.created_at,\n        updated_at: updatedContent.updated_at\n      }\n    })\n  } catch (error) {\n    console.error('Error updating content:', error)\n    return c.json({\n      error: 'Failed to update content',\n      details: error instanceof Error ? error.message : String(error)\n    }, 500)\n  }\n})\n\n// DELETE /api/content/:id - Delete content (requires authentication)\napiContentCrudRoutes.delete('/:id', requireAuth(), async (c) => {\n  try {\n    const id = c.req.param('id')\n    const db = c.env.DB\n\n    // Check if content exists\n    const existingStmt = db.prepare('SELECT collection_id FROM content WHERE id = ?')\n    const existing = await existingStmt.bind(id).first() as any\n\n    if (!existing) {\n      return c.json({ error: 'Content not found' }, 404)\n    }\n\n    // Delete the content (hard delete for API, soft delete happens in admin routes)\n    const deleteStmt = db.prepare('DELETE FROM content WHERE id = ?')\n    await deleteStmt.bind(id).run()\n\n    // Invalidate cache\n    const cache = getCacheService(CACHE_CONFIGS.api!)\n    await cache.delete(cache.generateKey('content', id))\n    await cache.invalidate(`content:list:${existing.collection_id}:*`)\n    await cache.invalidate('content-filtered:*')\n\n    return c.json({ success: true })\n  } catch (error) {\n    console.error('Error deleting content:', error)\n    return c.json({\n      error: 'Failed to delete content',\n      details: error instanceof Error ? error.message : String(error)\n    }, 500)\n  }\n})\n\nexport default apiContentCrudRoutes\n","import { Hono } from 'hono'\nimport { cors } from 'hono/cors'\nimport { schemaDefinitions } from '../schemas'\nimport { getCacheService, CACHE_CONFIGS } from '../services'\nimport { QueryFilterBuilder, QueryFilter } from '../utils'\nimport { isPluginActive } from '../middleware'\nimport apiContentCrudRoutes from './api-content-crud'\nimport type { Bindings, Variables as AppVariables } from '../app'\n\n// Extend Variables with API-specific fields\ninterface Variables extends AppVariables {\n  startTime: number\n  cacheEnabled?: boolean\n}\n\nconst apiRoutes = new Hono<{ Bindings: Bindings; Variables: Variables }>()\n\n// Add timing middleware\napiRoutes.use('*', async (c, next) => {\n  const startTime = Date.now()\n  c.set('startTime', startTime)\n  await next()\n  const totalTime = Date.now() - startTime\n  c.header('X-Response-Time', `${totalTime}ms`)\n})\n\n// Check if cache plugin is active\napiRoutes.use('*', async (c, next) => {\n  const cacheEnabled = await isPluginActive(c.env.DB, 'core-cache')\n  c.set('cacheEnabled', cacheEnabled)\n  await next()\n})\n\n// Add CORS middleware\napiRoutes.use('*', cors({\n  origin: '*',\n  allowMethods: ['GET', 'POST', 'PUT', 'DELETE', 'OPTIONS'],\n  allowHeaders: ['Content-Type', 'Authorization']\n}))\n\n// Helper function to add timing metadata\nfunction addTimingMeta(c: any, meta: any = {}, executionStartTime?: number) {\n  const totalTime = Date.now() - c.get('startTime')\n  const executionTime = executionStartTime ? Date.now() - executionStartTime : undefined\n\n  return {\n    ...meta,\n    timing: {\n      total: totalTime,\n      execution: executionTime,\n      unit: 'ms'\n    }\n  }\n}\n\n// Root endpoint - OpenAPI 3.0.0 specification\napiRoutes.get('/', (c) => {\n  const baseUrl = new URL(c.req.url)\n  const serverUrl = `${baseUrl.protocol}//${baseUrl.host}`\n\n  return c.json({\n    openapi: '3.0.0',\n    info: {\n      title: 'WarpCMS API',\n      version: '0.1.0',\n      description: 'RESTful API for WarpCMS headless CMS - a modern, edge-first content management system built on Cloudflare Workers',\n      contact: {\n        name: 'WarpCMS Support',\n        url: `${serverUrl}/docs`,\n        email: 'support@warpcms.dev'\n      },\n      license: {\n        name: 'MIT',\n        url: 'https://opensource.org/licenses/MIT'\n      }\n    },\n    servers: [\n      {\n        url: serverUrl,\n        description: 'Current server'\n      }\n    ],\n    paths: {\n      '/api/': {\n        get: {\n          summary: 'API Information',\n          description: 'Returns OpenAPI specification for the WarpCMS API',\n          operationId: 'getApiInfo',\n          tags: ['System'],\n          responses: {\n            '200': {\n              description: 'OpenAPI specification',\n              content: {\n                'application/json': {\n                  schema: { type: 'object' }\n                }\n              }\n            }\n          }\n        }\n      },\n      '/api/health': {\n        get: {\n          summary: 'Health Check',\n          description: 'Returns API health status and available schemas',\n          operationId: 'getHealth',\n          tags: ['System'],\n          responses: {\n            '200': {\n              description: 'Health status',\n              content: {\n                'application/json': {\n                  schema: {\n                    type: 'object',\n                    properties: {\n                      status: { type: 'string', example: 'healthy' },\n                      timestamp: { type: 'string', format: 'date-time' },\n                      schemas: { type: 'array', items: { type: 'string' } }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      },\n      '/api/collections': {\n        get: {\n          summary: 'List Collections',\n          description: 'Returns all active collections with their schemas',\n          operationId: 'getCollections',\n          tags: ['Content'],\n          responses: {\n            '200': {\n              description: 'List of collections',\n              content: {\n                'application/json': {\n                  schema: {\n                    type: 'object',\n                    properties: {\n                      data: {\n                        type: 'array',\n                        items: {\n                          type: 'object',\n                          properties: {\n                            id: { type: 'string' },\n                            name: { type: 'string' },\n                            display_name: { type: 'string' },\n                            schema: { type: 'object' },\n                            is_active: { type: 'integer' }\n                          }\n                        }\n                      },\n                      meta: { type: 'object' }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      },\n      '/api/collections/{collection}/content': {\n        get: {\n          summary: 'Get Collection Content',\n          description: 'Returns content items from a specific collection with filtering support',\n          operationId: 'getCollectionContent',\n          tags: ['Content'],\n          parameters: [\n            {\n              name: 'collection',\n              in: 'path',\n              required: true,\n              schema: { type: 'string' },\n              description: 'Collection name'\n            },\n            {\n              name: 'limit',\n              in: 'query',\n              schema: { type: 'integer', default: 50, maximum: 1000 },\n              description: 'Maximum number of items to return'\n            },\n            {\n              name: 'offset',\n              in: 'query',\n              schema: { type: 'integer', default: 0 },\n              description: 'Number of items to skip'\n            },\n            {\n              name: 'status',\n              in: 'query',\n              schema: { type: 'string', enum: ['draft', 'published', 'archived'] },\n              description: 'Filter by content status'\n            }\n          ],\n          responses: {\n            '200': {\n              description: 'List of content items',\n              content: {\n                'application/json': {\n                  schema: {\n                    type: 'object',\n                    properties: {\n                      data: { type: 'array', items: { type: 'object' } },\n                      meta: { type: 'object' }\n                    }\n                  }\n                }\n              }\n            },\n            '404': {\n              description: 'Collection not found'\n            }\n          }\n        }\n      },\n      '/api/content': {\n        get: {\n          summary: 'List Content',\n          description: 'Returns content items with advanced filtering support',\n          operationId: 'getContent',\n          tags: ['Content'],\n          parameters: [\n            {\n              name: 'collection',\n              in: 'query',\n              schema: { type: 'string' },\n              description: 'Filter by collection name'\n            },\n            {\n              name: 'limit',\n              in: 'query',\n              schema: { type: 'integer', default: 50, maximum: 1000 },\n              description: 'Maximum number of items to return'\n            },\n            {\n              name: 'offset',\n              in: 'query',\n              schema: { type: 'integer', default: 0 },\n              description: 'Number of items to skip'\n            }\n          ],\n          responses: {\n            '200': {\n              description: 'List of content items',\n              content: {\n                'application/json': {\n                  schema: {\n                    type: 'object',\n                    properties: {\n                      data: { type: 'array', items: { type: 'object' } },\n                      meta: { type: 'object' }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        post: {\n          summary: 'Create Content',\n          description: 'Creates a new content item',\n          operationId: 'createContent',\n          tags: ['Content'],\n          security: [{ bearerAuth: [] }],\n          requestBody: {\n            required: true,\n            content: {\n              'application/json': {\n                schema: {\n                  type: 'object',\n                  required: ['collection_id', 'title'],\n                  properties: {\n                    collection_id: { type: 'string' },\n                    title: { type: 'string' },\n                    slug: { type: 'string' },\n                    status: { type: 'string', enum: ['draft', 'published', 'archived'] },\n                    data: { type: 'object' }\n                  }\n                }\n              }\n            }\n          },\n          responses: {\n            '201': { description: 'Content created successfully' },\n            '400': { description: 'Invalid request body' },\n            '401': { description: 'Unauthorized' }\n          }\n        }\n      },\n      '/api/content/{id}': {\n        get: {\n          summary: 'Get Content by ID',\n          description: 'Returns a specific content item by ID',\n          operationId: 'getContentById',\n          tags: ['Content'],\n          parameters: [\n            {\n              name: 'id',\n              in: 'path',\n              required: true,\n              schema: { type: 'string' },\n              description: 'Content item ID'\n            }\n          ],\n          responses: {\n            '200': { description: 'Content item' },\n            '404': { description: 'Content not found' }\n          }\n        },\n        put: {\n          summary: 'Update Content',\n          description: 'Updates an existing content item',\n          operationId: 'updateContent',\n          tags: ['Content'],\n          security: [{ bearerAuth: [] }],\n          parameters: [\n            {\n              name: 'id',\n              in: 'path',\n              required: true,\n              schema: { type: 'string' },\n              description: 'Content item ID'\n            }\n          ],\n          responses: {\n            '200': { description: 'Content updated successfully' },\n            '401': { description: 'Unauthorized' },\n            '404': { description: 'Content not found' }\n          }\n        },\n        delete: {\n          summary: 'Delete Content',\n          description: 'Deletes a content item',\n          operationId: 'deleteContent',\n          tags: ['Content'],\n          security: [{ bearerAuth: [] }],\n          parameters: [\n            {\n              name: 'id',\n              in: 'path',\n              required: true,\n              schema: { type: 'string' },\n              description: 'Content item ID'\n            }\n          ],\n          responses: {\n            '200': { description: 'Content deleted successfully' },\n            '401': { description: 'Unauthorized' },\n            '404': { description: 'Content not found' }\n          }\n        }\n      },\n      '/api/media': {\n        get: {\n          summary: 'List Media',\n          description: 'Returns all media files with pagination',\n          operationId: 'getMedia',\n          tags: ['Media'],\n          responses: {\n            '200': { description: 'List of media files' }\n          }\n        }\n      },\n      '/api/media/upload': {\n        post: {\n          summary: 'Upload Media',\n          description: 'Uploads a new media file to R2 storage',\n          operationId: 'uploadMedia',\n          tags: ['Media'],\n          security: [{ bearerAuth: [] }],\n          requestBody: {\n            required: true,\n            content: {\n              'multipart/form-data': {\n                schema: {\n                  type: 'object',\n                  properties: {\n                    file: { type: 'string', format: 'binary' }\n                  }\n                }\n              }\n            }\n          },\n          responses: {\n            '201': { description: 'Media uploaded successfully' },\n            '401': { description: 'Unauthorized' }\n          }\n        }\n      }\n    },\n    components: {\n      securitySchemes: {\n        bearerAuth: {\n          type: 'http',\n          scheme: 'bearer',\n          bearerFormat: 'JWT'\n        }\n      },\n      schemas: {\n        Content: {\n          type: 'object',\n          properties: {\n            id: { type: 'string', format: 'uuid' },\n            title: { type: 'string' },\n            slug: { type: 'string' },\n            status: { type: 'string', enum: ['draft', 'published', 'archived'] },\n            collectionId: { type: 'string', format: 'uuid' },\n            data: { type: 'object' },\n            created_at: { type: 'integer' },\n            updated_at: { type: 'integer' }\n          }\n        },\n        Collection: {\n          type: 'object',\n          properties: {\n            id: { type: 'string', format: 'uuid' },\n            name: { type: 'string' },\n            display_name: { type: 'string' },\n            description: { type: 'string' },\n            schema: { type: 'object' },\n            is_active: { type: 'integer' }\n          }\n        },\n        Media: {\n          type: 'object',\n          properties: {\n            id: { type: 'string', format: 'uuid' },\n            filename: { type: 'string' },\n            mimetype: { type: 'string' },\n            size: { type: 'integer' },\n            url: { type: 'string' }\n          }\n        },\n        Error: {\n          type: 'object',\n          properties: {\n            error: { type: 'string' },\n            details: { type: 'string' }\n          }\n        }\n      }\n    },\n    tags: [\n      { name: 'System', description: 'System and health endpoints' },\n      { name: 'Content', description: 'Content management operations' },\n      { name: 'Media', description: 'Media file operations' }\n    ]\n  })\n})\n\n// Health check endpoint\napiRoutes.get('/health', (c) => {\n  return c.json({\n    status: 'healthy',\n    timestamp: new Date().toISOString(),\n    schemas: schemaDefinitions.map(s => s.name)\n  })\n})\n\n// Basic collections endpoint\napiRoutes.get('/collections', async (c) => {\n  const executionStart = Date.now()\n\n  try {\n    const db = c.env.DB\n    const cacheEnabled = c.get('cacheEnabled')\n    const cache = getCacheService(CACHE_CONFIGS.api!)\n    const cacheKey = cache.generateKey('collections', 'all')\n\n    // Use cache only if cache plugin is active\n    if (cacheEnabled) {\n      const cacheResult = await cache.getWithSource<any>(cacheKey)\n      if (cacheResult.hit && cacheResult.data) {\n        // Add cache headers\n        c.header('X-Cache-Status', 'HIT')\n        c.header('X-Cache-Source', cacheResult.source)\n        if (cacheResult.ttl) {\n          c.header('X-Cache-TTL', Math.floor(cacheResult.ttl).toString())\n        }\n\n        // Add cache info and timing to meta\n        const dataWithMeta = {\n          ...cacheResult.data,\n          meta: addTimingMeta(c, {\n            ...cacheResult.data.meta,\n            cache: {\n              hit: true,\n              source: cacheResult.source,\n              ttl: cacheResult.ttl ? Math.floor(cacheResult.ttl) : undefined\n            }\n          }, executionStart)\n        }\n\n        return c.json(dataWithMeta)\n      }\n    }\n\n    // Cache miss - fetch from database\n    c.header('X-Cache-Status', 'MISS')\n    c.header('X-Cache-Source', 'database')\n\n    const stmt = db.prepare('SELECT * FROM collections WHERE is_active = 1')\n    const { results } = await stmt.all()\n\n    // Parse schema and format results\n    const transformedResults = results.map((row: any) => ({\n      ...row,\n      schema: row.schema ? JSON.parse(row.schema) : {},\n      is_active: row.is_active // Keep as number (1 or 0)\n    }))\n\n    const responseData = {\n      data: transformedResults,\n      meta: addTimingMeta(c, {\n        count: results.length,\n        timestamp: new Date().toISOString(),\n        cache: {\n          hit: false,\n          source: 'database'\n        }\n      }, executionStart)\n    }\n\n    // Cache the response only if cache plugin is enabled\n    if (cacheEnabled) {\n      await cache.set(cacheKey, responseData)\n    }\n\n    return c.json(responseData)\n  } catch (error) {\n    console.error('Error fetching collections:', error)\n    return c.json({ error: 'Failed to fetch collections' }, 500)\n  }\n})\n\n// Basic content endpoint with advanced filtering\napiRoutes.get('/content', async (c) => {\n  const executionStart = Date.now()\n\n  try {\n    const db = c.env.DB\n    const queryParams = c.req.query()\n\n    // Handle collection parameter - convert collection name to collection_id\n    if (queryParams.collection) {\n      const collectionName = queryParams.collection\n      const collectionStmt = db.prepare('SELECT id FROM collections WHERE name = ? AND is_active = 1')\n      const collectionResult = await collectionStmt.bind(collectionName).first()\n\n      if (collectionResult) {\n        // Replace 'collection' param with 'collection_id' for the filter builder\n        queryParams.collection_id = (collectionResult as any).id\n        delete queryParams.collection\n      } else {\n        // Collection not found - return empty result\n        return c.json({\n          data: [],\n          meta: addTimingMeta(c, {\n            count: 0,\n            timestamp: new Date().toISOString(),\n            message: `Collection '${collectionName}' not found`\n          }, executionStart)\n        })\n      }\n    }\n\n    // Parse filter from query parameters\n    const filter: QueryFilter = QueryFilterBuilder.parseFromQuery(queryParams)\n\n    // Set default limit if not provided\n    if (!filter.limit) {\n      filter.limit = 50\n    }\n    filter.limit = Math.min(filter.limit, 1000) // Max 1000\n\n    // Build SQL query from filter\n    const builder = new QueryFilterBuilder()\n    const queryResult = builder.build('content', filter)\n\n    // Check for query building errors\n    if (queryResult.errors.length > 0) {\n      return c.json({\n        error: 'Invalid filter parameters',\n        details: queryResult.errors\n      }, 400)\n    }\n\n    // Only use cache if cache plugin is active\n    const cacheEnabled = c.get('cacheEnabled')\n    const cache = getCacheService(CACHE_CONFIGS.api!)\n    const cacheKey = cache.generateKey('content-filtered', JSON.stringify({ filter, query: queryResult.sql }))\n\n    if (cacheEnabled) {\n      const cacheResult = await cache.getWithSource<any>(cacheKey)\n      if (cacheResult.hit && cacheResult.data) {\n        // Add cache headers\n        c.header('X-Cache-Status', 'HIT')\n        c.header('X-Cache-Source', cacheResult.source)\n        if (cacheResult.ttl) {\n          c.header('X-Cache-TTL', Math.floor(cacheResult.ttl).toString())\n        }\n\n        // Add cache info and timing to meta\n        const dataWithMeta = {\n          ...cacheResult.data,\n          meta: addTimingMeta(c, {\n            ...cacheResult.data.meta,\n            cache: {\n              hit: true,\n              source: cacheResult.source,\n              ttl: cacheResult.ttl ? Math.floor(cacheResult.ttl) : undefined\n            }\n          }, executionStart)\n        }\n\n        return c.json(dataWithMeta)\n      }\n    }\n\n    // Cache miss - fetch from database\n    c.header('X-Cache-Status', 'MISS')\n    c.header('X-Cache-Source', 'database')\n\n    // Execute query with parameters\n    const stmt = db.prepare(queryResult.sql)\n    const boundStmt = queryResult.params.length > 0\n      ? stmt.bind(...queryResult.params)\n      : stmt\n\n    const { results } = await boundStmt.all()\n\n    // Transform results to match API spec (camelCase)\n    const transformedResults = results.map((row: any) => ({\n      id: row.id,\n      title: row.title,\n      slug: row.slug,\n      status: row.status,\n      collectionId: row.collection_id,\n      data: row.data ? JSON.parse(row.data) : {},\n      created_at: row.created_at,\n      updated_at: row.updated_at\n    }))\n\n    const responseData = {\n      data: transformedResults,\n      meta: addTimingMeta(c, {\n        count: results.length,\n        timestamp: new Date().toISOString(),\n        filter: filter,\n        query: {\n          sql: queryResult.sql,\n          params: queryResult.params\n        },\n        cache: {\n          hit: false,\n          source: 'database'\n        }\n      }, executionStart)\n    }\n\n    // Cache the response only if cache is enabled\n    if (cacheEnabled) {\n      await cache.set(cacheKey, responseData)\n    }\n\n    return c.json(responseData)\n  } catch (error) {\n    console.error('Error fetching content:', error)\n    return c.json({\n      error: 'Failed to fetch content',\n      details: error instanceof Error ? error.message : String(error)\n    }, 500)\n  }\n})\n\n// Collection-specific routes with advanced filtering\napiRoutes.get('/collections/:collection/content', async (c) => {\n  const executionStart = Date.now()\n\n  try {\n    const collection = c.req.param('collection')\n    const db = c.env.DB\n    const queryParams = c.req.query()\n\n    // First check if collection exists\n    const collectionStmt = db.prepare('SELECT * FROM collections WHERE name = ? AND is_active = 1')\n    const collectionResult = await collectionStmt.bind(collection).first()\n\n    if (!collectionResult) {\n      return c.json({ error: 'Collection not found' }, 404)\n    }\n\n    // Parse filter from query parameters\n    const filter: QueryFilter = QueryFilterBuilder.parseFromQuery(queryParams)\n\n    // Add collection_id filter to where clause\n    if (!filter.where) {\n      filter.where = { and: [] }\n    }\n\n    if (!filter.where.and) {\n      filter.where.and = []\n    }\n\n    // Add collection filter\n    filter.where.and.push({\n      field: 'collection_id',\n      operator: 'equals',\n      value: (collectionResult as any).id\n    })\n\n    // Set default limit if not provided\n    if (!filter.limit) {\n      filter.limit = 50\n    }\n    filter.limit = Math.min(filter.limit, 1000)\n\n    // Build SQL query from filter\n    const builder = new QueryFilterBuilder()\n    const queryResult = builder.build('content', filter)\n\n    // Check for query building errors\n    if (queryResult.errors.length > 0) {\n      return c.json({\n        error: 'Invalid filter parameters',\n        details: queryResult.errors\n      }, 400)\n    }\n\n    // Generate cache key\n    const cacheEnabled = c.get('cacheEnabled')\n    const cache = getCacheService(CACHE_CONFIGS.api!)\n    const cacheKey = cache.generateKey('collection-content-filtered', `${collection}:${JSON.stringify({ filter, query: queryResult.sql })}`)\n\n    // Only check cache if plugin is enabled\n    if (cacheEnabled) {\n      const cacheResult = await cache.getWithSource<any>(cacheKey)\n      if (cacheResult.hit && cacheResult.data) {\n        // Add cache headers\n        c.header('X-Cache-Status', 'HIT')\n        c.header('X-Cache-Source', cacheResult.source)\n        if (cacheResult.ttl) {\n          c.header('X-Cache-TTL', Math.floor(cacheResult.ttl).toString())\n        }\n\n        // Add cache info and timing to meta\n        const dataWithMeta = {\n          ...cacheResult.data,\n          meta: addTimingMeta(c, {\n            ...cacheResult.data.meta,\n            cache: {\n              hit: true,\n              source: cacheResult.source,\n              ttl: cacheResult.ttl ? Math.floor(cacheResult.ttl) : undefined\n            }\n          }, executionStart)\n        }\n\n        return c.json(dataWithMeta)\n      }\n    }\n\n    // Cache miss - fetch from database\n    c.header('X-Cache-Status', 'MISS')\n    c.header('X-Cache-Source', 'database')\n\n    // Execute query with parameters\n    const stmt = db.prepare(queryResult.sql)\n    const boundStmt = queryResult.params.length > 0\n      ? stmt.bind(...queryResult.params)\n      : stmt\n\n    const { results } = await boundStmt.all()\n\n    // Transform results to match API spec (camelCase)\n    const transformedResults = results.map((row: any) => ({\n      id: row.id,\n      title: row.title,\n      slug: row.slug,\n      status: row.status,\n      collectionId: row.collection_id,\n      data: row.data ? JSON.parse(row.data) : {},\n      created_at: row.created_at,\n      updated_at: row.updated_at\n    }))\n\n    const responseData = {\n      data: transformedResults,\n      meta: addTimingMeta(c, {\n        collection: {\n          ...(collectionResult as any),\n          schema: (collectionResult as any).schema ? JSON.parse((collectionResult as any).schema) : {}\n        },\n        count: results.length,\n        timestamp: new Date().toISOString(),\n        filter: filter,\n        query: {\n          sql: queryResult.sql,\n          params: queryResult.params\n        },\n        cache: {\n          hit: false,\n          source: 'database'\n        }\n      }, executionStart)\n    }\n\n    // Cache the response only if cache plugin is enabled\n    if (cacheEnabled) {\n      await cache.set(cacheKey, responseData)\n    }\n\n    return c.json(responseData)\n  } catch (error) {\n    console.error('Error fetching content:', error)\n    return c.json({\n      error: 'Failed to fetch content',\n      details: error instanceof Error ? error.message : String(error)\n    }, 500)\n  }\n})\n\n// Mount CRUD routes for content\napiRoutes.route('/content', apiContentCrudRoutes)\n\nexport default apiRoutes\n","import { Hono } from 'hono'\nimport { z } from 'zod'\nimport { requireAuth } from '../middleware'\nimport type { Bindings, Variables } from '../app'\n\n// Helper function to generate short IDs (replacement for nanoid)\nfunction generateId(): string {\n  return crypto.randomUUID().replace(/-/g, '').substring(0, 21)\n}\n\n// Helper function for emitting events (simplified for core package)\nasync function emitEvent(eventName: string, data: any) {\n  console.log(`[Event] ${eventName}:`, data)\n  // TODO: Implement proper event system when plugin architecture is ready\n}\n\n// File validation schema\nconst fileValidationSchema = z.object({\n  name: z.string().min(1).max(255),\n  type: z.string().refine(\n    (type) => {\n      const allowedTypes = [\n        // Images\n        'image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/webp', 'image/svg+xml',\n        // Documents\n        'application/pdf', 'text/plain', 'application/msword', \n        'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n        // Videos\n        'video/mp4', 'video/webm', 'video/ogg', 'video/avi', 'video/mov',\n        // Audio\n        'audio/mp3', 'audio/wav', 'audio/ogg', 'audio/m4a'\n      ]\n      return allowedTypes.includes(type)\n    },\n    { message: 'Unsupported file type' }\n  ),\n  size: z.number().min(1).max(50 * 1024 * 1024) // 50MB max\n})\n\nexport const apiMediaRoutes = new Hono<{ Bindings: Bindings; Variables: Variables }>()\n\n// Apply auth middleware to all routes\napiMediaRoutes.use('*', requireAuth())\n\n// Upload single file\napiMediaRoutes.post('/upload', async (c) => {\n  try {\n    const user = c.get('user')!\n    const formData = await c.req.formData()\n    const fileData = formData.get('file')\n\n    if (!fileData || typeof fileData === 'string') {\n      return c.json({ error: 'No file provided' }, 400)\n    }\n\n    const file = fileData as File\n\n    // Validate file\n    const validation = fileValidationSchema.safeParse({\n      name: file.name,\n      type: file.type,\n      size: file.size\n    })\n\n    if (!validation.success) {\n      return c.json({ \n        error: 'File validation failed', \n        details: validation.error.issues \n      }, 400)\n    }\n\n    // Generate unique filename and R2 key\n    const fileId = generateId()\n    const fileExtension = file.name.split('.').pop() || ''\n    const filename = `${fileId}.${fileExtension}`\n    const folder = formData.get('folder') as string || 'uploads'\n    const r2Key = `${folder}/${filename}`\n\n    // Upload to R2\n    const arrayBuffer = await file.arrayBuffer()\n    const uploadResult = await c.env.MEDIA_BUCKET.put(r2Key, arrayBuffer, {\n      httpMetadata: {\n        contentType: file.type,\n        contentDisposition: `inline; filename=\"${file.name}\"`\n      },\n      customMetadata: {\n        originalName: file.name,\n        uploadedBy: user.userId,\n        uploadedAt: new Date().toISOString()\n      }\n    })\n\n    if (!uploadResult) {\n      return c.json({ error: 'Failed to upload file to storage' }, 500)\n    }\n\n    // Generate public URL using environment variable for bucket name\n    const bucketName = c.env.BUCKET_NAME || 'warpcms-media-dev'\n    const publicUrl = `https://pub-${bucketName}.r2.dev/${r2Key}`\n    \n    // Extract image dimensions if it's an image\n    let width: number | undefined\n    let height: number | undefined\n    \n    if (file.type.startsWith('image/') && !file.type.includes('svg')) {\n      try {\n        const dimensions = await getImageDimensions(arrayBuffer)\n        width = dimensions.width\n        height = dimensions.height\n      } catch (error) {\n        console.warn('Failed to extract image dimensions:', error)\n      }\n    }\n\n    // Generate thumbnail URL for images\n    let thumbnailUrl: string | undefined\n    if (file.type.startsWith('image/') && c.env.IMAGES_ACCOUNT_ID) {\n      thumbnailUrl = `https://imagedelivery.net/${c.env.IMAGES_ACCOUNT_ID}/${r2Key}/thumbnail`\n    }\n\n    // Save to database\n    const mediaRecord = {\n      id: fileId,\n      filename: filename,\n      original_name: file.name,\n      mime_type: file.type,\n      size: file.size,\n      width,\n      height,\n      folder,\n      r2_key: r2Key,\n      public_url: publicUrl,\n      thumbnail_url: thumbnailUrl,\n      uploaded_by: user.userId,\n      uploaded_at: Math.floor(Date.now() / 1000),\n      created_at: Math.floor(Date.now() / 1000)\n    }\n\n    const stmt = c.env.DB.prepare(`\n      INSERT INTO media (\n        id, filename, original_name, mime_type, size, width, height, \n        folder, r2_key, public_url, thumbnail_url, uploaded_by, uploaded_at\n      ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n    `)\n    \n    await stmt.bind(\n      mediaRecord.id,\n      mediaRecord.filename,\n      mediaRecord.original_name,\n      mediaRecord.mime_type,\n      mediaRecord.size,\n      mediaRecord.width ?? null,\n      mediaRecord.height ?? null,\n      mediaRecord.folder,\n      mediaRecord.r2_key,\n      mediaRecord.public_url,\n      mediaRecord.thumbnail_url ?? null,\n      mediaRecord.uploaded_by,\n      mediaRecord.uploaded_at\n    ).run()\n\n    // Emit media upload event\n    await emitEvent('media.upload', { id: mediaRecord.id, filename: mediaRecord.filename })\n\n    return c.json({\n      success: true,\n      file: {\n        id: mediaRecord.id,\n        filename: mediaRecord.filename,\n        originalName: mediaRecord.original_name,\n        mimeType: mediaRecord.mime_type,\n        size: mediaRecord.size,\n        width: mediaRecord.width,\n        height: mediaRecord.height,\n        r2_key: mediaRecord.r2_key,\n        publicUrl: mediaRecord.public_url,\n        thumbnailUrl: mediaRecord.thumbnail_url,\n        uploadedAt: new Date(mediaRecord.uploaded_at * 1000).toISOString()\n      }\n    })\n  } catch (error) {\n    console.error('Upload error:', error)\n    return c.json({ error: 'Upload failed' }, 500)\n  }\n})\n\n// Upload multiple files\napiMediaRoutes.post('/upload-multiple', async (c) => {\n  try {\n    const user = c.get('user')!\n    const formData = await c.req.formData()\n    const filesData = formData.getAll('files')\n\n    // Filter out strings and ensure we only have File objects\n    const files: File[] = []\n    for (const f of filesData) {\n      if (typeof f !== 'string') {\n        files.push(f as File)\n      }\n    }\n\n    if (!files || files.length === 0) {\n      return c.json({ error: 'No files provided' }, 400)\n    }\n\n    const uploadResults = []\n    const errors = []\n\n    for (const file of files) {\n      try {\n        // Validate file\n        const validation = fileValidationSchema.safeParse({\n          name: file.name,\n          type: file.type,\n          size: file.size\n        })\n\n        if (!validation.success) {\n          errors.push({\n            filename: file.name,\n            error: 'Validation failed',\n            details: validation.error.issues\n          })\n          continue\n        }\n\n        // Generate unique filename and R2 key\n        const fileId = generateId()\n        const fileExtension = file.name.split('.').pop() || ''\n        const filename = `${fileId}.${fileExtension}`\n        const folder = formData.get('folder') as string || 'uploads'\n        const r2Key = `${folder}/${filename}`\n\n        // Upload to R2\n        const arrayBuffer = await file.arrayBuffer()\n        const uploadResult = await c.env.MEDIA_BUCKET.put(r2Key, arrayBuffer, {\n          httpMetadata: {\n            contentType: file.type,\n            contentDisposition: `inline; filename=\"${file.name}\"`\n          },\n          customMetadata: {\n            originalName: file.name,\n            uploadedBy: user.userId,\n            uploadedAt: new Date().toISOString()\n          }\n        })\n\n        if (!uploadResult) {\n          errors.push({\n            filename: file.name,\n            error: 'Failed to upload to storage'\n          })\n          continue\n        }\n\n        // Generate public URL using environment variable for bucket name\n        const bucketName = c.env.BUCKET_NAME || 'warpcms-media-dev'\n        const publicUrl = `https://pub-${bucketName}.r2.dev/${r2Key}`\n        \n        // Extract image dimensions if it's an image\n        let width: number | undefined\n        let height: number | undefined\n        \n        if (file.type.startsWith('image/') && !file.type.includes('svg')) {\n          try {\n            const dimensions = await getImageDimensions(arrayBuffer)\n            width = dimensions.width\n            height = dimensions.height\n          } catch (error) {\n            console.warn('Failed to extract image dimensions:', error)\n          }\n        }\n\n        // Generate thumbnail URL for images\n        let thumbnailUrl: string | undefined\n        if (file.type.startsWith('image/') && c.env.IMAGES_ACCOUNT_ID) {\n          thumbnailUrl = `https://imagedelivery.net/${c.env.IMAGES_ACCOUNT_ID}/${r2Key}/thumbnail`\n        }\n\n        // Save to database\n        const mediaRecord = {\n          id: fileId,\n          filename: filename,\n          original_name: file.name,\n          mime_type: file.type,\n          size: file.size,\n          width,\n          height,\n          folder,\n          r2_key: r2Key,\n          public_url: publicUrl,\n          thumbnail_url: thumbnailUrl,\n          uploaded_by: user.userId,\n          uploaded_at: Math.floor(Date.now() / 1000)\n        }\n\n        const stmt = c.env.DB.prepare(`\n          INSERT INTO media (\n            id, filename, original_name, mime_type, size, width, height, \n            folder, r2_key, public_url, thumbnail_url, uploaded_by, uploaded_at\n          ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n        `)\n        \n        await stmt.bind(\n          mediaRecord.id,\n          mediaRecord.filename,\n          mediaRecord.original_name,\n          mediaRecord.mime_type,\n          mediaRecord.size,\n          mediaRecord.width ?? null,\n          mediaRecord.height ?? null,\n          mediaRecord.folder,\n          mediaRecord.r2_key,\n          mediaRecord.public_url,\n          mediaRecord.thumbnail_url ?? null,\n          mediaRecord.uploaded_by,\n          mediaRecord.uploaded_at\n        ).run()\n\n        uploadResults.push({\n          id: mediaRecord.id,\n          filename: mediaRecord.filename,\n          originalName: mediaRecord.original_name,\n          mimeType: mediaRecord.mime_type,\n          size: mediaRecord.size,\n          width: mediaRecord.width,\n          height: mediaRecord.height,\n          r2_key: mediaRecord.r2_key,\n          publicUrl: mediaRecord.public_url,\n          thumbnailUrl: mediaRecord.thumbnail_url,\n          uploadedAt: new Date(mediaRecord.uploaded_at * 1000).toISOString()\n        })\n      } catch (error) {\n        errors.push({\n          filename: file.name,\n          error: 'Upload failed',\n          details: error instanceof Error ? error.message : 'Unknown error'\n        })\n      }\n    }\n\n    // Emit media upload event if any uploads succeeded\n    if (uploadResults.length > 0) {\n      await emitEvent('media.upload', { count: uploadResults.length })\n    }\n\n    return c.json({\n      success: uploadResults.length > 0,\n      uploaded: uploadResults,\n      errors: errors,\n      summary: {\n        total: files.length,\n        successful: uploadResults.length,\n        failed: errors.length\n      }\n    })\n  } catch (error) {\n    console.error('Multiple upload error:', error)\n    return c.json({ error: 'Upload failed' }, 500)\n  }\n})\n\n// Bulk delete files\napiMediaRoutes.post('/bulk-delete', async (c) => {\n  try {\n    const user = c.get('user')!\n    const body = await c.req.json()\n    const fileIds = body.fileIds as string[]\n    \n    if (!fileIds || !Array.isArray(fileIds) || fileIds.length === 0) {\n      return c.json({ error: 'No file IDs provided' }, 400)\n    }\n\n    // Limit bulk operations to prevent abuse\n    if (fileIds.length > 50) {\n      return c.json({ error: 'Too many files selected. Maximum 50 files per operation.' }, 400)\n    }\n\n    const results = []\n    const errors = []\n\n    for (const fileId of fileIds) {\n      try {\n        // Get file record (including already deleted files to check if they exist at all)\n        const stmt = c.env.DB.prepare('SELECT * FROM media WHERE id = ?')\n        const fileRecord = await stmt.bind(fileId).first() as any\n\n        if (!fileRecord) {\n          errors.push({ fileId, error: 'File not found' })\n          continue\n        }\n\n        // Skip if already deleted (treat as success)\n        if (fileRecord.deleted_at !== null) {\n          console.log(`File ${fileId} already deleted, skipping`)\n          results.push({\n            fileId,\n            filename: fileRecord.original_name,\n            success: true,\n            alreadyDeleted: true\n          })\n          continue\n        }\n\n        // Check permissions (only allow deletion by uploader or admin)\n        if (fileRecord.uploaded_by !== user.userId && user.role !== 'admin') {\n          errors.push({ fileId, error: 'Permission denied' })\n          continue\n        }\n\n        // Delete from R2\n        try {\n          await c.env.MEDIA_BUCKET.delete(fileRecord.r2_key)\n        } catch (error) {\n          console.warn(`Failed to delete from R2 for file ${fileId}:`, error)\n          // Continue with database deletion even if R2 deletion fails\n        }\n\n        // Soft delete in database\n        const deleteStmt = c.env.DB.prepare('UPDATE media SET deleted_at = ? WHERE id = ?')\n        await deleteStmt.bind(Math.floor(Date.now() / 1000), fileId).run()\n\n        results.push({\n          fileId,\n          filename: fileRecord.original_name,\n          success: true\n        })\n      } catch (error) {\n        errors.push({\n          fileId,\n          error: 'Delete failed',\n          details: error instanceof Error ? error.message : 'Unknown error'\n        })\n      }\n    }\n\n    // Emit media delete event if any deletes succeeded\n    if (results.length > 0) {\n      await emitEvent('media.delete', { count: results.length, ids: fileIds })\n    }\n\n    return c.json({\n      success: results.length > 0,\n      deleted: results,\n      errors: errors,\n      summary: {\n        total: fileIds.length,\n        successful: results.length,\n        failed: errors.length\n      }\n    })\n  } catch (error) {\n    console.error('Bulk delete error:', error)\n    return c.json({ error: 'Bulk delete failed' }, 500)\n  }\n})\n\n// Create folder\napiMediaRoutes.post('/create-folder', async (c) => {\n  try {\n    const body = await c.req.json()\n    const folderName = body.folderName as string\n\n    if (!folderName || typeof folderName !== 'string') {\n      return c.json({ success: false, error: 'No folder name provided' }, 400)\n    }\n\n    // Validate folder name format\n    const folderPattern = /^[a-z0-9-_]+$/\n    if (!folderPattern.test(folderName)) {\n      return c.json({\n        success: false,\n        error: 'Folder name can only contain lowercase letters, numbers, hyphens, and underscores'\n      }, 400)\n    }\n\n    // Check if folder already exists in the database\n    const checkStmt = c.env.DB.prepare('SELECT COUNT(*) as count FROM media WHERE folder = ? AND deleted_at IS NULL')\n    const existingFolder = await checkStmt.bind(folderName).first() as any\n\n    if (existingFolder && existingFolder.count > 0) {\n      return c.json({\n        success: false,\n        error: `Folder \"${folderName}\" already exists`\n      }, 400)\n    }\n\n    // Note: R2 folders are virtual - they only exist when files are uploaded to them\n    // Return success message explaining this behavior\n    return c.json({\n      success: true,\n      message: `Folder \"${folderName}\" is ready. Upload files to this folder to make it appear in the media library.`,\n      folder: folderName,\n      note: 'Folders appear automatically when you upload files to them'\n    })\n  } catch (error) {\n    console.error('Create folder error:', error)\n    return c.json({ success: false, error: 'Failed to create folder' }, 500)\n  }\n})\n\n// Bulk move files to folder\napiMediaRoutes.post('/bulk-move', async (c) => {\n  try {\n    const user = c.get('user')!\n    const body = await c.req.json()\n    const fileIds = body.fileIds as string[]\n    const targetFolder = body.folder as string\n\n    if (!fileIds || !Array.isArray(fileIds) || fileIds.length === 0) {\n      return c.json({ error: 'No file IDs provided' }, 400)\n    }\n\n    if (!targetFolder || typeof targetFolder !== 'string') {\n      return c.json({ error: 'No target folder provided' }, 400)\n    }\n\n    // Limit bulk operations to prevent abuse\n    if (fileIds.length > 50) {\n      return c.json({ error: 'Too many files selected. Maximum 50 files per operation.' }, 400)\n    }\n\n    const results = []\n    const errors = []\n\n    for (const fileId of fileIds) {\n      try {\n        // Get file record\n        const stmt = c.env.DB.prepare('SELECT * FROM media WHERE id = ? AND deleted_at IS NULL')\n        const fileRecord = await stmt.bind(fileId).first() as any\n\n        if (!fileRecord) {\n          errors.push({ fileId, error: 'File not found' })\n          continue\n        }\n\n        // Check permissions (only allow move by uploader or admin)\n        if (fileRecord.uploaded_by !== user.userId && user.role !== 'admin') {\n          errors.push({ fileId, error: 'Permission denied' })\n          continue\n        }\n\n        // Skip if already in target folder\n        if (fileRecord.folder === targetFolder) {\n          results.push({\n            fileId,\n            filename: fileRecord.original_name,\n            success: true,\n            skipped: true\n          })\n          continue\n        }\n\n        // Generate new R2 key with new folder\n        const oldR2Key = fileRecord.r2_key\n        const filename = oldR2Key.split('/').pop() || fileRecord.filename\n        const newR2Key = `${targetFolder}/${filename}`\n\n        // Copy file to new location in R2\n        try {\n          const object = await c.env.MEDIA_BUCKET.get(oldR2Key)\n          if (!object) {\n            errors.push({ fileId, error: 'File not found in storage' })\n            continue\n          }\n\n          await c.env.MEDIA_BUCKET.put(newR2Key, object.body, {\n            httpMetadata: object.httpMetadata,\n            customMetadata: {\n              ...object.customMetadata,\n              movedBy: user.userId,\n              movedAt: new Date().toISOString()\n            }\n          })\n\n          // Delete old file from R2\n          await c.env.MEDIA_BUCKET.delete(oldR2Key)\n        } catch (error) {\n          console.warn(`Failed to move file in R2 for file ${fileId}:`, error)\n          errors.push({ fileId, error: 'Failed to move file in storage' })\n          continue\n        }\n\n        // Update database with new folder and R2 key\n        const bucketName = c.env.BUCKET_NAME || 'warpcms-media-dev'\n        const newPublicUrl = `https://pub-${bucketName}.r2.dev/${newR2Key}`\n\n        const updateStmt = c.env.DB.prepare(`\n          UPDATE media\n          SET folder = ?, r2_key = ?, public_url = ?, updated_at = ?\n          WHERE id = ?\n        `)\n        await updateStmt.bind(\n          targetFolder,\n          newR2Key,\n          newPublicUrl,\n          Math.floor(Date.now() / 1000),\n          fileId\n        ).run()\n\n        results.push({\n          fileId,\n          filename: fileRecord.original_name,\n          success: true,\n          skipped: false\n        })\n      } catch (error) {\n        errors.push({\n          fileId,\n          error: 'Move failed',\n          details: error instanceof Error ? error.message : 'Unknown error'\n        })\n      }\n    }\n\n    // Emit media move event if any moves succeeded\n    if (results.length > 0) {\n      await emitEvent('media.move', { count: results.length, targetFolder, ids: fileIds })\n    }\n\n    return c.json({\n      success: results.length > 0,\n      moved: results,\n      errors: errors,\n      summary: {\n        total: fileIds.length,\n        successful: results.length,\n        failed: errors.length\n      }\n    })\n  } catch (error) {\n    console.error('Bulk move error:', error)\n    return c.json({ error: 'Bulk move failed' }, 500)\n  }\n})\n\n// Delete file\napiMediaRoutes.delete('/:id', async (c) => {\n  try {\n    const user = c.get('user')!\n    const fileId = c.req.param('id')\n    \n    // Get file record\n    const stmt = c.env.DB.prepare('SELECT * FROM media WHERE id = ? AND deleted_at IS NULL')\n    const fileRecord = await stmt.bind(fileId).first() as any\n    \n    if (!fileRecord) {\n      return c.json({ error: 'File not found' }, 404)\n    }\n\n    // Check permissions (only allow deletion by uploader or admin)\n    if (fileRecord.uploaded_by !== user.userId && user.role !== 'admin') {\n      return c.json({ error: 'Permission denied' }, 403)\n    }\n\n    // Delete from R2\n    try {\n      await c.env.MEDIA_BUCKET.delete(fileRecord.r2_key)\n    } catch (error) {\n      console.warn('Failed to delete from R2:', error)\n      // Continue with database deletion even if R2 deletion fails\n    }\n\n    // Soft delete in database\n    const deleteStmt = c.env.DB.prepare('UPDATE media SET deleted_at = ? WHERE id = ?')\n    await deleteStmt.bind(Math.floor(Date.now() / 1000), fileId).run()\n\n    // Emit media delete event\n    await emitEvent('media.delete', { id: fileId })\n\n    return c.json({ success: true, message: 'File deleted successfully' })\n  } catch (error) {\n    console.error('Delete error:', error)\n    return c.json({ error: 'Delete failed' }, 500)\n  }\n})\n\n// Update file metadata\napiMediaRoutes.patch('/:id', async (c) => {\n  try {\n    const user = c.get('user')!\n    const fileId = c.req.param('id')\n    const body = await c.req.json()\n    \n    // Get file record\n    const stmt = c.env.DB.prepare('SELECT * FROM media WHERE id = ? AND deleted_at IS NULL')\n    const fileRecord = await stmt.bind(fileId).first() as any\n    \n    if (!fileRecord) {\n      return c.json({ error: 'File not found' }, 404)\n    }\n\n    // Check permissions (only allow updates by uploader or admin)\n    if (fileRecord.uploaded_by !== user.userId && user.role !== 'admin') {\n      return c.json({ error: 'Permission denied' }, 403)\n    }\n\n    // Update allowed fields\n    const allowedFields = ['alt', 'caption', 'tags', 'folder']\n    const updates = []\n    const values = []\n    \n    for (const [key, value] of Object.entries(body)) {\n      if (allowedFields.includes(key)) {\n        updates.push(`${key} = ?`)\n        values.push(key === 'tags' ? JSON.stringify(value) : value)\n      }\n    }\n\n    if (updates.length === 0) {\n      return c.json({ error: 'No valid fields to update' }, 400)\n    }\n\n    updates.push('updated_at = ?')\n    values.push(Math.floor(Date.now() / 1000))\n    values.push(fileId)\n\n    const updateStmt = c.env.DB.prepare(`\n      UPDATE media SET ${updates.join(', ')} WHERE id = ?\n    `)\n    await updateStmt.bind(...values).run()\n\n    // Emit media update event\n    await emitEvent('media.update', { id: fileId })\n\n    return c.json({ success: true, message: 'File updated successfully' })\n  } catch (error) {\n    console.error('Update error:', error)\n    return c.json({ error: 'Update failed' }, 500)\n  }\n})\n\n// Helper function to extract image dimensions\nasync function getImageDimensions(arrayBuffer: ArrayBuffer): Promise<{ width: number; height: number }> {\n  // This is a simplified implementation\n  // In a real-world scenario, you'd use a proper image processing library\n  const uint8Array = new Uint8Array(arrayBuffer)\n  \n  // Check for JPEG\n  if (uint8Array[0] === 0xFF && uint8Array[1] === 0xD8) {\n    return getJPEGDimensions(uint8Array)\n  }\n  \n  // Check for PNG\n  if (uint8Array[0] === 0x89 && uint8Array[1] === 0x50 && uint8Array[2] === 0x4E && uint8Array[3] === 0x47) {\n    return getPNGDimensions(uint8Array)\n  }\n  \n  // Default fallback\n  return { width: 0, height: 0 }\n}\n\nfunction getJPEGDimensions(uint8Array: Uint8Array): { width: number; height: number } {\n  let i = 2\n  while (i < uint8Array.length) {\n    if (i + 8 >= uint8Array.length) break\n    if (uint8Array[i] === 0xFF && uint8Array[i + 1] === 0xC0) {\n      if (i + 8 < uint8Array.length) {\n        return {\n          height: (uint8Array[i + 5]! << 8) | uint8Array[i + 6]!,\n          width: (uint8Array[i + 7]! << 8) | uint8Array[i + 8]!\n        }\n      }\n    }\n    if (i + 3 < uint8Array.length) {\n      i += 2 + ((uint8Array[i + 2]! << 8) | uint8Array[i + 3]!)\n    } else {\n      break\n    }\n  }\n  return { width: 0, height: 0 }\n}\n\nfunction getPNGDimensions(uint8Array: Uint8Array): { width: number; height: number } {\n  if (uint8Array.length < 24) {\n    return { width: 0, height: 0 }\n  }\n  return {\n    width: (uint8Array[16]! << 24) | (uint8Array[17]! << 16) | (uint8Array[18]! << 8) | uint8Array[19]!,\n    height: (uint8Array[20]! << 24) | (uint8Array[21]! << 16) | (uint8Array[22]! << 8) | uint8Array[23]!\n  }\n}\n\nexport default apiMediaRoutes","/**\n * API System Routes\n *\n * Provides system health, status, and metadata endpoints\n * These are lightweight routes without heavy dependencies\n */\n\nimport { Hono } from 'hono'\nimport type { Bindings, Variables } from '../app'\n\nexport const apiSystemRoutes = new Hono<{ Bindings: Bindings; Variables: Variables }>()\n\n/**\n * System health check\n * GET /api/system/health\n */\napiSystemRoutes.get('/health', async (c) => {\n  try {\n    const startTime = Date.now()\n\n    // Check database connectivity\n    let dbStatus = 'unknown'\n    let dbLatency = 0\n\n    try {\n      const dbStart = Date.now()\n      await c.env.DB.prepare('SELECT 1').first()\n      dbLatency = Date.now() - dbStart\n      dbStatus = 'healthy'\n    } catch (error) {\n      console.error('Database health check failed:', error)\n      dbStatus = 'unhealthy'\n    }\n\n    // Check KV connectivity (if available)\n    let kvStatus = 'not_configured'\n    let kvLatency = 0\n\n    if (c.env.CACHE_KV) {\n      try {\n        const kvStart = Date.now()\n        await c.env.CACHE_KV.get('__health_check__')\n        kvLatency = Date.now() - kvStart\n        kvStatus = 'healthy'\n      } catch (error) {\n        console.error('KV health check failed:', error)\n        kvStatus = 'unhealthy'\n      }\n    }\n\n    // Check R2 connectivity (if available)\n    let r2Status = 'not_configured'\n\n    if (c.env.MEDIA_BUCKET) {\n      try {\n        await c.env.MEDIA_BUCKET.head('__health_check__')\n        r2Status = 'healthy'\n      } catch (error) {\n        // R2 head on non-existent key returns null, not an error\n        // This is expected, so we consider it healthy\n        r2Status = 'healthy'\n      }\n    }\n\n    const totalLatency = Date.now() - startTime\n    const overall = dbStatus === 'healthy' ? 'healthy' : 'degraded'\n\n    return c.json({\n      status: overall,\n      timestamp: new Date().toISOString(),\n      uptime: totalLatency,\n      checks: {\n        database: {\n          status: dbStatus,\n          latency: dbLatency\n        },\n        cache: {\n          status: kvStatus,\n          latency: kvLatency\n        },\n        storage: {\n          status: r2Status\n        }\n      },\n      environment: c.env.ENVIRONMENT || 'production'\n    })\n  } catch (error) {\n    console.error('Health check failed:', error)\n    return c.json({\n      status: 'unhealthy',\n      timestamp: new Date().toISOString(),\n      error: 'Health check failed'\n    }, 503)\n  }\n})\n\n/**\n * System information\n * GET /api/system/info\n */\napiSystemRoutes.get('/info', (c) => {\n  const appVersion = c.get('appVersion') || '1.0.0'\n\n  return c.json({\n    name: 'WarpCMS',\n    version: appVersion,\n    description: 'Modern headless CMS built on Cloudflare Workers',\n    endpoints: {\n      api: '/api',\n      auth: '/auth',\n      health: '/api/system/health',\n      docs: '/docs'\n    },\n    features: {\n      content: true,\n      media: true,\n      auth: true,\n      collections: true,\n      caching: !!c.env.CACHE_KV,\n      storage: !!c.env.MEDIA_BUCKET\n    },\n    timestamp: new Date().toISOString()\n  })\n})\n\n/**\n * System stats\n * GET /api/system/stats\n */\napiSystemRoutes.get('/stats', async (c) => {\n  try {\n    const db = c.env.DB\n\n    // Get content statistics\n    const contentStats = await db.prepare(`\n      SELECT COUNT(*) as total_content\n      FROM content\n      WHERE deleted_at IS NULL\n    `).first() as any\n\n    // Get media statistics\n    const mediaStats = await db.prepare(`\n      SELECT\n        COUNT(*) as total_files,\n        SUM(size) as total_size\n      FROM media\n      WHERE deleted_at IS NULL\n    `).first() as any\n\n    // Get user statistics\n    const userStats = await db.prepare(`\n      SELECT COUNT(*) as total_users\n      FROM users\n    `).first() as any\n\n    return c.json({\n      content: {\n        total: contentStats?.total_content || 0\n      },\n      media: {\n        total_files: mediaStats?.total_files || 0,\n        total_size_bytes: mediaStats?.total_size || 0,\n        total_size_mb: Math.round((mediaStats?.total_size || 0) / 1024 / 1024 * 100) / 100\n      },\n      users: {\n        total: userStats?.total_users || 0\n      },\n      timestamp: new Date().toISOString()\n    })\n  } catch (error) {\n    console.error('Stats query failed:', error)\n    return c.json({ error: 'Failed to fetch system statistics' }, 500)\n  }\n})\n\n/**\n * Database ping\n * GET /api/system/ping\n */\napiSystemRoutes.get('/ping', async (c) => {\n  try {\n    const start = Date.now()\n    await c.env.DB.prepare('SELECT 1').first()\n    const latency = Date.now() - start\n\n    return c.json({\n      pong: true,\n      latency,\n      timestamp: new Date().toISOString()\n    })\n  } catch (error) {\n    console.error('Ping failed:', error)\n    return c.json({\n      pong: false,\n      error: 'Database connection failed'\n    }, 503)\n  }\n})\n\n/**\n * Environment check\n * GET /api/system/env\n */\napiSystemRoutes.get('/env', (c) => {\n  return c.json({\n    environment: c.env.ENVIRONMENT || 'production',\n    features: {\n      database: !!c.env.DB,\n      cache: !!c.env.CACHE_KV,\n      media_bucket: !!c.env.MEDIA_BUCKET,\n      email_queue: !!c.env.EMAIL_QUEUE,\n      sendgrid: !!c.env.SENDGRID_API_KEY,\n      cloudflare_images: !!(c.env.IMAGES_ACCOUNT_ID && c.env.IMAGES_API_TOKEN)\n    },\n    timestamp: new Date().toISOString()\n  })\n})\n\nexport default apiSystemRoutes\n","/**\n * Admin API Routes\n *\n * Provides JSON API endpoints for admin operations\n * These routes complement the admin UI and can be used programmatically\n */\n\nimport { Hono } from 'hono'\nimport { z } from 'zod'\n// import { zValidator } from '@hono/zod-validator'\nimport { requireAuth, requireRole } from '../middleware'\nimport type { Bindings, Variables } from '../app'\n\nexport const adminApiRoutes = new Hono<{ Bindings: Bindings; Variables: Variables }>()\n\n// Apply auth middleware to all admin routes\nadminApiRoutes.use('*', requireAuth())\nadminApiRoutes.use('*', requireRole(['admin', 'editor']))\n\n/**\n * Get dashboard statistics\n * GET /admin/api/stats\n */\nadminApiRoutes.get('/stats', async (c) => {\n  try {\n    const db = c.env.DB\n\n    // Get collections count\n    let collectionsCount = 0\n    try {\n      const collectionsStmt = db.prepare('SELECT COUNT(*) as count FROM collections WHERE is_active = 1')\n      const collectionsResult = await collectionsStmt.first()\n      collectionsCount = (collectionsResult as any)?.count || 0\n    } catch (error) {\n      console.error('Error fetching collections count:', error)\n    }\n\n    // Get content count\n    let contentCount = 0\n    try {\n      const contentStmt = db.prepare('SELECT COUNT(*) as count FROM content WHERE deleted_at IS NULL')\n      const contentResult = await contentStmt.first()\n      contentCount = (contentResult as any)?.count || 0\n    } catch (error) {\n      console.error('Error fetching content count:', error)\n    }\n\n    // Get media count and total size\n    let mediaCount = 0\n    let mediaSize = 0\n    try {\n      const mediaStmt = db.prepare('SELECT COUNT(*) as count, COALESCE(SUM(size), 0) as total_size FROM media WHERE deleted_at IS NULL')\n      const mediaResult = await mediaStmt.first()\n      mediaCount = (mediaResult as any)?.count || 0\n      mediaSize = (mediaResult as any)?.total_size || 0\n    } catch (error) {\n      console.error('Error fetching media count:', error)\n    }\n\n    // Get users count\n    let usersCount = 0\n    try {\n      const usersStmt = db.prepare('SELECT COUNT(*) as count FROM users WHERE is_active = 1')\n      const usersResult = await usersStmt.first()\n      usersCount = (usersResult as any)?.count || 0\n    } catch (error) {\n      console.error('Error fetching users count:', error)\n    }\n\n    return c.json({\n      collections: collectionsCount,\n      contentItems: contentCount,\n      mediaFiles: mediaCount,\n      mediaSize: mediaSize,\n      users: usersCount,\n      timestamp: new Date().toISOString()\n    })\n  } catch (error) {\n    console.error('Error fetching stats:', error)\n    return c.json({ error: 'Failed to fetch statistics' }, 500)\n  }\n})\n\n/**\n * Get storage usage\n * GET /admin/api/storage\n */\nadminApiRoutes.get('/storage', async (c) => {\n  try {\n    const db = c.env.DB\n\n    // Get database size from D1 metadata\n    let databaseSize = 0\n    try {\n      const result = await db.prepare('SELECT 1').run()\n      databaseSize = (result as any)?.meta?.size_after || 0\n    } catch (error) {\n      console.error('Error fetching database size:', error)\n    }\n\n    // Get media total size\n    let mediaSize = 0\n    try {\n      const mediaStmt = db.prepare('SELECT COALESCE(SUM(size), 0) as total_size FROM media WHERE deleted_at IS NULL')\n      const mediaResult = await mediaStmt.first()\n      mediaSize = (mediaResult as any)?.total_size || 0\n    } catch (error) {\n      console.error('Error fetching media size:', error)\n    }\n\n    return c.json({\n      databaseSize,\n      mediaSize,\n      totalSize: databaseSize + mediaSize,\n      timestamp: new Date().toISOString()\n    })\n  } catch (error) {\n    console.error('Error fetching storage usage:', error)\n    return c.json({ error: 'Failed to fetch storage usage' }, 500)\n  }\n})\n\n/**\n * Get recent activity\n * GET /admin/api/activity\n */\nadminApiRoutes.get('/activity', async (c) => {\n  try {\n    const db = c.env.DB\n    const limit = parseInt(c.req.query('limit') || '10')\n\n    // Get recent activities from activity_logs table\n    const activityStmt = db.prepare(`\n      SELECT\n        a.id,\n        a.action,\n        a.resource_type,\n        a.resource_id,\n        a.details,\n        a.created_at,\n        u.email,\n        u.first_name,\n        u.last_name\n      FROM activity_logs a\n      LEFT JOIN users u ON a.user_id = u.id\n      WHERE a.resource_type IN ('content', 'collections', 'users', 'media')\n      ORDER BY a.created_at DESC\n      LIMIT ?\n    `)\n\n    const { results } = await activityStmt.bind(limit).all()\n\n    const recentActivity = (results || []).map((row: any) => {\n      const userName = row.first_name && row.last_name\n        ? `${row.first_name} ${row.last_name}`\n        : row.email || 'System'\n\n      let details: any = {}\n      try {\n        details = row.details ? JSON.parse(row.details) : {}\n      } catch (e) {\n        console.error('Error parsing activity details:', e)\n      }\n\n      return {\n        id: row.id,\n        type: row.resource_type,\n        action: row.action,\n        resource_id: row.resource_id,\n        details,\n        timestamp: new Date(Number(row.created_at)).toISOString(),\n        user: userName\n      }\n    })\n\n    return c.json({\n      data: recentActivity,\n      count: recentActivity.length,\n      timestamp: new Date().toISOString()\n    })\n  } catch (error) {\n    console.error('Error fetching recent activity:', error)\n    return c.json({ error: 'Failed to fetch recent activity' }, 500)\n  }\n})\n\n/**\n * Collection management schema\n */\nconst createCollectionSchema = z.object({\n  name: z.string().min(1).max(255).regex(/^[a-z0-9_]+$/, 'Must contain only lowercase letters, numbers, and underscores'),\n  displayName: z.string().min(1).max(255).optional(),\n  display_name: z.string().min(1).max(255).optional(),\n  description: z.string().optional()\n}).refine(data => data.displayName || data.display_name, {\n  message: 'Either displayName or display_name is required',\n  path: ['displayName']\n})\n\nconst updateCollectionSchema = z.object({\n  display_name: z.string().min(1).max(255).optional(),\n  description: z.string().optional(),\n  is_active: z.boolean().optional()\n})\n\n/**\n * Get all collections\n * GET /admin/api/collections\n */\nadminApiRoutes.get('/collections', async (c) => {\n  try {\n    const db = c.env.DB\n    const search = c.req.query('search') || ''\n    const includeInactive = c.req.query('includeInactive') === 'true'\n\n    let stmt\n    let results\n\n    if (search) {\n      stmt = db.prepare(`\n        SELECT id, name, display_name, description, created_at, updated_at, is_active, managed\n        FROM collections\n        WHERE ${includeInactive ? '1=1' : 'is_active = 1'}\n        AND (name LIKE ? OR display_name LIKE ? OR description LIKE ?)\n        ORDER BY created_at DESC\n      `)\n      const searchParam = `%${search}%`\n      const queryResults = await stmt.bind(searchParam, searchParam, searchParam).all()\n      results = queryResults.results\n    } else {\n      stmt = db.prepare(`\n        SELECT id, name, display_name, description, created_at, updated_at, is_active, managed\n        FROM collections\n        ${includeInactive ? '' : 'WHERE is_active = 1'}\n        ORDER BY created_at DESC\n      `)\n      const queryResults = await stmt.all()\n      results = queryResults.results\n    }\n\n    // Get field counts\n    const fieldCountStmt = db.prepare('SELECT collection_id, COUNT(*) as count FROM content_fields GROUP BY collection_id')\n    const { results: fieldCountResults } = await fieldCountStmt.all()\n    const fieldCounts = new Map((fieldCountResults || []).map((row: any) => [String(row.collection_id), Number(row.count)]))\n\n    const collections = (results || []).map((row: any) => ({\n      id: row.id,\n      name: row.name,\n      display_name: row.display_name,\n      description: row.description,\n      created_at: Number(row.created_at),\n      updated_at: Number(row.updated_at),\n      is_active: row.is_active === 1,\n      managed: row.managed === 1,\n      field_count: fieldCounts.get(String(row.id)) || 0\n    }))\n\n    return c.json({\n      data: collections,\n      count: collections.length,\n      timestamp: new Date().toISOString()\n    })\n  } catch (error) {\n    console.error('Error fetching collections:', error)\n    return c.json({ error: 'Failed to fetch collections' }, 500)\n  }\n})\n\n/**\n * Get single collection\n * GET /admin/api/collections/:id\n */\nadminApiRoutes.get('/collections/:id', async (c) => {\n  try {\n    const id = c.req.param('id')\n    const db = c.env.DB\n\n    const stmt = db.prepare('SELECT * FROM collections WHERE id = ?')\n    const collection = await stmt.bind(id).first() as any\n\n    if (!collection) {\n      return c.json({ error: 'Collection not found' }, 404)\n    }\n\n    // Get collection fields\n    const fieldsStmt = db.prepare(`\n      SELECT * FROM content_fields\n      WHERE collection_id = ?\n      ORDER BY field_order ASC\n    `)\n    const { results: fieldsResults } = await fieldsStmt.bind(id).all()\n\n    const fields = (fieldsResults || []).map((row: any) => ({\n      id: row.id,\n      field_name: row.field_name,\n      field_type: row.field_type,\n      field_label: row.field_label,\n      field_options: row.field_options ? JSON.parse(row.field_options) : {},\n      field_order: row.field_order,\n      is_required: row.is_required === 1,\n      is_searchable: row.is_searchable === 1,\n      created_at: Number(row.created_at),\n      updated_at: Number(row.updated_at)\n    }))\n\n    return c.json({\n      id: collection.id,\n      name: collection.name,\n      display_name: collection.display_name,\n      description: collection.description,\n      is_active: collection.is_active === 1,\n      managed: collection.managed === 1,\n      schema: collection.schema ? JSON.parse(collection.schema) : null,\n      created_at: Number(collection.created_at),\n      updated_at: Number(collection.updated_at),\n      fields\n    })\n  } catch (error) {\n    console.error('Error fetching collection:', error)\n    return c.json({ error: 'Failed to fetch collection' }, 500)\n  }\n})\n\n/**\n * Get reference options for a collection\n * GET /admin/api/references?collection=<nameOrId>&search=<query>&limit=20&id=<contentId>\n */\nadminApiRoutes.get('/references', async (c) => {\n  try {\n    const db = c.env.DB\n    const url = new URL(c.req.url)\n    const collectionParams = url.searchParams\n      .getAll('collection')\n      .flatMap((value) => value.split(','))\n      .map((value) => value.trim())\n      .filter(Boolean)\n    const search = c.req.query('search') || ''\n    const id = c.req.query('id') || ''\n    const limit = Math.min(Number.parseInt(c.req.query('limit') || '20', 10) || 20, 100)\n\n    if (collectionParams.length === 0) {\n      return c.json({ error: 'Collection is required' }, 400)\n    }\n\n    const placeholders = collectionParams.map(() => '?').join(', ')\n    const collectionStmt = db.prepare(`\n      SELECT id, name, display_name\n      FROM collections\n      WHERE id IN (${placeholders}) OR name IN (${placeholders})\n    `)\n    const collectionResults = await collectionStmt\n      .bind(...collectionParams, ...collectionParams)\n      .all()\n    const collections = (collectionResults.results || []) as any[]\n\n    if (collections.length === 0) {\n      return c.json({ error: 'Collection not found' }, 404)\n    }\n\n    const collectionById = Object.fromEntries(\n      collections.map((entry) => [\n        entry.id,\n        {\n          id: entry.id,\n          name: entry.name,\n          display_name: entry.display_name\n        }\n      ])\n    )\n    const collectionIds = collections.map((entry) => entry.id)\n\n    if (id) {\n      const idPlaceholders = collectionIds.map(() => '?').join(', ')\n      const itemStmt = db.prepare(`\n        SELECT id, title, slug, collection_id\n        FROM content\n        WHERE id = ? AND collection_id IN (${idPlaceholders})\n        LIMIT 1\n      `)\n      const item = await itemStmt.bind(id, ...collectionIds).first() as any\n\n      if (!item) {\n        return c.json({ error: 'Reference not found' }, 404)\n      }\n\n      return c.json({\n        data: {\n          id: item.id,\n          title: item.title,\n          slug: item.slug,\n          collection: collectionById[item.collection_id]\n        }\n      })\n    }\n\n    let stmt\n    let results\n\n    const listPlaceholders = collectionIds.map(() => '?').join(', ')\n    const statusFilterValues = ['published']\n    const statusClause = ` AND status IN (${statusFilterValues.map(() => '?').join(', ')})`\n\n    if (search) {\n      const searchParam = `%${search}%`\n      stmt = db.prepare(`\n        SELECT id, title, slug, status, updated_at, collection_id\n        FROM content\n        WHERE collection_id IN (${listPlaceholders})\n        AND (title LIKE ? OR slug LIKE ?)\n        ${statusClause}\n        ORDER BY updated_at DESC\n        LIMIT ?\n      `)\n      const queryResults = await stmt\n        .bind(...collectionIds, searchParam, searchParam, ...statusFilterValues, limit)\n        .all()\n      results = queryResults.results\n    } else {\n      stmt = db.prepare(`\n        SELECT id, title, slug, status, updated_at, collection_id\n        FROM content\n        WHERE collection_id IN (${listPlaceholders})\n        ${statusClause}\n        ORDER BY updated_at DESC\n        LIMIT ?\n      `)\n      const queryResults = await stmt\n        .bind(...collectionIds, ...statusFilterValues, limit)\n        .all()\n      results = queryResults.results\n    }\n\n    const items = (results || []).map((row: any) => ({\n      id: row.id,\n      title: row.title,\n      slug: row.slug,\n      status: row.status,\n      updated_at: row.updated_at ? Number(row.updated_at) : null,\n      collection: collectionById[row.collection_id]\n    }))\n\n    return c.json({\n      data: items,\n      count: items.length\n    })\n  } catch (error) {\n    console.error('Error fetching reference options:', error)\n    return c.json({ error: 'Failed to fetch references' }, 500)\n  }\n})\n\n/**\n * Create collection\n * POST /admin/api/collections\n */\nadminApiRoutes.post('/collections', async (c) => {\n    try {\n      // Validate content type\n      const contentType = c.req.header('Content-Type')\n      if (!contentType || !contentType.includes('application/json')) {\n        return c.json({ error: 'Content-Type must be application/json' }, 400)\n      }\n\n      let body\n      try {\n        body = await c.req.json()\n      } catch (e) {\n        return c.json({ error: 'Invalid JSON in request body' }, 400)\n      }\n\n      const validation = createCollectionSchema.safeParse(body)\n      if (!validation.success) {\n        return c.json({ error: 'Validation failed', details: validation.error.issues }, 400)\n      }\n      const validatedData = validation.data\n      const db = c.env.DB\n      const _user = c.get('user')\n\n      // Handle both camelCase and snake_case for display_name\n      const displayName = validatedData.displayName || validatedData.display_name || ''\n\n      // Check if collection already exists\n      const existingStmt = db.prepare('SELECT id FROM collections WHERE name = ?')\n      const existing = await existingStmt.bind(validatedData.name).first()\n\n      if (existing) {\n        return c.json({ error: 'A collection with this name already exists' }, 400)\n      }\n\n      // Create basic schema\n      const basicSchema = {\n        type: \"object\",\n        properties: {\n          title: {\n            type: \"string\",\n            title: \"Title\",\n            required: true\n          },\n          content: {\n            type: \"string\",\n            title: \"Content\",\n            format: \"richtext\"\n          },\n          status: {\n            type: \"string\",\n            title: \"Status\",\n            enum: [\"draft\", \"published\", \"archived\"],\n            default: \"draft\"\n          }\n        },\n        required: [\"title\"]\n      }\n\n      const collectionId = crypto.randomUUID()\n      const now = Date.now()\n\n      const insertStmt = db.prepare(`\n        INSERT INTO collections (id, name, display_name, description, schema, is_active, created_at, updated_at)\n        VALUES (?, ?, ?, ?, ?, ?, ?, ?)\n      `)\n\n      await insertStmt.bind(\n        collectionId,\n        validatedData.name,\n        displayName,\n        validatedData.description || null,\n        JSON.stringify(basicSchema),\n        1, // is_active\n        now,\n        now\n      ).run()\n\n      // Clear cache\n      try {\n        await c.env.CACHE_KV.delete('cache:collections:all')\n        await c.env.CACHE_KV.delete(`cache:collection:${validatedData.name}`)\n      } catch (e) {\n        console.error('Error clearing cache:', e)\n      }\n\n      return c.json({\n        id: collectionId,\n        name: validatedData.name,\n        displayName: displayName,\n        description: validatedData.description,\n        created_at: now\n      }, 201)\n    } catch (error) {\n      console.error('Error creating collection:', error)\n      return c.json({ error: 'Failed to create collection' }, 500)\n    }\n})\n\n/**\n * Update collection\n * PATCH /admin/api/collections/:id\n */\nadminApiRoutes.patch('/collections/:id', async (c) => {\n    try {\n      const id = c.req.param('id')\n      const body = await c.req.json()\n      const validation = updateCollectionSchema.safeParse(body)\n      if (!validation.success) {\n        return c.json({ error: 'Validation failed', details: validation.error.issues }, 400)\n      }\n      const validatedData = validation.data\n      const db = c.env.DB\n\n      // Check if collection exists\n      const checkStmt = db.prepare('SELECT * FROM collections WHERE id = ?')\n      const existing = await checkStmt.bind(id).first() as any\n\n      if (!existing) {\n        return c.json({ error: 'Collection not found' }, 404)\n      }\n\n      // Build update query\n      const updateFields: string[] = []\n      const updateParams: any[] = []\n\n      if (validatedData.display_name !== undefined) {\n        updateFields.push('display_name = ?')\n        updateParams.push(validatedData.display_name)\n      }\n\n      if (validatedData.description !== undefined) {\n        updateFields.push('description = ?')\n        updateParams.push(validatedData.description)\n      }\n\n      if (validatedData.is_active !== undefined) {\n        updateFields.push('is_active = ?')\n        updateParams.push(validatedData.is_active ? 1 : 0)\n      }\n\n      if (updateFields.length === 0) {\n        return c.json({ error: 'No fields to update' }, 400)\n      }\n\n      updateFields.push('updated_at = ?')\n      updateParams.push(Date.now())\n      updateParams.push(id)\n\n      const updateStmt = db.prepare(`\n        UPDATE collections\n        SET ${updateFields.join(', ')}\n        WHERE id = ?\n      `)\n\n      await updateStmt.bind(...updateParams).run()\n\n      // Clear cache\n      try {\n        await c.env.CACHE_KV.delete('cache:collections:all')\n        await c.env.CACHE_KV.delete(`cache:collection:${existing.name}`)\n      } catch (e) {\n        console.error('Error clearing cache:', e)\n      }\n\n      return c.json({ message: 'Collection updated successfully' })\n    } catch (error) {\n      console.error('Error updating collection:', error)\n      return c.json({ error: 'Failed to update collection' }, 500)\n    }\n})\n\n/**\n * Delete collection\n * DELETE /admin/api/collections/:id\n */\nadminApiRoutes.delete('/collections/:id', async (c) => {\n  try {\n    const id = c.req.param('id')\n    const db = c.env.DB\n\n    // Check if collection exists\n    const collectionStmt = db.prepare('SELECT name FROM collections WHERE id = ?')\n    const collection = await collectionStmt.bind(id).first() as any\n\n    if (!collection) {\n      return c.json({ error: 'Collection not found' }, 404)\n    }\n\n    // Check if collection has content\n    const contentStmt = db.prepare('SELECT COUNT(*) as count FROM content WHERE collection_id = ?')\n    const contentResult = await contentStmt.bind(id).first() as any\n\n    if (contentResult && contentResult.count > 0) {\n      return c.json({\n        error: `Cannot delete collection: it contains ${contentResult.count} content item(s). Delete all content first.`\n      }, 400)\n    }\n\n    // Delete collection fields first\n    const deleteFieldsStmt = db.prepare('DELETE FROM content_fields WHERE collection_id = ?')\n    await deleteFieldsStmt.bind(id).run()\n\n    // Delete collection\n    const deleteStmt = db.prepare('DELETE FROM collections WHERE id = ?')\n    await deleteStmt.bind(id).run()\n\n    // Clear cache\n    try {\n      await c.env.CACHE_KV.delete('cache:collections:all')\n      await c.env.CACHE_KV.delete(`cache:collection:${collection.name}`)\n    } catch (e) {\n      console.error('Error clearing cache:', e)\n    }\n\n    return c.json({ message: 'Collection deleted successfully' })\n  } catch (error) {\n    console.error('Error deleting collection:', error)\n    return c.json({ error: 'Failed to delete collection' }, 500)\n  }\n})\n\n// Migrations API endpoints\n// Get migration status\nadminApiRoutes.get('/migrations/status', async (c) => {\n  try {\n    const { MigrationService } = await import('../services/migrations')\n    const db = c.env.DB\n    const migrationService = new MigrationService(db)\n    const status = await migrationService.getMigrationStatus()\n\n    return c.json({\n      success: true,\n      data: status\n    })\n  } catch (error) {\n    console.error('Error fetching migration status:', error)\n    return c.json({\n      success: false,\n      error: 'Failed to fetch migration status'\n    }, 500)\n  }\n})\n\n// Run pending migrations\nadminApiRoutes.post('/migrations/run', async (c) => {\n  try {\n    const user = c.get('user')\n\n    // Only allow admin users to run migrations\n    if (!user || user.role !== 'admin') {\n      return c.json({\n        success: false,\n        error: 'Unauthorized. Admin access required.'\n      }, 403)\n    }\n\n    const { MigrationService } = await import('../services/migrations')\n    const db = c.env.DB\n    const migrationService = new MigrationService(db)\n    const result = await migrationService.runPendingMigrations()\n\n    return c.json({\n      success: result.success,\n      message: result.message,\n      applied: result.applied\n    })\n  } catch (error) {\n    console.error('Error running migrations:', error)\n    return c.json({\n      success: false,\n      error: 'Failed to run migrations'\n    }, 500)\n  }\n})\n\n// Validate database schema\nadminApiRoutes.get('/migrations/validate', async (c) => {\n  try {\n    const { MigrationService } = await import('../services/migrations')\n    const db = c.env.DB\n    const migrationService = new MigrationService(db)\n    const validation = await migrationService.validateSchema()\n\n    return c.json({\n      success: true,\n      data: validation\n    })\n  } catch (error) {\n    console.error('Error validating schema:', error)\n    return c.json({\n      success: false,\n      error: 'Failed to validate schema'\n    }, 500)\n  }\n})\n\nexport default adminApiRoutes\n","import { renderAlert } from '../alert.template'\n\nexport interface LoginPageData {\n  error?: string\n  message?: string\n  version?: string\n}\n\nexport function renderLoginPage(data: LoginPageData, demoLoginActive: boolean = false): string {\n  return `\n    <!DOCTYPE html>\n    <html lang=\"en\" class=\"h-full dark\">\n    <head>\n      <meta charset=\"UTF-8\">\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n      <title>Login - WarpCMS</title>\n      <link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\">\n      <script src=\"https://unpkg.com/htmx.org@2.0.3\"></script>\n      <script src=\"https://cdn.tailwindcss.com\"></script>\n      <script>\n        tailwind.config = {\n          darkMode: 'class',\n          theme: {\n            extend: {\n              colors: {\n                error: '#ef4444'\n              }\n            }\n          }\n        }\n      </script>\n      <style>\n        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');\n\n        body {\n          font-family: 'Inter', system-ui, -apple-system, sans-serif;\n        }\n      </style>\n    </head>\n    <body class=\"h-full bg-zinc-950\">\n      <div class=\"flex min-h-full flex-col justify-center py-12 sm:px-6 lg:px-8\">\n        <!-- Logo Section -->\n        <div class=\"sm:mx-auto sm:w-full sm:max-w-md text-center\">\n          <div class=\"mx-auto w-64 mb-8\">\n            <span class=\"font-bold tracking-tight text-cyan-400\" style=\"font-size: 2.5rem\">WarpCMS</span>\n          </div>\n          <h2 class=\"mt-6 text-xl font-medium text-white\">Welcome Back</h2>\n          <p class=\"mt-2 text-sm text-zinc-400\">Sign in to your account to continue</p>\n        </div>\n\n        <!-- Form Container -->\n        <div class=\"mt-8 sm:mx-auto sm:w-full sm:max-w-md\">\n          <div class=\"bg-zinc-900 shadow-sm ring-1 ring-white/10 rounded-xl px-6 py-8 sm:px-10\">\n            <!-- Alerts -->\n            ${data.error ? `<div class=\"mb-6\">${renderAlert({ type: 'error', message: data.error })}</div>` : ''}\n            ${data.message ? `<div class=\"mb-6\">${renderAlert({ type: 'success', message: data.message })}</div>` : ''}\n\n            <!-- Form Response (HTMX target) -->\n            <div id=\"form-response\" class=\"mb-6\"></div>\n\n            <!-- Form -->\n            <form\n              id=\"login-form\"\n              hx-post=\"/auth/login/form\"\n              hx-target=\"#form-response\"\n              hx-swap=\"innerHTML\"\n              class=\"space-y-6\"\n            >\n              <!-- Email -->\n              <div>\n                <label for=\"email\" class=\"block text-sm font-medium text-white mb-2\">\n                  Email Address\n                </label>\n                <input\n                  id=\"email\"\n                  name=\"email\"\n                  type=\"email\"\n                  autocomplete=\"email\"\n                  required\n                  class=\"w-full rounded-lg bg-zinc-800 px-3 py-2 text-sm text-white shadow-sm ring-1 ring-inset ring-white/10 placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-white transition-shadow\"\n                  placeholder=\"Enter your email\"\n                >\n              </div>\n\n              <!-- Password -->\n              <div>\n                <label for=\"password\" class=\"block text-sm font-medium text-white mb-2\">\n                  Password\n                </label>\n                <input\n                  id=\"password\"\n                  name=\"password\"\n                  type=\"password\"\n                  autocomplete=\"current-password\"\n                  required\n                  class=\"w-full rounded-lg bg-zinc-800 px-3 py-2 text-sm text-white shadow-sm ring-1 ring-inset ring-white/10 placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-white transition-shadow\"\n                  placeholder=\"Enter your password\"\n                >\n              </div>\n\n              <!-- Submit Button -->\n              <button\n                type=\"submit\"\n                class=\"w-full rounded-lg bg-white px-4 py-2.5 text-sm font-semibold text-zinc-950 hover:bg-zinc-100 focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-zinc-900 transition-colors\"\n              >\n                Sign In\n              </button>\n            </form>\n\n            <!-- Links -->\n            <div class=\"mt-6 text-center\">\n              <p class=\"text-sm text-zinc-400\">\n                Don't have an account?\n                <a href=\"/auth/register\" class=\"font-semibold text-white hover:text-zinc-300 transition-colors\">Create one here</a>\n              </p>\n            </div>\n          </div>\n\n          <!-- Version -->\n          <div class=\"mt-6 text-center\">\n            <span class=\"inline-flex items-center rounded-md px-2.5 py-1 text-xs font-medium bg-cyan-500/10 text-cyan-400 ring-1 ring-inset ring-cyan-500/20\">\n              v${data.version || '0.1.0'}\n            </span>\n          </div>\n        </div>\n      </div>\n\n      ${demoLoginActive ? `\n      <script>\n        // Demo Login Prefill Script\n        (function() {\n          'use strict';\n\n          function prefillLoginForm() {\n            const emailInput = document.getElementById('email');\n            const passwordInput = document.getElementById('password');\n\n            if (emailInput && passwordInput) {\n              emailInput.value = 'admin@warpcms.com';\n              passwordInput.value = 'warpcms!';\n\n              // Add visual indication that form is prefilled (only if not already present)\n              const form = emailInput.closest('form');\n              if (form && !form.querySelector('.demo-mode-notice')) {\n                const notice = document.createElement('div');\n                notice.className = 'demo-mode-notice mb-6 rounded-lg bg-blue-500/10 p-4 ring-1 ring-blue-500/20';\n                notice.innerHTML = '<div class=\"flex items-start gap-x-3\"><svg class=\"h-5 w-5 text-blue-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"/></svg><div><h3 class=\"text-sm font-semibold text-blue-300\">Demo Mode</h3><p class=\"mt-1 text-sm text-blue-400\">Login form prefilled with demo credentials</p></div></div>';\n                form.insertBefore(notice, form.firstChild);\n              }\n            }\n          }\n\n          // Prefill on page load\n          if (document.readyState === 'loading') {\n            document.addEventListener('DOMContentLoaded', prefillLoginForm);\n          } else {\n            prefillLoginForm();\n          }\n\n          // Also handle HTMX page changes (for SPA-like navigation)\n          document.addEventListener('htmx:afterSwap', function(event) {\n            if (event.detail.target.id === 'main-content' ||\n                document.getElementById('email')) {\n              setTimeout(prefillLoginForm, 100);\n            }\n          });\n        })();\n      </script>\n      ` : ''}\n    </body>\n    </html>\n  `\n}","import { renderAlert } from '../alert.template'\n\nexport interface RegisterPageData {\n  error?: string\n}\n\nexport function renderRegisterPage(data: RegisterPageData): string {\n  return `\n    <!DOCTYPE html>\n    <html lang=\"en\" class=\"h-full dark\">\n    <head>\n      <meta charset=\"UTF-8\">\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n      <title>Register - WarpCMS</title>\n      <link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\">\n      <script src=\"https://unpkg.com/htmx.org@2.0.3\"></script>\n      <script src=\"https://cdn.tailwindcss.com\"></script>\n      <script>\n        tailwind.config = {\n          darkMode: 'class',\n          theme: {\n            extend: {}\n          }\n        }\n      </script>\n      <style>\n        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');\n\n        body {\n          font-family: 'Inter', system-ui, -apple-system, sans-serif;\n        }\n      </style>\n    </head>\n    <body class=\"h-full bg-zinc-950\">\n      <div class=\"flex min-h-full flex-col justify-center py-12 sm:px-6 lg:px-8\">\n        <!-- Logo Section -->\n        <div class=\"sm:mx-auto sm:w-full sm:max-w-md text-center\">\n          <div class=\"mx-auto flex h-12 w-12 items-center justify-center rounded-lg bg-white\">\n            <svg class=\"h-7 w-7 text-zinc-950\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 10V3L4 14h7v7l9-11h-7z\"/>\n            </svg>\n          </div>\n          <h1 class=\"mt-6 text-3xl font-semibold tracking-tight text-white\">WarpCMS</h1>\n          <p class=\"mt-2 text-sm text-zinc-400\">Create your account and get started</p>\n        </div>\n\n        <!-- Form Container -->\n        <div class=\"mt-8 sm:mx-auto sm:w-full sm:max-w-md\">\n          <div class=\"bg-zinc-900 shadow-sm ring-1 ring-white/10 rounded-xl px-6 py-8 sm:px-10\">\n            <!-- Alerts -->\n            ${data.error ? `<div class=\"mb-6\">${renderAlert({ type: 'error', message: data.error })}</div>` : ''}\n\n            <!-- Form -->\n            <form\n              id=\"register-form\"\n              hx-post=\"/auth/register/form\"\n              hx-target=\"#form-response\"\n              hx-swap=\"innerHTML\"\n              class=\"space-y-6\"\n            >\n              <!-- First and Last Name -->\n              <div class=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                <div>\n                  <label for=\"firstName\" class=\"block text-sm font-medium text-white mb-2\">\n                    First Name\n                  </label>\n                  <input\n                    id=\"firstName\"\n                    name=\"firstName\"\n                    type=\"text\"\n                    required\n                    class=\"w-full rounded-lg bg-zinc-800 px-3 py-2 text-sm text-white shadow-sm ring-1 ring-inset ring-white/10 placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-white transition-shadow\"\n                    placeholder=\"First name\"\n                  >\n                </div>\n                <div>\n                  <label for=\"lastName\" class=\"block text-sm font-medium text-white mb-2\">\n                    Last Name\n                  </label>\n                  <input\n                    id=\"lastName\"\n                    name=\"lastName\"\n                    type=\"text\"\n                    required\n                    class=\"w-full rounded-lg bg-zinc-800 px-3 py-2 text-sm text-white shadow-sm ring-1 ring-inset ring-white/10 placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-white transition-shadow\"\n                    placeholder=\"Last name\"\n                  >\n                </div>\n              </div>\n\n              <!-- Username -->\n              <div>\n                <label for=\"username\" class=\"block text-sm font-medium text-white mb-2\">\n                  Username\n                </label>\n                <input\n                  id=\"username\"\n                  name=\"username\"\n                  type=\"text\"\n                  required\n                  class=\"w-full rounded-lg bg-zinc-800 px-3 py-2 text-sm text-white shadow-sm ring-1 ring-inset ring-white/10 placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-white transition-shadow\"\n                  placeholder=\"Choose a username\"\n                >\n              </div>\n\n              <!-- Email -->\n              <div>\n                <label for=\"email\" class=\"block text-sm font-medium text-white mb-2\">\n                  Email Address\n                </label>\n                <input\n                  id=\"email\"\n                  name=\"email\"\n                  type=\"email\"\n                  autocomplete=\"email\"\n                  required\n                  class=\"w-full rounded-lg bg-zinc-800 px-3 py-2 text-sm text-white shadow-sm ring-1 ring-inset ring-white/10 placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-white transition-shadow\"\n                  placeholder=\"Enter your email\"\n                >\n              </div>\n\n              <!-- Password -->\n              <div>\n                <label for=\"password\" class=\"block text-sm font-medium text-white mb-2\">\n                  Password\n                </label>\n                <input\n                  id=\"password\"\n                  name=\"password\"\n                  type=\"password\"\n                  autocomplete=\"new-password\"\n                  required\n                  minlength=\"8\"\n                  class=\"w-full rounded-lg bg-zinc-800 px-3 py-2 text-sm text-white shadow-sm ring-1 ring-inset ring-white/10 placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-white transition-shadow\"\n                  placeholder=\"Create a password (min. 8 characters)\"\n                >\n              </div>\n\n              <!-- Submit Button -->\n              <button\n                type=\"submit\"\n                class=\"w-full rounded-lg bg-white px-4 py-2.5 text-sm font-semibold text-zinc-950 hover:bg-zinc-100 focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-zinc-900 transition-colors\"\n              >\n                Create Account\n              </button>\n            </form>\n\n            <!-- Links -->\n            <div class=\"mt-6 text-center\">\n              <p class=\"text-sm text-zinc-400\">\n                Already have an account?\n                <a href=\"/auth/login\" class=\"font-semibold text-white hover:text-zinc-300 transition-colors\">Sign in here</a>\n              </p>\n            </div>\n\n            <div id=\"form-response\"></div>\n          </div>\n        </div>\n      </div>\n    </body>\n    </html>\n  `\n}","/**\n * Auth Validation Service\n *\n * Provides validation schemas for authentication operations\n */\n\nimport { z } from 'zod'\nimport type { D1Database } from '@cloudflare/workers-types'\n\n// In-memory cache for admin existence check (lazy initialization pattern)\nlet adminExistsCache: boolean | null = null\n\nexport interface AuthSettings {\n  enablePasswordLogin?: boolean\n  enableOAuthLogin?: boolean\n  requireEmailVerification?: boolean\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  [key: string]: any\n}\n\n/**\n * Check if user registration is enabled in the auth plugin settings\n * @param db - D1 database instance\n * @returns true if registration is enabled, false if disabled\n */\nexport async function isRegistrationEnabled(db: D1Database): Promise<boolean> {\n  try {\n    const plugin = await db.prepare('SELECT settings FROM plugins WHERE id = ?')\n      .bind('core-auth')\n      .first() as { settings: string } | null\n\n    if (plugin?.settings) {\n      // Parse settings and check registration.enabled\n      // SQLite stores booleans as 0/1, so check for both false and 0\n      const settings = JSON.parse(plugin.settings)\n      const enabled = settings?.registration?.enabled\n      return enabled !== false && enabled !== 0\n    }\n    return true // Default to enabled if no settings\n  } catch {\n    return true // Default to enabled on error\n  }\n}\n\n/**\n * Check if this would be the first user registration (bootstrap scenario)\n * The first user should always be allowed to register even if registration is disabled\n * @param db - D1 database instance\n * @returns true if no users exist in the database\n */\nexport async function isFirstUserRegistration(db: D1Database): Promise<boolean> {\n  try {\n    const result = await db.prepare('SELECT COUNT(*) as count FROM users').first() as { count: number } | null\n    return result?.count === 0\n  } catch {\n    return false // Default to not first user on error\n  }\n}\n\n/**\n * Check if an admin user exists in the database (with in-memory caching)\n * Uses lazy initialization - only queries DB on first call, then caches result\n * @param db - D1 database instance\n * @returns true if an admin user exists\n */\nexport async function checkAdminUserExists(db: D1Database): Promise<boolean> {\n  // Return cached value if already checked\n  if (adminExistsCache !== null) {\n    return adminExistsCache\n  }\n\n  try {\n    const result = await db.prepare('SELECT id FROM users WHERE role = ?')\n      .bind('admin')\n      .first()\n    adminExistsCache = !!result\n    return adminExistsCache\n  } catch {\n    // On error (e.g., table doesn't exist yet), assume no admin exists\n    return false\n  }\n}\n\n/**\n * Set the admin exists cache to true\n * Call this after successfully creating the first admin user\n */\nexport function setAdminExists(): void {\n  adminExistsCache = true\n}\n\n/**\n * Reset the admin exists cache (for testing purposes)\n */\nexport function resetAdminExistsCache(): void {\n  adminExistsCache = null\n}\n\n/**\n * Auth Validation Service\n * Provides dynamic validation schemas for registration based on database settings\n */\nconst baseRegistrationSchema = z.object({\n  email: z.string().email('Valid email is required'),\n  password: z.string().min(8, 'Password must be at least 8 characters'),\n  username: z.string().min(3, 'Username must be at least 3 characters').optional(),\n  firstName: z.string().min(1, 'First name is required').optional(),\n  lastName: z.string().min(1, 'Last name is required').optional()\n})\n\nexport type RegistrationSchema = typeof baseRegistrationSchema\nexport type RegistrationData = z.infer<RegistrationSchema>\n\nexport const authValidationService = {\n  /**\n   * Build registration schema dynamically based on auth settings\n   * For now, returns a static schema with standard fields\n   */\n  async buildRegistrationSchema(_db: D1Database): Promise<RegistrationSchema> {\n    // TODO: Load settings from database to make fields optional/required dynamically\n    // For now, use a static schema with common registration fields\n    return baseRegistrationSchema\n  },\n\n  /**\n   * Generate default values for optional fields\n   */\n  generateDefaultValue(field: string, data: any): string {\n    switch (field) {\n      case 'username':\n        // Generate username from email (part before @)\n        return data.email ? data.email.split('@')[0] : `user${Date.now()}`\n      case 'firstName':\n        return 'User'\n      case 'lastName':\n        return data.email ? data.email.split('@')[0] : 'Account'\n      default:\n        return ''\n    }\n  }\n}\n","import { Hono } from 'hono'\n// import { zValidator } from '@hono/zod-validator'\nimport { z } from 'zod'\nimport { setCookie } from 'hono/cookie'\nimport { html } from 'hono/html'\nimport { AuthManager, requireAuth } from '../middleware'\nimport { renderLoginPage, LoginPageData } from '../templates/pages/auth-login.template'\nimport { renderRegisterPage, RegisterPageData } from '../templates/pages/auth-register.template'\nimport { getCacheService, CACHE_CONFIGS } from '../services'\nimport { authValidationService, isRegistrationEnabled, isFirstUserRegistration } from '../services/auth-validation'\nimport type { RegistrationData } from '../services/auth-validation'\nimport type { Bindings, Variables } from '../app'\n\nconst authRoutes = new Hono<{ Bindings: Bindings; Variables: Variables }>()\n\n// Login page (HTML form)\nauthRoutes.get('/login', async (c) => {\n  const error = c.req.query('error')\n  const message = c.req.query('message')\n  \n  const pageData: LoginPageData = {\n    error: error || undefined,\n    message: message || undefined,\n    version: c.get('appVersion')\n  }\n  \n  // Check if demo login plugin is active\n  const db = c.env.DB\n  let demoLoginActive = false\n  try {\n    const plugin = await db.prepare('SELECT * FROM plugins WHERE id = ? AND status = ?')\n      .bind('demo-login-prefill', 'active')\n      .first()\n    demoLoginActive = !!plugin\n  } catch (error) {\n    // Ignore database errors - plugin system might not be initialized\n  }\n  \n  return c.html(renderLoginPage(pageData, demoLoginActive))\n})\n\n// Registration page (HTML form)\nauthRoutes.get('/register', async (c) => {\n  const db = c.env.DB\n\n  // Check if this is the first user (bootstrap scenario) - always allow\n  const isFirstUser = await isFirstUserRegistration(db)\n\n  // If not first user, check if registration is enabled\n  if (!isFirstUser) {\n    const registrationEnabled = await isRegistrationEnabled(db)\n    if (!registrationEnabled) {\n      return c.redirect('/auth/login?error=Registration is currently disabled')\n    }\n  }\n\n  const error = c.req.query('error')\n\n  const pageData: RegisterPageData = {\n    error: error || undefined\n  }\n\n  return c.html(renderRegisterPage(pageData))\n})\n\n// Login schema\nconst loginSchema = z.object({\n  email: z.string().email('Valid email is required'),\n  password: z.string().min(1, 'Password is required')\n})\n\n// Register new user\nauthRoutes.post('/register',\n  async (c) => {\n    try {\n      const db = c.env.DB\n\n      // Check if this is the first user (bootstrap scenario) - always allow\n      const isFirstUser = await isFirstUserRegistration(db)\n\n      // If not first user, check if registration is enabled\n      if (!isFirstUser) {\n        const registrationEnabled = await isRegistrationEnabled(db)\n        if (!registrationEnabled) {\n          return c.json({ error: 'Registration is currently disabled' }, 403)\n        }\n      }\n\n      // Parse JSON with error handling\n      let requestData\n      try {\n        requestData = await c.req.json()\n      } catch (parseError) {\n        return c.json({ error: 'Invalid JSON in request body' }, 400)\n      }\n\n      // Build and validate using dynamic schema\n      const validationSchema = await authValidationService.buildRegistrationSchema(db)\n\n      let validatedData: RegistrationData\n      try {\n        validatedData = await validationSchema.parseAsync(requestData)\n      } catch (validationError: any) {\n        return c.json({\n          error: 'Validation failed',\n          details: validationError.issues?.map((e: any) => e.message) || [validationError.message || 'Invalid request data']\n        }, 400)\n      }\n\n      // Extract fields with defaults for optional ones\n      const email = validatedData.email\n      const password = validatedData.password\n      const username = validatedData.username || authValidationService.generateDefaultValue('username', validatedData)\n      const firstName = validatedData.firstName || authValidationService.generateDefaultValue('firstName', validatedData)\n      const lastName = validatedData.lastName || authValidationService.generateDefaultValue('lastName', validatedData)\n\n      // Normalize email to lowercase\n      const normalizedEmail = email.toLowerCase()\n      \n      // Check if user already exists\n      const existingUser = await db.prepare('SELECT id FROM users WHERE email = ? OR username = ?')\n        .bind(normalizedEmail, username)\n        .first()\n      \n      if (existingUser) {\n        return c.json({ error: 'User with this email or username already exists' }, 400)\n      }\n      \n      // Hash password\n      const passwordHash = await AuthManager.hashPassword(password)\n      \n      // Create user\n      const userId = crypto.randomUUID()\n      const now = new Date()\n      \n      await db.prepare(`\n        INSERT INTO users (id, email, username, first_name, last_name, password_hash, role, is_active, created_at, updated_at)\n        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n      `).bind(\n        userId,\n        normalizedEmail,\n        username,\n        firstName,\n        lastName,\n        passwordHash,\n        'viewer', // Default role\n        1, // is_active\n        now.getTime(),\n        now.getTime()\n      ).run()\n      \n      // Generate JWT token\n      const token = await AuthManager.generateToken(userId, normalizedEmail, 'viewer')\n      \n      // Set HTTP-only cookie\n      setCookie(c, 'auth_token', token, {\n        httpOnly: true,\n        secure: true,\n        sameSite: 'Strict',\n        maxAge: 60 * 60 * 24 // 24 hours\n      })\n      \n      return c.json({\n        user: {\n          id: userId,\n          email: normalizedEmail,\n          username,\n          firstName,\n          lastName,\n          role: 'viewer'\n        },\n        token\n      }, 201)\n    } catch (error) {\n      console.error('Registration error:', error)\n      // Return validation errors as 400, other errors as 500\n      if (error instanceof Error && error.message.includes('validation')) {\n        return c.json({ error: error.message }, 400)\n      }\n      return c.json({\n        error: 'Registration failed',\n        details: error instanceof Error ? error.message : String(error)\n      }, 500)\n    }\n  }\n)\n\n// Login user\nauthRoutes.post('/login', async (c) => {\n    try {\n      const body = await c.req.json()\n      const validation = loginSchema.safeParse(body)\n      if (!validation.success) {\n        return c.json({ error: 'Validation failed', details: validation.error.issues }, 400)\n      }\n      const { email, password } = validation.data\n      const db = c.env.DB\n      \n      // Normalize email to lowercase\n      const normalizedEmail = email.toLowerCase()\n      \n      // Find user with caching\n      const cache = getCacheService(CACHE_CONFIGS.user!)\n      let user = await cache.get<any>(cache.generateKey('user', `email:${normalizedEmail}`))\n\n      if (!user) {\n        user = await db.prepare('SELECT * FROM users WHERE email = ? AND is_active = 1')\n          .bind(normalizedEmail)\n          .first() as any\n\n        if (user) {\n          // Cache the user for faster subsequent lookups\n          await cache.set(cache.generateKey('user', `email:${normalizedEmail}`), user)\n          await cache.set(cache.generateKey('user', user.id), user)\n        }\n      }\n\n      if (!user) {\n        return c.json({ error: 'Invalid email or password' }, 401)\n      }\n      \n      // Verify password\n      const isValidPassword = await AuthManager.verifyPassword(password, user.password_hash)\n      if (!isValidPassword) {\n        return c.json({ error: 'Invalid email or password' }, 401)\n      }\n      \n      // Generate JWT token\n      const token = await AuthManager.generateToken(user.id, user.email, user.role)\n      \n      // Set HTTP-only cookie\n      setCookie(c, 'auth_token', token, {\n        httpOnly: true,\n        secure: true,\n        sameSite: 'Strict',\n        maxAge: 60 * 60 * 24 // 24 hours\n      })\n      \n      // Update last login\n      await db.prepare('UPDATE users SET last_login_at = ? WHERE id = ?')\n        .bind(new Date().getTime(), user.id)\n        .run()\n\n      // Invalidate user cache on login\n      await cache.delete(cache.generateKey('user', user.id))\n      await cache.delete(cache.generateKey('user', `email:${normalizedEmail}`))\n\n      return c.json({\n        user: {\n          id: user.id,\n          email: user.email,\n          username: user.username,\n          firstName: user.first_name,\n          lastName: user.last_name,\n          role: user.role\n        },\n        token\n      })\n    } catch (error) {\n      console.error('Login error:', error)\n      return c.json({ error: 'Login failed' }, 500)\n    }\n})\n\n// Logout user (both GET and POST for convenience)\nauthRoutes.post('/logout', (c) => {\n  // Clear the auth cookie\n  setCookie(c, 'auth_token', '', {\n    httpOnly: true,\n    secure: false, // Set to true in production with HTTPS\n    sameSite: 'Strict',\n    maxAge: 0 // Expire immediately\n  })\n  \n  return c.json({ message: 'Logged out successfully' })\n})\n\nauthRoutes.get('/logout', (c) => {\n  // Clear the auth cookie\n  setCookie(c, 'auth_token', '', {\n    httpOnly: true,\n    secure: false, // Set to true in production with HTTPS\n    sameSite: 'Strict',\n    maxAge: 0 // Expire immediately\n  })\n  \n  return c.redirect('/auth/login?message=You have been logged out successfully')\n})\n\n// Get current user\nauthRoutes.get('/me', requireAuth(), async (c) => {\n  try {\n    // This would need the auth middleware applied\n    const user = c.get('user')\n    \n    if (!user) {\n      return c.json({ error: 'Not authenticated' }, 401)\n    }\n    \n    const db = c.env.DB\n    const userData = await db.prepare('SELECT id, email, username, first_name, last_name, role, created_at FROM users WHERE id = ?')\n      .bind(user.userId)\n      .first()\n    \n    if (!userData) {\n      return c.json({ error: 'User not found' }, 404)\n    }\n    \n    return c.json({ user: userData })\n  } catch (error) {\n    console.error('Get user error:', error)\n    return c.json({ error: 'Failed to get user' }, 500)\n  }\n})\n\n// Refresh token\nauthRoutes.post('/refresh', requireAuth(), async (c) => {\n  try {\n    const user = c.get('user')\n    \n    if (!user) {\n      return c.json({ error: 'Not authenticated' }, 401)\n    }\n    \n    // Generate new token\n    const token = await AuthManager.generateToken(user.userId, user.email, user.role)\n    \n    // Set new cookie\n    setCookie(c, 'auth_token', token, {\n      httpOnly: true,\n      secure: true,\n      sameSite: 'Strict',\n      maxAge: 60 * 60 * 24 // 24 hours\n    })\n    \n    return c.json({ token })\n  } catch (error) {\n    console.error('Token refresh error:', error)\n    return c.json({ error: 'Token refresh failed' }, 500)\n  }\n})\n\n// Form-based registration handler (for HTML forms)\nauthRoutes.post('/register/form', async (c) => {\n  try {\n    const db = c.env.DB\n\n    // Check if this is the first user (bootstrap scenario) - always allow\n    const isFirstUser = await isFirstUserRegistration(db)\n\n    // If not first user, check if registration is enabled\n    if (!isFirstUser) {\n      const registrationEnabled = await isRegistrationEnabled(db)\n      if (!registrationEnabled) {\n        return c.html(html`\n          <div class=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\">\n            Registration is currently disabled. Please contact an administrator.\n          </div>\n        `)\n      }\n    }\n\n    const formData = await c.req.formData()\n\n    // Extract form data\n    const requestData = {\n      email: formData.get('email') as string,\n      password: formData.get('password') as string,\n      username: formData.get('username') as string,\n      firstName: formData.get('firstName') as string,\n      lastName: formData.get('lastName') as string,\n    }\n\n    // Normalize email to lowercase\n    const normalizedEmail = requestData.email?.toLowerCase()\n    requestData.email = normalizedEmail\n\n    // Build and validate using dynamic schema\n    const validationSchema = await authValidationService.buildRegistrationSchema(db)\n    const validation = await validationSchema.safeParseAsync(requestData)\n\n    if (!validation.success) {\n      return c.html(html`\n        <div class=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\">\n          ${validation.error.issues.map((err: { message: string }) => err.message).join(', ')}\n        </div>\n      `)\n    }\n\n      const validatedData: RegistrationData = validation.data\n\n    // Extract fields with defaults for optional ones\n    // const email = validatedData.email\n    const password = validatedData.password\n    const username = validatedData.username || authValidationService.generateDefaultValue('username', validatedData)\n    const firstName = validatedData.firstName || authValidationService.generateDefaultValue('firstName', validatedData)\n    const lastName = validatedData.lastName || authValidationService.generateDefaultValue('lastName', validatedData)\n    \n    // Check if user already exists\n    const existingUser = await db.prepare('SELECT id FROM users WHERE email = ? OR username = ?')\n      .bind(normalizedEmail, username)\n      .first()\n    \n    if (existingUser) {\n      return c.html(html`\n        <div class=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\">\n          User with this email or username already exists\n        </div>\n      `)\n    }\n    \n    // Hash password\n    const passwordHash = await AuthManager.hashPassword(password)\n\n    // Determine role: first user gets admin, others get viewer\n    const role = isFirstUser ? 'admin' : 'viewer'\n\n    // Create user\n    const userId = crypto.randomUUID()\n    const now = new Date()\n\n    await db.prepare(`\n      INSERT INTO users (id, email, username, first_name, last_name, password_hash, role, is_active, created_at, updated_at)\n      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n    `).bind(\n      userId,\n      normalizedEmail,\n      username,\n      firstName,\n      lastName,\n      passwordHash,\n      role,\n      1, // is_active\n      now.getTime(),\n      now.getTime()\n    ).run()\n\n    // Generate JWT token\n    const token = await AuthManager.generateToken(userId, normalizedEmail, role)\n\n    // Set HTTP-only cookie\n    setCookie(c, 'auth_token', token, {\n      httpOnly: true,\n      secure: false, // Set to true in production with HTTPS\n      sameSite: 'Strict',\n      maxAge: 60 * 60 * 24 // 24 hours\n    })\n\n    // Redirect based on role\n    const redirectUrl = role === 'admin' ? '/admin/dashboard' : '/admin/dashboard'\n\n    return c.html(html`\n      <div class=\"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded\">\n        Account created successfully! Redirecting...\n        <script>\n          setTimeout(() => {\n            window.location.href = '${redirectUrl}';\n          }, 2000);\n        </script>\n      </div>\n    `)\n  } catch (error) {\n    console.error('Registration error:', error)\n    return c.html(html`\n      <div class=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\">\n        Registration failed. Please try again.\n      </div>\n    `)\n  }\n})\n\n// Form-based login handler (for HTML forms)\nauthRoutes.post('/login/form', async (c) => {\n  try {\n    const formData = await c.req.formData()\n    const email = formData.get('email') as string\n    const password = formData.get('password') as string\n\n    // Normalize email to lowercase\n    const normalizedEmail = email.toLowerCase()\n\n    // Validate the data\n    const validation = loginSchema.safeParse({ email: normalizedEmail, password })\n\n    if (!validation.success) {\n      return c.html(html`\n        <div class=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\">\n          ${validation.error.issues.map((err: { message: string }) => err.message).join(', ')}\n        </div>\n      `)\n    }\n\n    const db = c.env.DB\n    \n    // Find user\n    const user = await db.prepare('SELECT * FROM users WHERE email = ? AND is_active = 1')\n      .bind(normalizedEmail)\n      .first() as any\n    \n    if (!user) {\n      return c.html(html`\n        <div class=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\">\n          Invalid email or password\n        </div>\n      `)\n    }\n    \n    // Verify password\n    const isValidPassword = await AuthManager.verifyPassword(password, user.password_hash)\n    if (!isValidPassword) {\n      return c.html(html`\n        <div class=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\">\n          Invalid email or password\n        </div>\n      `)\n    }\n    \n    // Generate JWT token\n    const token = await AuthManager.generateToken(user.id, user.email, user.role)\n    \n    // Set HTTP-only cookie\n    setCookie(c, 'auth_token', token, {\n      httpOnly: true,\n      secure: false, // Set to true in production with HTTPS\n      sameSite: 'Strict',\n      maxAge: 60 * 60 * 24 // 24 hours\n    })\n    \n    // Update last login\n    await db.prepare('UPDATE users SET last_login_at = ? WHERE id = ?')\n      .bind(new Date().getTime(), user.id)\n      .run()\n    \n    return c.html(html`\n      <div id=\"form-response\">\n        <div class=\"rounded-lg bg-green-100 dark:bg-lime-500/10 p-4 ring-1 ring-green-400 dark:ring-lime-500/20\">\n          <div class=\"flex items-start gap-x-3\">\n            <svg class=\"h-5 w-5 text-green-600 dark:text-lime-400 shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"/>\n            </svg>\n            <div class=\"flex-1\">\n              <p class=\"text-sm font-medium text-green-700 dark:text-lime-300\">Login successful! Redirecting to admin dashboard...</p>\n            </div>\n          </div>\n          <script>\n            setTimeout(() => {\n              window.location.href = '/admin/dashboard';\n            }, 2000);\n          </script>\n        </div>\n      </div>\n    `)\n  } catch (error) {\n    console.error('Login error:', error)\n    return c.html(html`\n      <div class=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\">\n        Login failed. Please try again.\n      </div>\n    `)\n  }\n})\n\n// Test seeding endpoint (only for development/testing)\nauthRoutes.post('/seed-admin', async (c) => {\n  try {\n    const db = c.env.DB\n    \n    // First ensure the users table exists\n    await db.prepare(`\n      CREATE TABLE IF NOT EXISTS users (\n        id TEXT PRIMARY KEY,\n        email TEXT NOT NULL UNIQUE,\n        username TEXT NOT NULL UNIQUE,\n        first_name TEXT NOT NULL,\n        last_name TEXT NOT NULL,\n        password_hash TEXT,\n        role TEXT NOT NULL DEFAULT 'viewer',\n        avatar TEXT,\n        is_active INTEGER NOT NULL DEFAULT 1,\n        last_login_at INTEGER,\n        created_at INTEGER NOT NULL,\n        updated_at INTEGER NOT NULL\n      )\n    `).run()\n    \n    // Check if admin user already exists\n    const existingAdmin = await db.prepare('SELECT id FROM users WHERE email = ? OR username = ?')\n      .bind('admin@warpcms.com', 'admin')\n      .first()\n\n    if (existingAdmin) {\n      // Update the password to ensure it's correct for testing\n      const passwordHash = await AuthManager.hashPassword('warpcms!')\n      await db.prepare('UPDATE users SET password_hash = ?, updated_at = ? WHERE id = ?')\n        .bind(passwordHash, Date.now(), existingAdmin.id)\n        .run()\n\n      return c.json({\n        message: 'Admin user already exists (password updated)',\n        user: {\n          id: existingAdmin.id,\n          email: 'admin@warpcms.com',\n          username: 'admin',\n          role: 'admin'\n        }\n      })\n    }\n\n    // Hash password\n    const passwordHash = await AuthManager.hashPassword('warpcms!')\n    \n    // Create admin user\n    const userId = 'admin-user-id'\n    const now = Date.now()\n    const adminEmail = 'admin@warpcms.com'.toLowerCase()\n    \n    await db.prepare(`\n      INSERT INTO users (id, email, username, first_name, last_name, password_hash, role, is_active, created_at, updated_at)\n      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n    `).bind(\n      userId,\n      adminEmail,\n      'admin',\n      'Admin',\n      'User',\n      passwordHash,\n      'admin',\n      1, // is_active\n      now,\n      now\n    ).run()\n    \n    return c.json({ \n      message: 'Admin user created successfully',\n      user: {\n        id: userId,\n        email: adminEmail,\n        username: 'admin',\n        role: 'admin'\n      },\n      passwordHash: passwordHash // For debugging\n    })\n  } catch (error) {\n    console.error('Seed admin error:', error)\n    return c.json({ error: 'Failed to create admin user', details: error instanceof Error ? error.message : String(error) }, 500)\n  }\n})\n\n\n// Accept invitation page\nauthRoutes.get('/accept-invitation', async (c) => {\n  try {\n    const token = c.req.query('token')\n    \n    if (!token) {\n      return c.html(`\n        <html>\n          <head><title>Invalid Invitation</title></head>\n          <body>\n            <h1>Invalid Invitation</h1>\n            <p>The invitation link is invalid or has expired.</p>\n            <a href=\"/auth/login\">Go to Login</a>\n          </body>\n        </html>\n      `)\n    }\n\n    const db = c.env.DB\n    \n    // Check if invitation token is valid\n    const userStmt = db.prepare(`\n      SELECT id, email, first_name, last_name, role, invited_at\n      FROM users \n      WHERE invitation_token = ? AND is_active = 0\n    `)\n    const invitedUser = await userStmt.bind(token).first() as any\n\n    if (!invitedUser) {\n      return c.html(`\n        <html>\n          <head><title>Invalid Invitation</title></head>\n          <body>\n            <h1>Invalid Invitation</h1>\n            <p>The invitation link is invalid or has expired.</p>\n            <a href=\"/auth/login\">Go to Login</a>\n          </body>\n        </html>\n      `)\n    }\n\n    // Check if invitation is expired (7 days)\n    const invitationAge = Date.now() - invitedUser.invited_at\n    const maxAge = 7 * 24 * 60 * 60 * 1000 // 7 days\n    \n    if (invitationAge > maxAge) {\n      return c.html(`\n        <html>\n          <head><title>Invitation Expired</title></head>\n          <body>\n            <h1>Invitation Expired</h1>\n            <p>This invitation has expired. Please contact your administrator for a new invitation.</p>\n            <a href=\"/auth/login\">Go to Login</a>\n          </body>\n        </html>\n      `)\n    }\n\n    // Show invitation acceptance form\n    return c.html(`\n      <!DOCTYPE html>\n      <html lang=\"en\">\n      <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>Accept Invitation - WarpCMS AI</title>\n        <script src=\"https://cdn.tailwindcss.com\"></script>\n        <style>\n          body {\n            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);\n            min-height: 100vh;\n          }\n        </style>\n      </head>\n      <body class=\"bg-gray-900 text-white\">\n        <div class=\"min-h-screen flex items-center justify-center px-4\">\n          <div class=\"max-w-md w-full space-y-8\">\n            <div class=\"text-center\">\n              <div class=\"mx-auto w-16 h-16 bg-blue-600 rounded-2xl flex items-center justify-center mb-6\">\n                <svg class=\"w-8 h-8 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z\"/>\n                </svg>\n              </div>\n              <h2 class=\"text-3xl font-bold\">Accept Invitation</h2>\n              <p class=\"mt-2 text-gray-400\">Complete your account setup</p>\n              <p class=\"mt-4 text-sm\">\n                You've been invited as <strong>${invitedUser.first_name} ${invitedUser.last_name}</strong><br>\n                <span class=\"text-gray-400\">${invitedUser.email}</span><br>\n                <span class=\"text-blue-400 capitalize\">${invitedUser.role}</span>\n              </p>\n            </div>\n\n            <form method=\"POST\" action=\"/auth/accept-invitation\" class=\"mt-8 space-y-6\">\n              <input type=\"hidden\" name=\"token\" value=\"${token}\" />\n              \n              <div>\n                <label class=\"block text-sm font-medium text-gray-300 mb-2\">Username</label>\n                <input \n                  type=\"text\" \n                  name=\"username\" \n                  required\n                  class=\"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-xl text-white focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500 transition-all\"\n                  placeholder=\"Enter your username\"\n                >\n              </div>\n\n              <div>\n                <label class=\"block text-sm font-medium text-gray-300 mb-2\">Password</label>\n                <input \n                  type=\"password\" \n                  name=\"password\" \n                  required\n                  minlength=\"8\"\n                  class=\"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-xl text-white focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500 transition-all\"\n                  placeholder=\"Enter your password\"\n                >\n                <p class=\"text-xs text-gray-400 mt-1\">Password must be at least 8 characters long</p>\n              </div>\n\n              <div>\n                <label class=\"block text-sm font-medium text-gray-300 mb-2\">Confirm Password</label>\n                <input \n                  type=\"password\" \n                  name=\"confirm_password\" \n                  required\n                  minlength=\"8\"\n                  class=\"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-xl text-white focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500 transition-all\"\n                  placeholder=\"Confirm your password\"\n                >\n              </div>\n\n              <button \n                type=\"submit\"\n                class=\"w-full py-3 px-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-semibold rounded-xl hover:from-blue-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-900 transition-all\"\n              >\n                Accept Invitation & Create Account\n              </button>\n            </form>\n          </div>\n        </div>\n      </body>\n      </html>\n    `)\n\n  } catch (error) {\n    console.error('Accept invitation page error:', error)\n    return c.html(`\n      <html>\n        <head><title>Error</title></head>\n        <body>\n          <h1>Error</h1>\n          <p>An error occurred while processing your invitation.</p>\n          <a href=\"/auth/login\">Go to Login</a>\n        </body>\n      </html>\n    `)\n  }\n})\n\n// Process invitation acceptance\nauthRoutes.post('/accept-invitation', async (c) => {\n  try {\n    const formData = await c.req.formData()\n    const token = formData.get('token')?.toString()\n    const username = formData.get('username')?.toString()?.trim()\n    const password = formData.get('password')?.toString()\n    const confirmPassword = formData.get('confirm_password')?.toString()\n\n    if (!token || !username || !password || !confirmPassword) {\n      return c.json({ error: 'All fields are required' }, 400)\n    }\n\n    if (password !== confirmPassword) {\n      return c.json({ error: 'Passwords do not match' }, 400)\n    }\n\n    if (password.length < 8) {\n      return c.json({ error: 'Password must be at least 8 characters long' }, 400)\n    }\n\n    const db = c.env.DB\n\n    // Check if invitation token is valid\n    const userStmt = db.prepare(`\n      SELECT id, email, first_name, last_name, role, invited_at\n      FROM users \n      WHERE invitation_token = ? AND is_active = 0\n    `)\n    const invitedUser = await userStmt.bind(token).first() as any\n\n    if (!invitedUser) {\n      return c.json({ error: 'Invalid or expired invitation' }, 400)\n    }\n\n    // Check if invitation is expired (7 days)\n    const invitationAge = Date.now() - invitedUser.invited_at\n    const maxAge = 7 * 24 * 60 * 60 * 1000 // 7 days\n    \n    if (invitationAge > maxAge) {\n      return c.json({ error: 'Invitation has expired' }, 400)\n    }\n\n    // Check if username is available\n    const existingUsernameStmt = db.prepare(`\n      SELECT id FROM users WHERE username = ? AND id != ?\n    `)\n    const existingUsername = await existingUsernameStmt.bind(username, invitedUser.id).first()\n\n    if (existingUsername) {\n      return c.json({ error: 'Username is already taken' }, 400)\n    }\n\n    // Hash password\n    const passwordHash = await AuthManager.hashPassword(password)\n\n    // Activate user account\n    const updateStmt = db.prepare(`\n      UPDATE users SET \n        username = ?,\n        password_hash = ?,\n        is_active = 1,\n        email_verified = 1,\n        invitation_token = NULL,\n        accepted_invitation_at = ?,\n        updated_at = ?\n      WHERE id = ?\n    `)\n\n    await updateStmt.bind(\n      username,\n      passwordHash,\n      Date.now(),\n      Date.now(),\n      invitedUser.id\n    ).run()\n\n    // Generate JWT token for auto-login\n    const authToken = await AuthManager.generateToken(invitedUser.id, invitedUser.email, invitedUser.role)\n    \n    // Set HTTP-only cookie\n    setCookie(c, 'auth_token', authToken, {\n      httpOnly: true,\n      secure: true,\n      sameSite: 'Strict',\n      maxAge: 60 * 60 * 24 // 24 hours\n    })\n\n    // Log the activity (TODO: implement activity logging)\n    // Activity logging is deferred until utils/log-activity is implemented\n\n    // Redirect to admin dashboard\n    return c.redirect('/admin/dashboard?welcome=true')\n\n  } catch (error) {\n    console.error('Accept invitation error:', error)\n    return c.json({ error: 'Failed to accept invitation' }, 500)\n  }\n})\n\n// Request password reset\nauthRoutes.post('/request-password-reset', async (c) => {\n  try {\n    const formData = await c.req.formData()\n    const email = formData.get('email')?.toString()?.trim()?.toLowerCase()\n\n    if (!email) {\n      return c.json({ error: 'Email is required' }, 400)\n    }\n\n    // Validate email format\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/\n    if (!emailRegex.test(email)) {\n      return c.json({ error: 'Please enter a valid email address' }, 400)\n    }\n\n    const db = c.env.DB\n\n    // Check if user exists and is active\n    const userStmt = db.prepare(`\n      SELECT id, email, first_name, last_name FROM users \n      WHERE email = ? AND is_active = 1\n    `)\n    const user = await userStmt.bind(email).first() as any\n\n    // Always return success to prevent email enumeration\n    if (!user) {\n      return c.json({\n        success: true,\n        message: 'If an account with this email exists, a password reset link has been sent.'\n      })\n    }\n\n    // Generate password reset token (expires in 1 hour)\n    const resetToken = crypto.randomUUID()\n    const resetExpires = Date.now() + (60 * 60 * 1000) // 1 hour\n\n    // Update user with reset token\n    const updateStmt = db.prepare(`\n      UPDATE users SET \n        password_reset_token = ?,\n        password_reset_expires = ?,\n        updated_at = ?\n      WHERE id = ?\n    `)\n\n    await updateStmt.bind(\n      resetToken,\n      resetExpires,\n      Date.now(),\n      user.id\n    ).run()\n\n    // Log the activity (TODO: implement activity logging)\n    // Activity logging is deferred until utils/log-activity is implemented\n\n    // In a real implementation, you would send an email here\n    // For now, we'll return the reset link for development\n    const resetLink = `${c.req.header('origin') || 'http://localhost:8787'}/auth/reset-password?token=${resetToken}`\n\n    return c.json({\n      success: true,\n      message: 'If an account with this email exists, a password reset link has been sent.',\n      reset_link: resetLink // In production, this would be sent via email\n    })\n\n  } catch (error) {\n    console.error('Password reset request error:', error)\n    return c.json({ error: 'Failed to process password reset request' }, 500)\n  }\n})\n\n// Show password reset form\nauthRoutes.get('/reset-password', async (c) => {\n  try {\n    const token = c.req.query('token')\n    \n    if (!token) {\n      return c.html(`\n        <html>\n          <head><title>Invalid Reset Link</title></head>\n          <body>\n            <h1>Invalid Reset Link</h1>\n            <p>The password reset link is invalid or has expired.</p>\n            <a href=\"/auth/login\">Go to Login</a>\n          </body>\n        </html>\n      `)\n    }\n\n    const db = c.env.DB\n    \n    // Check if reset token is valid and not expired\n    const userStmt = db.prepare(`\n      SELECT id, email, first_name, last_name, password_reset_expires\n      FROM users \n      WHERE password_reset_token = ? AND is_active = 1\n    `)\n    const user = await userStmt.bind(token).first() as any\n\n    if (!user) {\n      return c.html(`\n        <html>\n          <head><title>Invalid Reset Link</title></head>\n          <body>\n            <h1>Invalid Reset Link</h1>\n            <p>The password reset link is invalid or has already been used.</p>\n            <a href=\"/auth/login\">Go to Login</a>\n          </body>\n        </html>\n      `)\n    }\n\n    // Check if token is expired\n    if (Date.now() > user.password_reset_expires) {\n      return c.html(`\n        <html>\n          <head><title>Reset Link Expired</title></head>\n          <body>\n            <h1>Reset Link Expired</h1>\n            <p>The password reset link has expired. Please request a new one.</p>\n            <a href=\"/auth/login\">Go to Login</a>\n          </body>\n        </html>\n      `)\n    }\n\n    // Show password reset form\n    return c.html(`\n      <!DOCTYPE html>\n      <html lang=\"en\">\n      <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>Reset Password - WarpCMS AI</title>\n        <script src=\"https://cdn.tailwindcss.com\"></script>\n        <style>\n          body {\n            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);\n            min-height: 100vh;\n          }\n        </style>\n      </head>\n      <body class=\"bg-gray-900 text-white\">\n        <div class=\"min-h-screen flex items-center justify-center px-4\">\n          <div class=\"max-w-md w-full space-y-8\">\n            <div class=\"text-center\">\n              <div class=\"mx-auto w-16 h-16 bg-blue-600 rounded-2xl flex items-center justify-center mb-6\">\n                <svg class=\"w-8 h-8 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-3.586l4.293-4.293A6 6 0 0119 9z\"/>\n                </svg>\n              </div>\n              <h2 class=\"text-3xl font-bold\">Reset Password</h2>\n              <p class=\"mt-2 text-gray-400\">Choose a new password for your account</p>\n              <p class=\"mt-4 text-sm\">\n                Reset password for <strong>${user.first_name} ${user.last_name}</strong><br>\n                <span class=\"text-gray-400\">${user.email}</span>\n              </p>\n            </div>\n\n            <form method=\"POST\" action=\"/auth/reset-password\" class=\"mt-8 space-y-6\">\n              <input type=\"hidden\" name=\"token\" value=\"${token}\" />\n              \n              <div>\n                <label class=\"block text-sm font-medium text-gray-300 mb-2\">New Password</label>\n                <input \n                  type=\"password\" \n                  name=\"password\" \n                  required\n                  minlength=\"8\"\n                  class=\"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-xl text-white focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500 transition-all\"\n                  placeholder=\"Enter your new password\"\n                >\n                <p class=\"text-xs text-gray-400 mt-1\">Password must be at least 8 characters long</p>\n              </div>\n\n              <div>\n                <label class=\"block text-sm font-medium text-gray-300 mb-2\">Confirm New Password</label>\n                <input \n                  type=\"password\" \n                  name=\"confirm_password\" \n                  required\n                  minlength=\"8\"\n                  class=\"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded-xl text-white focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500 transition-all\"\n                  placeholder=\"Confirm your new password\"\n                >\n              </div>\n\n              <button \n                type=\"submit\"\n                class=\"w-full py-3 px-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-semibold rounded-xl hover:from-blue-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-900 transition-all\"\n              >\n                Reset Password\n              </button>\n            </form>\n\n            <div class=\"text-center\">\n              <a href=\"/auth/login\" class=\"text-sm text-blue-400 hover:text-blue-300\">\n                Back to Login\n              </a>\n            </div>\n          </div>\n        </div>\n      </body>\n      </html>\n    `)\n\n  } catch (error) {\n    console.error('Password reset page error:', error)\n    return c.html(`\n      <html>\n        <head><title>Error</title></head>\n        <body>\n          <h1>Error</h1>\n          <p>An error occurred while processing your password reset.</p>\n          <a href=\"/auth/login\">Go to Login</a>\n        </body>\n      </html>\n    `)\n  }\n})\n\n// Process password reset\nauthRoutes.post('/reset-password', async (c) => {\n  try {\n    const formData = await c.req.formData()\n    const token = formData.get('token')?.toString()\n    const password = formData.get('password')?.toString()\n    const confirmPassword = formData.get('confirm_password')?.toString()\n\n    if (!token || !password || !confirmPassword) {\n      return c.json({ error: 'All fields are required' }, 400)\n    }\n\n    if (password !== confirmPassword) {\n      return c.json({ error: 'Passwords do not match' }, 400)\n    }\n\n    if (password.length < 8) {\n      return c.json({ error: 'Password must be at least 8 characters long' }, 400)\n    }\n\n    const db = c.env.DB\n\n    // Check if reset token is valid and not expired\n    const userStmt = db.prepare(`\n      SELECT id, email, password_hash, password_reset_expires\n      FROM users\n      WHERE password_reset_token = ? AND is_active = 1\n    `)\n    const user = await userStmt.bind(token).first() as any\n\n    if (!user) {\n      return c.json({ error: 'Invalid or expired reset token' }, 400)\n    }\n\n    // Check if token is expired\n    if (Date.now() > user.password_reset_expires) {\n      return c.json({ error: 'Reset token has expired' }, 400)\n    }\n\n    // Hash new password\n    const newPasswordHash = await AuthManager.hashPassword(password)\n\n    // Store old password in history (skip if table doesn't exist)\n    try {\n      const historyStmt = db.prepare(`\n        INSERT INTO password_history (id, user_id, password_hash, created_at)\n        VALUES (?, ?, ?, ?)\n      `)\n      await historyStmt.bind(\n        crypto.randomUUID(),\n        user.id,\n        user.password_hash,\n        Date.now()\n      ).run()\n    } catch (historyError) {\n      // Password history table may not exist yet\n      console.warn('Could not store password history:', historyError)\n    }\n\n    // Update user password and clear reset token\n    const updateStmt = db.prepare(`\n      UPDATE users SET\n        password_hash = ?,\n        password_reset_token = NULL,\n        password_reset_expires = NULL,\n        updated_at = ?\n      WHERE id = ?\n    `)\n\n    await updateStmt.bind(\n      newPasswordHash,\n      Date.now(),\n      user.id\n    ).run()\n\n    // Log the activity (TODO: implement activity logging)\n    // Activity logging is deferred until utils/log-activity is implemented\n\n    // Redirect to login with success message\n    return c.redirect('/auth/login?message=Password reset successfully. Please log in with your new password.')\n\n  } catch (error) {\n    console.error('Password reset error:', error)\n    return c.json({ error: 'Failed to reset password' }, 500)\n  }\n})\n\nexport default authRoutes\n","/**\n * Test Cleanup Routes\n *\n * Provides endpoints to clean up test data after e2e tests\n * WARNING: These endpoints should only be available in development/test environments\n */\n\nimport { Hono } from 'hono'\nimport type { Context } from 'hono'\nimport type { D1Database } from '@cloudflare/workers-types'\n\nconst app = new Hono()\n\n/**\n * Clean up all test data (collections, content, users except admin)\n * POST /test-cleanup\n */\napp.post('/test-cleanup', async (c: Context) => {\n  const db = c.env.DB as D1Database\n\n  // Only allow in development/test environments\n  if (c.env.ENVIRONMENT === 'production') {\n    return c.json({ error: 'Cleanup endpoint not available in production' }, 403)\n  }\n\n  try {\n    let deletedCount = 0\n\n    // Use pattern-based deletes to avoid SQL variable limits\n    // This approach uses subqueries instead of building large IN lists\n\n    // Step 1: Delete child data for test content (by pattern)\n    await db.prepare(`\n      DELETE FROM content_versions\n      WHERE content_id IN (\n        SELECT id FROM content\n        WHERE title LIKE 'Test %' OR title LIKE '%E2E%' OR title LIKE '%Playwright%' OR title LIKE '%Sample%'\n      )\n    `).run()\n\n    await db.prepare(`\n      DELETE FROM workflow_history\n      WHERE content_id IN (\n        SELECT id FROM content\n        WHERE title LIKE 'Test %' OR title LIKE '%E2E%' OR title LIKE '%Playwright%' OR title LIKE '%Sample%'\n      )\n    `).run()\n\n    // Note: content_data table may not exist in all schemas\n    try {\n      await db.prepare(`\n        DELETE FROM content_data\n        WHERE content_id IN (\n          SELECT id FROM content\n          WHERE title LIKE 'Test %' OR title LIKE '%E2E%' OR title LIKE '%Playwright%' OR title LIKE '%Sample%'\n        )\n      `).run()\n    } catch (e) {\n      // Table doesn't exist, skip\n    }\n\n    // Step 2: Delete test content by pattern\n    const contentResult = await db.prepare(`\n      DELETE FROM content\n      WHERE title LIKE 'Test %' OR title LIKE '%E2E%' OR title LIKE '%Playwright%' OR title LIKE '%Sample%'\n    `).run()\n    deletedCount += contentResult.meta?.changes || 0\n\n    // Step 3: Delete child data for test users\n    await db.prepare(`\n      DELETE FROM api_tokens\n      WHERE user_id IN (\n        SELECT id FROM users\n        WHERE email != 'admin@warpcms.com' AND (email LIKE '%test%' OR email LIKE '%example.com%')\n      )\n    `).run()\n\n    await db.prepare(`\n      DELETE FROM media\n      WHERE uploaded_by IN (\n        SELECT id FROM users\n        WHERE email != 'admin@warpcms.com' AND (email LIKE '%test%' OR email LIKE '%example.com%')\n      )\n    `).run()\n\n    // Step 4: Delete test users\n    const usersResult = await db.prepare(`\n      DELETE FROM users\n      WHERE email != 'admin@warpcms.com' AND (email LIKE '%test%' OR email LIKE '%example.com%')\n    `).run()\n    deletedCount += usersResult.meta?.changes || 0\n\n    // Step 5: Delete child data for test collections\n    try {\n      await db.prepare(`\n        DELETE FROM collection_fields\n        WHERE collection_id IN (\n          SELECT id FROM collections\n          WHERE name LIKE 'test_%' OR name IN ('blog_posts', 'test_collection', 'products', 'articles')\n        )\n      `).run()\n    } catch (e) {\n      // Table doesn't exist\n    }\n\n    // Delete remaining content from test collections\n    await db.prepare(`\n      DELETE FROM content\n      WHERE collection_id IN (\n        SELECT id FROM collections\n        WHERE name LIKE 'test_%' OR name IN ('blog_posts', 'test_collection', 'products', 'articles')\n      )\n    `).run()\n\n    // Step 6: Delete test collections\n    const collectionsResult = await db.prepare(`\n      DELETE FROM collections\n      WHERE name LIKE 'test_%' OR name IN ('blog_posts', 'test_collection', 'products', 'articles')\n    `).run()\n    deletedCount += collectionsResult.meta?.changes || 0\n\n    // Step 7: Clean up orphaned data (skip if tables don't exist)\n    try {\n      await db.prepare(`\n        DELETE FROM content_data WHERE content_id NOT IN (SELECT id FROM content)\n      `).run()\n    } catch (e) {\n      // Table doesn't exist\n    }\n\n    try {\n      await db.prepare(`\n        DELETE FROM collection_fields WHERE collection_id NOT IN (SELECT id FROM collections)\n      `).run()\n    } catch (e) {\n      // Table doesn't exist\n    }\n\n    try {\n      await db.prepare(`\n        DELETE FROM content_versions WHERE content_id NOT IN (SELECT id FROM content)\n      `).run()\n    } catch (e) {\n      // Table doesn't exist\n    }\n\n    try {\n      await db.prepare(`\n        DELETE FROM workflow_history WHERE content_id NOT IN (SELECT id FROM content)\n      `).run()\n    } catch (e) {\n      // Table doesn't exist\n    }\n\n    // Step 8: Delete old activity logs (keep only last 100)\n    await db.prepare(`\n      DELETE FROM activity_logs\n      WHERE id NOT IN (\n        SELECT id FROM activity_logs\n        ORDER BY created_at DESC\n        LIMIT 100\n      )\n    `).run()\n\n    return c.json({\n      success: true,\n      deletedCount,\n      message: 'Test data cleaned up successfully'\n    })\n  } catch (error) {\n    console.error('Test cleanup error:', error)\n    return c.json({\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error'\n    }, 500)\n  }\n})\n\n/**\n * Clean up test users only\n * POST /test-cleanup/users\n */\napp.post('/test-cleanup/users', async (c: Context) => {\n  const db = c.env.DB as D1Database\n\n  // Only allow in development/test environments\n  if (c.env.ENVIRONMENT === 'production') {\n    return c.json({ error: 'Cleanup endpoint not available in production' }, 403)\n  }\n\n  try {\n    // Delete test users (preserve admin)\n    const result = await db.prepare(`\n      DELETE FROM users\n      WHERE email != 'admin@warpcms.com'\n      AND (\n        email LIKE '%test%'\n        OR email LIKE '%example.com%'\n        OR first_name = 'Test'\n      )\n    `).run()\n\n    return c.json({\n      success: true,\n      deletedCount: result.meta?.changes || 0,\n      message: 'Test users cleaned up successfully'\n    })\n  } catch (error) {\n    console.error('User cleanup error:', error)\n    return c.json({\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error'\n    }, 500)\n  }\n})\n\n/**\n * Clean up test collections only\n * POST /test-cleanup/collections\n */\napp.post('/test-cleanup/collections', async (c: Context) => {\n  const db = c.env.DB as D1Database\n\n  // Only allow in development/test environments\n  if (c.env.ENVIRONMENT === 'production') {\n    return c.json({ error: 'Cleanup endpoint not available in production' }, 403)\n  }\n\n  try {\n    let deletedCount = 0\n\n    // Get test collection IDs first\n    const collections = await db.prepare(`\n      SELECT id FROM collections\n      WHERE name LIKE 'test_%'\n      OR name IN ('blog_posts', 'test_collection', 'products', 'articles')\n    `).all()\n\n    if (collections.results && collections.results.length > 0) {\n      const collectionIds = collections.results.map((c: any) => c.id)\n\n      // Delete associated fields\n      for (const id of collectionIds) {\n        await db.prepare('DELETE FROM collection_fields WHERE collection_id = ?').bind(id).run()\n      }\n\n      // Delete associated content\n      for (const id of collectionIds) {\n        await db.prepare('DELETE FROM content WHERE collection_id = ?').bind(id).run()\n      }\n\n      // Delete the collections\n      const result = await db.prepare(`\n        DELETE FROM collections\n        WHERE id IN (${collectionIds.map(() => '?').join(',')})\n      `).bind(...collectionIds).run()\n\n      deletedCount = result.meta?.changes || 0\n    }\n\n    return c.json({\n      success: true,\n      deletedCount,\n      message: 'Test collections cleaned up successfully'\n    })\n  } catch (error) {\n    console.error('Collection cleanup error:', error)\n    return c.json({\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error'\n    }, 500)\n  }\n})\n\n/**\n * Clean up test content only\n * POST /test-cleanup/content\n */\napp.post('/test-cleanup/content', async (c: Context) => {\n  const db = c.env.DB as D1Database\n\n  // Only allow in development/test environments\n  if (c.env.ENVIRONMENT === 'production') {\n    return c.json({ error: 'Cleanup endpoint not available in production' }, 403)\n  }\n\n  try {\n    // Delete test content\n    const result = await db.prepare(`\n      DELETE FROM content\n      WHERE title LIKE 'Test %'\n      OR title LIKE '%E2E%'\n      OR title LIKE '%Playwright%'\n      OR title LIKE '%Sample%'\n    `).run()\n\n    // Clean up orphaned content_data\n    await db.prepare(`\n      DELETE FROM content_data\n      WHERE content_id NOT IN (SELECT id FROM content)\n    `).run()\n\n    return c.json({\n      success: true,\n      deletedCount: result.meta?.changes || 0,\n      message: 'Test content cleaned up successfully'\n    })\n  } catch (error) {\n    console.error('Content cleanup error:', error)\n    return c.json({\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error'\n    }, 500)\n  }\n})\n\nexport default app\n","import { renderAdminLayoutCatalyst, AdminLayoutCatalystData } from '../layouts/admin-layout-catalyst.template'\nimport { renderAlert } from '../alert.template'\nimport { renderConfirmationDialog, getConfirmationDialogScript } from '../confirmation-dialog.template'\nimport type { ContentType, ContentTypeField } from '../../content-types'\n\nexport interface ContentFormData {\n  id?: string\n  title?: string\n  slug?: string\n  data?: any\n  status?: string\n  contentType: ContentType\n  isEdit?: boolean\n  error?: string\n  success?: string\n  validationErrors?: Record<string, string[]>\n  referrerParams?: string\n  user?: {\n    name: string\n    email: string\n    role: string\n  }\n  version?: string\n}\n\n/** Render a single field based on its ContentTypeField definition */\nfunction renderField(field: ContentTypeField, value: any, errors?: string[]): string {\n  const errorHTML = errors && errors.length > 0\n    ? `<p class=\"mt-1 text-sm text-red-600 dark:text-red-400\">${errors.join(', ')}</p>`\n    : ''\n  const requiredMark = field.required ? '<span class=\"text-red-500\">*</span>' : ''\n  const helpHTML = field.helpText\n    ? `<p class=\"mt-1 text-xs text-zinc-500 dark:text-zinc-400\">${field.helpText}</p>`\n    : ''\n\n  const inputClasses = 'w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow'\n\n  switch (field.type) {\n    case 'text':\n      return `\n        <div>\n          <label for=\"field-${field.name}\" class=\"block text-sm/6 font-medium text-zinc-950 dark:text-white\">${field.label} ${requiredMark}</label>\n          <div class=\"mt-2\">\n            <input type=\"text\" id=\"field-${field.name}\" name=\"${field.name}\" value=\"${escapeAttr(String(value || ''))}\"\n              placeholder=\"${escapeAttr(field.placeholder || '')}\"\n              ${field.required ? 'required' : ''}\n              class=\"${inputClasses}\"\n            />\n          </div>\n          ${helpHTML}\n          ${errorHTML}\n        </div>\n      `\n\n    case 'textarea':\n      return `\n        <div>\n          <label for=\"field-${field.name}\" class=\"block text-sm/6 font-medium text-zinc-950 dark:text-white\">${field.label} ${requiredMark}</label>\n          <div class=\"mt-2\">\n            <textarea id=\"field-${field.name}\" name=\"${field.name}\" rows=\"8\"\n              placeholder=\"${escapeAttr(field.placeholder || '')}\"\n              ${field.required ? 'required' : ''}\n              class=\"${inputClasses}\"\n            >${escapeHtml(String(value || ''))}</textarea>\n          </div>\n          ${helpHTML}\n          ${errorHTML}\n        </div>\n      `\n\n    case 'richtext':\n      return `\n        <div>\n          <label for=\"field-${field.name}\" class=\"block text-sm/6 font-medium text-zinc-950 dark:text-white\">${field.label} ${requiredMark}</label>\n          <div class=\"mt-2\">\n            <div id=\"quill-editor-${field.name}\" class=\"quill-editor bg-white dark:bg-zinc-800 rounded-lg ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10\" style=\"min-height: 300px;\"></div>\n            <input type=\"hidden\" id=\"field-${field.name}\" name=\"${field.name}\" value=\"${escapeAttr(String(value || ''))}\">\n          </div>\n          ${helpHTML}\n          ${errorHTML}\n        </div>\n      `\n\n    case 'file':\n      return `\n        <div>\n          <label class=\"block text-sm/6 font-medium text-zinc-950 dark:text-white\">${field.label} ${requiredMark}</label>\n          <input type=\"hidden\" id=\"field-${field.name}\" name=\"${field.name}\" value=\"${escapeAttr(String(value || ''))}\">\n          <div class=\"mt-2\">\n            <!-- Preview area -->\n            <div id=\"file-preview-${field.name}\" class=\"${value ? '' : 'hidden'} mb-3\">\n              ${value ? renderFilePreview(String(value), field.accept) : ''}\n            </div>\n            <!-- Drop zone -->\n            <div id=\"dropzone-${field.name}\"\n              class=\"relative rounded-lg border-2 border-dashed border-zinc-300 dark:border-zinc-600 p-6 text-center hover:border-zinc-400 dark:hover:border-zinc-500 transition-colors cursor-pointer\"\n              ondragover=\"event.preventDefault(); this.classList.add('border-cyan-500', 'bg-cyan-50/50', 'dark:bg-cyan-500/5')\"\n              ondragleave=\"this.classList.remove('border-cyan-500', 'bg-cyan-50/50', 'dark:bg-cyan-500/5')\"\n              ondrop=\"handleFileDrop(event, '${field.name}', '${escapeAttr(field.accept || '')}')\"\n              onclick=\"document.getElementById('file-input-${field.name}').click()\"\n            >\n              <svg class=\"mx-auto h-10 w-10 text-zinc-400 dark:text-zinc-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12\"/>\n              </svg>\n              <p class=\"mt-2 text-sm text-zinc-600 dark:text-zinc-400\">\n                <span class=\"font-semibold text-cyan-600 dark:text-cyan-400\">Click to upload</span> or drag and drop\n              </p>\n              <p class=\"mt-1 text-xs text-zinc-500 dark:text-zinc-400\">${field.helpText || 'Any file'}</p>\n              <div id=\"upload-progress-${field.name}\" class=\"hidden mt-3\">\n                <div class=\"w-full bg-zinc-200 dark:bg-zinc-700 rounded-full h-2\">\n                  <div id=\"upload-bar-${field.name}\" class=\"bg-cyan-500 h-2 rounded-full transition-all\" style=\"width: 0%\"></div>\n                </div>\n                <p id=\"upload-status-${field.name}\" class=\"mt-1 text-xs text-zinc-500 dark:text-zinc-400\">Uploading...</p>\n              </div>\n            </div>\n            <input type=\"file\" id=\"file-input-${field.name}\" class=\"hidden\"\n              ${field.accept ? `accept=\"${escapeAttr(field.accept)}\"` : ''}\n              onchange=\"handleFileSelect(this, '${field.name}', '${escapeAttr(field.accept || '')}')\"\n            />\n            ${value ? `\n              <button type=\"button\" onclick=\"clearFileField('${field.name}')\"\n                class=\"mt-2 inline-flex items-center gap-1.5 text-sm text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 transition-colors\">\n                <svg class=\"h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"/></svg>\n                Remove file\n              </button>\n            ` : ''}\n          </div>\n          ${errorHTML}\n        </div>\n      `\n\n    case 'tags':\n      const tagsValue = Array.isArray(value) ? value.join(', ') : String(value || '')\n      return `\n        <div>\n          <label for=\"field-${field.name}\" class=\"block text-sm/6 font-medium text-zinc-950 dark:text-white\">${field.label}</label>\n          <div class=\"mt-2\">\n            <input type=\"text\" id=\"field-${field.name}\" name=\"${field.name}\" value=\"${escapeAttr(tagsValue)}\"\n              placeholder=\"${escapeAttr(field.placeholder || 'Comma-separated tags')}\"\n              class=\"${inputClasses}\"\n            />\n          </div>\n          <p class=\"mt-1 text-xs text-zinc-500 dark:text-zinc-400\">Separate tags with commas</p>\n          ${errorHTML}\n        </div>\n      `\n\n    default:\n      return ''\n  }\n}\n\n/** Render file preview based on mime type */\nfunction renderFilePreview(url: string, accept?: string): string {\n  if (!url) return ''\n  const isImage = accept?.startsWith('image/') || /\\.(jpg|jpeg|png|gif|webp|svg)$/i.test(url)\n  if (isImage) {\n    return `<img src=\"${escapeAttr(url)}\" alt=\"Preview\" class=\"h-32 w-32 object-cover rounded-lg ring-1 ring-zinc-950/10 dark:ring-white/10\">`\n  }\n  return `\n    <div class=\"inline-flex items-center gap-2 rounded-lg bg-zinc-50 dark:bg-zinc-800 px-3 py-2 ring-1 ring-zinc-950/10 dark:ring-white/10\">\n      <svg class=\"h-5 w-5 text-zinc-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z\"/></svg>\n      <span class=\"text-sm text-zinc-700 dark:text-zinc-300 truncate max-w-xs\">${escapeHtml(url.split('/').pop() || url)}</span>\n    </div>\n  `\n}\n\nfunction escapeHtml(str: string): string {\n  return str\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n}\n\nfunction escapeAttr(str: string): string {\n  return str\n    .replace(/&/g, '&amp;')\n    .replace(/\"/g, '&quot;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n}\n\nexport function renderContentFormPage(data: ContentFormData): string {\n  const isEdit = data.isEdit || !!data.id\n  const ct = data.contentType\n  const title = isEdit ? `Edit: ${data.title || 'Content'}` : `New ${ct.displayName}`\n\n  const backUrl = data.referrerParams\n    ? `/admin/content?${data.referrerParams}`\n    : `/admin/content?type=${ct.name}`\n\n  const getFieldValue = (fieldName: string) => {\n    if (fieldName === 'title') return data.title || data.data?.[fieldName] || ''\n    if (fieldName === 'slug') return data.slug || data.data?.[fieldName] || ''\n    return data.data?.[fieldName] || ''\n  }\n\n  // Separate fields into groups: core (title), content fields, tag fields\n  const titleField = ct.fields.find(f => f.name === 'title')\n  const contentFields = ct.fields.filter(f => f.name !== 'title' && f.type !== 'tags')\n  const tagFields = ct.fields.filter(f => f.type === 'tags')\n\n  const hasRichtext = ct.fields.some(f => f.type === 'richtext')\n  const hasFileUpload = ct.fields.some(f => f.type === 'file')\n  const descriptionText = ct.description || `Manage ${ct.displayName.toLowerCase()} content`\n\n  const pageContent = `\n    <div class=\"space-y-6\">\n      <!-- Header -->\n      <div class=\"flex flex-col sm:flex-row sm:items-center sm:justify-between\">\n        <div>\n          <h1 class=\"text-2xl/8 font-semibold text-zinc-950 dark:text-white sm:text-xl/8\">${isEdit ? 'Edit Content' : 'New Content'}</h1>\n          <p class=\"mt-2 text-sm/6 text-zinc-500 dark:text-zinc-400\">\n            ${descriptionText}\n          </p>\n        </div>\n        <div class=\"mt-4 sm:mt-0 sm:ml-16 sm:flex-none\">\n          <a href=\"${backUrl}\" class=\"inline-flex items-center justify-center rounded-lg bg-white dark:bg-zinc-800 px-3.5 py-2.5 text-sm font-semibold text-zinc-950 dark:text-white ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 hover:bg-zinc-50 dark:hover:bg-zinc-700 transition-colors shadow-sm\">\n            <svg class=\"-ml-0.5 mr-1.5 h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10 19l-7-7m0 0l7-7m-7 7h18\"/>\n            </svg>\n            Back to Content\n          </a>\n        </div>\n      </div>\n\n      <!-- Form Container -->\n      <div class=\"rounded-lg bg-white dark:bg-zinc-900 shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10 overflow-hidden\">\n        <!-- Form Header -->\n        <div class=\"border-b border-zinc-950/5 dark:border-white/10 px-6 py-6\">\n          <div class=\"flex items-center gap-x-3\">\n            <div class=\"flex h-12 w-12 items-center justify-center rounded-lg bg-cyan-50 dark:bg-cyan-500/10 text-cyan-600 dark:text-cyan-400\">\n              ${ct.icon}\n            </div>\n            <div>\n              <h2 class=\"text-base/7 font-semibold text-zinc-950 dark:text-white\">${ct.displayName}</h2>\n              <p class=\"text-sm/6 text-zinc-500 dark:text-zinc-400\">${isEdit ? 'Update your content' : 'Create new content'}</p>\n            </div>\n          </div>\n        </div>\n\n        <!-- Form Content -->\n        <div class=\"px-6 py-6\">\n          <div id=\"form-messages\">\n            ${data.error ? renderAlert({ type: 'error', message: data.error, dismissible: true }) : ''}\n            ${data.success ? renderAlert({ type: 'success', message: data.success, dismissible: true }) : ''}\n          </div>\n\n          <div class=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        <!-- Main Content Form -->\n        <div class=\"lg:col-span-2\">\n          <form\n            id=\"content-form\"\n            ${isEdit ? `hx-put=\"/admin/content/${data.id}\"` : `hx-post=\"/admin/content\"`}\n            hx-target=\"#form-messages\"\n            hx-encoding=\"multipart/form-data\"\n            class=\"space-y-6\"\n          >\n            <input type=\"hidden\" name=\"content_type\" value=\"${ct.name}\">\n            ${isEdit ? `<input type=\"hidden\" name=\"id\" value=\"${data.id}\">` : ''}\n            ${data.referrerParams ? `<input type=\"hidden\" name=\"referrer_params\" value=\"${escapeAttr(data.referrerParams)}\">` : ''}\n\n            <!-- Title Field -->\n            ${titleField ? `\n              <div class=\"rounded-lg bg-zinc-50 dark:bg-zinc-800/50 p-4 ring-1 ring-zinc-950/5 dark:ring-white/10\">\n                <h3 class=\"text-sm font-semibold text-zinc-950 dark:text-white mb-3\">Basic Information</h3>\n                ${renderField(titleField, getFieldValue('title'), data.validationErrors?.['title'])}\n              </div>\n            ` : ''}\n\n            <!-- Content Fields -->\n            ${contentFields.length > 0 ? `\n              <div class=\"rounded-lg bg-zinc-50 dark:bg-zinc-800/50 p-4 ring-1 ring-zinc-950/5 dark:ring-white/10\">\n                <h3 class=\"text-sm font-semibold text-zinc-950 dark:text-white mb-3\">Content Details</h3>\n                <div class=\"space-y-4\">\n                  ${contentFields.map(f => renderField(f, getFieldValue(f.name), data.validationErrors?.[f.name])).join('')}\n                </div>\n              </div>\n            ` : ''}\n\n            <!-- Tags -->\n            ${tagFields.length > 0 ? `\n              <div class=\"rounded-lg bg-zinc-50 dark:bg-zinc-800/50 p-4 ring-1 ring-zinc-950/5 dark:ring-white/10\">\n                <h3 class=\"text-sm font-semibold text-zinc-950 dark:text-white mb-3\">Organization</h3>\n                <div class=\"space-y-4\">\n                  ${tagFields.map(f => renderField(f, getFieldValue(f.name), data.validationErrors?.[f.name])).join('')}\n                </div>\n              </div>\n            ` : ''}\n\n            <div id=\"form-messages\"></div>\n          </form>\n        </div>\n\n        <!-- Sidebar -->\n        <div class=\"lg:col-span-1 space-y-6\">\n          <!-- Publishing Options -->\n          <div class=\"rounded-lg bg-zinc-50 dark:bg-zinc-800/50 shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10 p-6\">\n            <h3 class=\"text-base/7 font-semibold text-zinc-950 dark:text-white mb-4\">Publishing</h3>\n            <div class=\"mb-6\">\n              <label for=\"status\" class=\"block text-sm/6 font-medium text-zinc-950 dark:text-white\">Status</label>\n              <div class=\"mt-2 grid grid-cols-1\">\n                <select\n                  id=\"status\"\n                  name=\"status\"\n                  form=\"content-form\"\n                  class=\"col-start-1 row-start-1 w-full appearance-none rounded-md bg-white/5 dark:bg-white/5 py-1.5 pl-3 pr-8 text-base text-zinc-950 dark:text-white outline outline-1 -outline-offset-1 outline-zinc-500/30 dark:outline-zinc-400/30 *:bg-white dark:*:bg-zinc-800 focus-visible:outline focus-visible:outline-2 focus-visible:-outline-offset-2 focus-visible:outline-zinc-500 dark:focus-visible:outline-zinc-400 sm:text-sm/6\"\n                >\n                  <option value=\"draft\" ${data.status === 'draft' ? 'selected' : ''}>Draft</option>\n                  <option value=\"published\" ${data.status === 'published' ? 'selected' : ''}>Published</option>\n                </select>\n                <svg viewBox=\"0 0 16 16\" fill=\"currentColor\" aria-hidden=\"true\" class=\"pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-zinc-600 dark:text-zinc-400 sm:size-4\">\n                  <path d=\"M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z\" clip-rule=\"evenodd\" fill-rule=\"evenodd\" />\n                </svg>\n              </div>\n            </div>\n          </div>\n\n          <!-- Content Info -->\n          ${isEdit ? `\n            <div class=\"rounded-lg bg-zinc-50 dark:bg-zinc-800/50 shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10 p-6\">\n              <h3 class=\"text-base/7 font-semibold text-zinc-950 dark:text-white mb-4\">Content Info</h3>\n              <dl class=\"space-y-3 text-sm\">\n                <div>\n                  <dt class=\"text-zinc-500 dark:text-zinc-400\">Type</dt>\n                  <dd class=\"mt-1 text-zinc-950 dark:text-white\">${ct.displayName}</dd>\n                </div>\n                <div>\n                  <dt class=\"text-zinc-500 dark:text-zinc-400\">Created</dt>\n                  <dd class=\"mt-1 text-zinc-950 dark:text-white\">${data.data?.created_at ? new Date(data.data.created_at).toLocaleDateString() : 'Unknown'}</dd>\n                </div>\n                <div>\n                  <dt class=\"text-zinc-500 dark:text-zinc-400\">Last Modified</dt>\n                  <dd class=\"mt-1 text-zinc-950 dark:text-white\">${data.data?.updated_at ? new Date(data.data.updated_at).toLocaleDateString() : 'Unknown'}</dd>\n                </div>\n              </dl>\n              <div class=\"mt-4 pt-4 border-t border-zinc-950/5 dark:border-white/10\">\n                <button\n                  type=\"button\"\n                  onclick=\"showVersionHistory('${data.id}')\"\n                  class=\"inline-flex items-center gap-x-1.5 text-sm font-medium text-zinc-950 dark:text-white hover:text-zinc-600 dark:hover:text-zinc-300 transition-colors\"\n                >\n                  <svg class=\"h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\">\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z\"/>\n                  </svg>\n                  View Version History\n                </button>\n              </div>\n            </div>\n          ` : ''}\n\n          <!-- Quick Actions -->\n          <div class=\"rounded-lg bg-zinc-50 dark:bg-zinc-800/50 shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10 p-6\">\n            <h3 class=\"text-base/7 font-semibold text-zinc-950 dark:text-white mb-4\">Quick Actions</h3>\n            <div class=\"space-y-2\">\n              <button\n                type=\"button\"\n                onclick=\"duplicateContent()\"\n                class=\"w-full inline-flex items-center gap-x-2 px-3 py-2 text-sm font-medium text-zinc-950 dark:text-white hover:bg-zinc-100 dark:hover:bg-zinc-700 rounded-lg transition-colors\"\n              >\n                <svg class=\"h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\">\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\"></path>\n                </svg>\n                Duplicate Content\n              </button>\n              ${isEdit ? `\n                <button\n                  type=\"button\"\n                  onclick=\"deleteContent('${data.id}')\"\n                  class=\"w-full inline-flex items-center gap-x-2 px-3 py-2 text-sm font-medium text-pink-700 dark:text-pink-300 hover:bg-pink-50 dark:hover:bg-pink-900/20 rounded-lg transition-colors\"\n                >\n                  <svg class=\"h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\">\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0\"/>\n                  </svg>\n                  Delete Content\n                </button>\n              ` : ''}\n            </div>\n          </div>\n        </div>\n\n        <!-- Action Buttons -->\n        <div class=\"lg:col-span-3 mt-6 pt-6 border-t border-zinc-950/5 dark:border-white/10 flex items-center justify-between\">\n          <a href=\"${backUrl}\" class=\"inline-flex items-center justify-center gap-x-1.5 rounded-lg bg-white dark:bg-zinc-800 px-3.5 py-2.5 text-sm font-semibold text-zinc-950 dark:text-white ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 hover:bg-zinc-50 dark:hover:bg-zinc-700 transition-colors shadow-sm\">\n            <svg class=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M6 18L18 6M6 6l12 12\"/>\n            </svg>\n            Cancel\n          </a>\n          <div class=\"flex items-center gap-x-3\">\n            <button\n              type=\"submit\"\n              form=\"content-form\"\n              name=\"action\"\n              value=\"save\"\n              class=\"inline-flex items-center justify-center gap-x-1.5 rounded-lg bg-zinc-950 dark:bg-white px-3.5 py-2.5 text-sm font-semibold text-white dark:text-zinc-950 hover:bg-zinc-800 dark:hover:bg-zinc-100 transition-colors shadow-sm\"\n            >\n              <svg class=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M5 13l4 4L19 7\"/>\n              </svg>\n              ${isEdit ? 'Update' : 'Save'}\n            </button>\n            ${data.user?.role !== 'viewer' ? `\n              <button\n                type=\"submit\"\n                form=\"content-form\"\n                name=\"action\"\n                value=\"save_and_publish\"\n                class=\"inline-flex items-center justify-center gap-x-1.5 rounded-lg bg-lime-600 dark:bg-lime-500 px-3.5 py-2.5 text-sm font-semibold text-white hover:bg-lime-700 dark:hover:bg-lime-600 transition-colors shadow-sm\"\n              >\n                <svg class=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\">\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"/>\n                </svg>\n                ${isEdit ? 'Update' : 'Save'} & Publish\n              </button>\n            ` : ''}\n          </div>\n        </div>\n      </div>\n      </div>\n    </div>\n\n    <!-- Confirmation Dialogs -->\n    ${renderConfirmationDialog({\n      id: 'duplicate-content-confirm',\n      title: 'Duplicate Content',\n      message: 'Create a copy of this content?',\n      confirmText: 'Duplicate',\n      cancelText: 'Cancel',\n      iconColor: 'blue',\n      confirmClass: 'bg-blue-500 hover:bg-blue-400',\n      onConfirm: 'performDuplicateContent()'\n    })}\n\n    ${renderConfirmationDialog({\n      id: 'delete-content-confirm',\n      title: 'Delete Content',\n      message: 'Are you sure you want to delete this content? This action cannot be undone.',\n      confirmText: 'Delete',\n      cancelText: 'Cancel',\n      iconColor: 'red',\n      confirmClass: 'bg-red-500 hover:bg-red-400',\n      onConfirm: `performDeleteContent('\\${data.id}')`\n    })}\n\n    ${getConfirmationDialogScript()}\n\n    ${hasRichtext ? getQuillCDNAndInit(ct.fields.filter(f => f.type === 'richtext')) : ''}\n\n    <script>\n      ${hasFileUpload ? getFileUploadScript() : ''}\n\n      // Quick actions\n      function duplicateContent() {\n        showConfirmDialog('duplicate-content-confirm');\n      }\n\n      function performDuplicateContent() {\n        var form = document.getElementById('content-form');\n        var formData = new FormData(form);\n        formData.append('action', 'duplicate');\n\n        fetch('/admin/content/duplicate', {\n          method: 'POST',\n          body: formData\n        })\n        .then(function(response) { return response.json(); })\n        .then(function(data) {\n          if (data.success) {\n            window.location.href = '/admin/content/' + data.id + '/edit';\n          } else {\n            alert('Error duplicating content');\n          }\n        });\n      }\n\n      function deleteContent(contentId) {\n        showConfirmDialog('delete-content-confirm');\n      }\n\n      function performDeleteContent(contentId) {\n        fetch('/admin/content/' + contentId, {\n          method: 'DELETE'\n        })\n        .then(function(response) {\n          if (response.ok) {\n            window.location.href = '/admin/content';\n          } else {\n            alert('Error deleting content');\n          }\n        });\n      }\n\n      function showVersionHistory(contentId) {\n        var modal = document.createElement('div');\n        modal.className = 'fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50';\n        modal.innerHTML = '<div id=\"version-history-content\"><div class=\"flex items-center justify-center h-32\"><div class=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 dark:border-blue-400\"></div></div></div>';\n        document.body.appendChild(modal);\n\n        fetch('/admin/content/' + contentId + '/versions')\n        .then(function(response) { return response.text(); })\n        .then(function(html) {\n          document.getElementById('version-history-content').innerHTML = html;\n        })\n        .catch(function(error) {\n          console.error('Error loading version history:', error);\n          document.getElementById('version-history-content').innerHTML = '<p class=\"text-zinc-950 dark:text-white\">Error loading version history</p>';\n        });\n      }\n\n      // Auto-save\n      let autoSaveTimeout;\n      function scheduleAutoSave() {\n        clearTimeout(autoSaveTimeout);\n        autoSaveTimeout = setTimeout(() => {\n          const form = document.getElementById('content-form');\n          const formData = new FormData(form);\n          formData.append('action', 'autosave');\n          fetch(form.action, { method: 'POST', body: formData })\n            .then(r => { if (r.ok) console.log('Auto-saved'); })\n            .catch(e => console.error('Auto-save failed:', e));\n        }, 30000);\n      }\n\n      document.addEventListener('DOMContentLoaded', function() {\n        const form = document.getElementById('content-form');\n        if (form) {\n          form.addEventListener('input', scheduleAutoSave);\n          form.addEventListener('change', scheduleAutoSave);\n        }\n      });\n    </script>\n  `\n\n  const layoutData: AdminLayoutCatalystData = {\n    title: title,\n    pageTitle: 'Content Management',\n    currentPath: '/admin/content',\n    user: data.user,\n    content: pageContent,\n    version: data.version\n  }\n\n  return renderAdminLayoutCatalyst(layoutData)\n}\n\n/** Quill editor CDN + init script for richtext fields */\nfunction getQuillCDNAndInit(richtextFields: ContentTypeField[]): string {\n  return `\n    <link href=\"https://cdn.quilljs.com/1.3.7/quill.snow.css\" rel=\"stylesheet\">\n    <script src=\"https://cdn.quilljs.com/1.3.7/quill.min.js\"></script>\n    <script>\n      document.addEventListener('DOMContentLoaded', function() {\n        ${richtextFields.map(f => `\n          (function() {\n            var quill = new Quill('#quill-editor-${f.name}', {\n              theme: 'snow',\n              modules: {\n                toolbar: [\n                  [{ 'header': [1, 2, 3, false] }],\n                  ['bold', 'italic', 'underline', 'strike'],\n                  [{ 'list': 'ordered'}, { 'list': 'bullet' }],\n                  ['blockquote', 'code-block'],\n                  ['link', 'image'],\n                  ['clean']\n                ]\n              },\n              placeholder: 'Write your content here...'\n            });\n            var hiddenInput = document.getElementById('field-${f.name}');\n            if (hiddenInput && hiddenInput.value) {\n              quill.root.innerHTML = hiddenInput.value;\n            }\n            quill.on('text-change', function() {\n              hiddenInput.value = quill.root.innerHTML;\n            });\n            var form = document.getElementById('content-form');\n            if (form) {\n              form.addEventListener('submit', function() {\n                hiddenInput.value = quill.root.innerHTML;\n              });\n            }\n          })();\n        `).join('')}\n      });\n    </script>\n  `\n}\n\n/** File upload handling script */\nfunction getFileUploadScript(): string {\n  return `\n    function handleFileDrop(event, fieldName, accept) {\n      event.preventDefault();\n      event.currentTarget.classList.remove('border-cyan-500', 'bg-cyan-50/50', 'dark:bg-cyan-500/5');\n      var files = event.dataTransfer.files;\n      if (files.length > 0) {\n        uploadFile(files[0], fieldName, accept);\n      }\n    }\n\n    function handleFileSelect(input, fieldName, accept) {\n      if (input.files.length > 0) {\n        uploadFile(input.files[0], fieldName, accept);\n      }\n    }\n\n    function uploadFile(file, fieldName, accept) {\n      // Validate file type if accept is specified\n      if (accept && accept !== '*') {\n        var acceptTypes = accept.split(',').map(function(t) { return t.trim(); });\n        var accepted = acceptTypes.some(function(type) {\n          if (type.endsWith('/*')) {\n            return file.type.startsWith(type.replace('/*', '/'));\n          }\n          return file.type === type;\n        });\n        if (!accepted) {\n          alert('Invalid file type. Accepted: ' + accept);\n          return;\n        }\n      }\n\n      var progressEl = document.getElementById('upload-progress-' + fieldName);\n      var barEl = document.getElementById('upload-bar-' + fieldName);\n      var statusEl = document.getElementById('upload-status-' + fieldName);\n      progressEl.classList.remove('hidden');\n      barEl.style.width = '10%';\n      statusEl.textContent = 'Uploading ' + file.name + '...';\n\n      var formData = new FormData();\n      formData.append('file', file);\n\n      var xhr = new XMLHttpRequest();\n      xhr.open('POST', '/api/media/upload');\n\n      xhr.upload.addEventListener('progress', function(e) {\n        if (e.lengthComputable) {\n          var pct = Math.round((e.loaded / e.total) * 100);\n          barEl.style.width = pct + '%';\n          statusEl.textContent = 'Uploading... ' + pct + '%';\n        }\n      });\n\n      xhr.addEventListener('load', function() {\n        if (xhr.status >= 200 && xhr.status < 300) {\n          try {\n            var result = JSON.parse(xhr.responseText);\n            var url = result.url || result.data?.url || '';\n            document.getElementById('field-' + fieldName).value = url;\n\n            // Show preview\n            var previewEl = document.getElementById('file-preview-' + fieldName);\n            if (url && previewEl) {\n              var isImage = file.type.startsWith('image/');\n              if (isImage) {\n                previewEl.innerHTML = '<img src=\"' + url + '\" alt=\"Preview\" class=\"h-32 w-32 object-cover rounded-lg ring-1 ring-zinc-950/10 dark:ring-white/10\">';\n              } else {\n                previewEl.innerHTML = '<div class=\"inline-flex items-center gap-2 rounded-lg bg-zinc-50 dark:bg-zinc-800 px-3 py-2 ring-1 ring-zinc-950/10 dark:ring-white/10\"><span class=\"text-sm text-zinc-700 dark:text-zinc-300\">' + file.name + '</span></div>';\n              }\n              previewEl.classList.remove('hidden');\n            }\n\n            barEl.style.width = '100%';\n            statusEl.textContent = 'Upload complete!';\n            setTimeout(function() { progressEl.classList.add('hidden'); }, 2000);\n          } catch(e) {\n            statusEl.textContent = 'Upload failed: could not parse response';\n          }\n        } else {\n          statusEl.textContent = 'Upload failed: ' + xhr.statusText;\n        }\n      });\n\n      xhr.addEventListener('error', function() {\n        statusEl.textContent = 'Upload failed: network error';\n      });\n\n      xhr.send(formData);\n    }\n\n    function clearFileField(fieldName) {\n      document.getElementById('field-' + fieldName).value = '';\n      var previewEl = document.getElementById('file-preview-' + fieldName);\n      if (previewEl) {\n        previewEl.innerHTML = '';\n        previewEl.classList.add('hidden');\n      }\n    }\n  `\n}\n","import { renderAdminLayoutCatalyst, AdminLayoutCatalystData } from '../layouts/admin-layout-catalyst.template'\nimport { renderPagination, PaginationData } from '../pagination.template'\nimport { renderTable, TableData, TableColumn } from '../table.template'\nimport type { FilterBarData } from '../filter-bar.template'\nimport { renderConfirmationDialog, getConfirmationDialogScript } from '../confirmation-dialog.template'\n\nexport interface ContentItem {\n  id: string\n  title: string\n  slug: string\n  modelName: string\n  statusBadge: string\n  authorName: string\n  formattedDate: string\n  availableActions: string[]\n}\n\nexport interface ContentListPageData {\n  modelName: string\n  status: string\n  page: number\n  search?: string\n  models: Array<{\n    name: string\n    displayName: string\n  }>\n  contentItems: ContentItem[]\n  totalItems: number\n  itemsPerPage: number\n  user?: {\n    name: string\n    email: string\n    role: string\n  }\n  version?: string\n}\n\nexport function renderContentListPage(data: ContentListPageData): string {\n  // Build current URL parameters to pass to edit page\n  const urlParams = new URLSearchParams()\n  if (data.modelName && data.modelName !== 'all') urlParams.set('type', data.modelName)\n  if (data.status && data.status !== 'all') urlParams.set('status', data.status)\n  if (data.search) urlParams.set('search', data.search)\n  if (data.page && data.page !== 1) urlParams.set('page', data.page.toString())\n  const currentParams = urlParams.toString()\n\n  // Check if filters are active (not in default state)\n  const hasActiveFilters = data.modelName !== 'all' || data.status !== 'all' || !!data.search\n\n  // Prepare filter bar data\n  const filterBarData: FilterBarData = {\n    filters: [\n      {\n        name: 'type',\n        label: 'Type',\n        options: [\n          { value: 'all', label: 'All Types', selected: data.modelName === 'all' },\n          ...data.models.map(model => ({\n            value: model.name,\n            label: model.displayName,\n            selected: data.modelName === model.name\n          }))\n        ]\n      },\n      {\n        name: 'status',\n        label: 'Status',\n        options: [\n          { value: 'all', label: 'All Status', selected: data.status === 'all' },\n          { value: 'draft', label: 'Draft', selected: data.status === 'draft' },\n          { value: 'review', label: 'Under Review', selected: data.status === 'review' },\n          { value: 'scheduled', label: 'Scheduled', selected: data.status === 'scheduled' },\n          { value: 'published', label: 'Published', selected: data.status === 'published' },\n          { value: 'archived', label: 'Archived', selected: data.status === 'archived' },\n          { value: 'deleted', label: 'Deleted', selected: data.status === 'deleted' }\n        ]\n      }\n    ],\n    actions: [\n      {\n        label: 'Advanced Search',\n        className: 'btn-primary',\n        onclick: 'openAdvancedSearch()'\n      },\n      {\n        label: 'Refresh',\n        className: 'btn-secondary',\n        onclick: 'location.reload()'\n      }\n    ],\n    bulkActions: [\n      { label: 'Publish', value: 'publish', icon: 'check-circle' },\n      { label: 'Unpublish', value: 'unpublish', icon: 'x-circle' },\n      { label: 'Delete', value: 'delete', icon: 'trash', className: 'text-pink-600' }\n    ]\n  }\n\n  // Prepare table data\n  const tableColumns: TableColumn[] = [\n    {\n      key: 'title',\n      label: 'Title',\n      sortable: true,\n      sortType: 'string',\n      render: (value, row) => `\n        <div class=\"flex items-center\">\n          <div>\n            <div class=\"text-sm font-medium text-zinc-950 dark:text-white\">\n              <a href=\"/admin/content/${row.id}/edit${currentParams ? `?ref=${encodeURIComponent(currentParams)}` : ''}\" class=\"hover:text-blue-600 dark:hover:text-blue-400 transition-colors\">${row.title}</a>\n            </div>\n            <div class=\"text-sm text-zinc-500 dark:text-zinc-400\">${row.slug}</div>\n          </div>\n        </div>\n      `\n    },\n    {\n      key: 'modelName',\n      label: 'Type',\n      sortable: true,\n      sortType: 'string',\n      className: 'text-sm text-zinc-500 dark:text-zinc-400'\n    },\n    {\n      key: 'statusBadge',\n      label: 'Status',\n      sortable: true,\n      sortType: 'string',\n      render: (value) => value\n    },\n    {\n      key: 'authorName',\n      label: 'Author',\n      sortable: true,\n      sortType: 'string',\n      className: 'text-sm text-zinc-500 dark:text-zinc-400'\n    },\n    {\n      key: 'formattedDate',\n      label: 'Updated',\n      sortable: true,\n      sortType: 'date',\n      className: 'text-sm text-zinc-500 dark:text-zinc-400'\n    },\n    {\n      key: 'actions',\n      label: 'Actions',\n      sortable: false,\n      className: 'text-sm font-medium',\n      render: (value, row) => `\n        <div class=\"flex space-x-2\">\n          <button\n            class=\"inline-flex items-center justify-center p-1.5 rounded-lg bg-cyan-50 dark:bg-cyan-500/10 text-cyan-700 dark:text-cyan-400 ring-1 ring-inset ring-cyan-600/20 dark:ring-cyan-500/20 hover:bg-cyan-100 dark:hover:bg-cyan-500/20 transition-colors\"\n            onclick=\"window.location.href='/admin/content/${row.id}/edit${currentParams ? `?ref=${encodeURIComponent(currentParams)}` : ''}'\"\n            title=\"Edit\"\n          >\n            <svg class=\"h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\"/>\n            </svg>\n          </button>\n          <button\n            class=\"inline-flex items-center justify-center p-1.5 rounded-lg bg-purple-50 dark:bg-purple-500/10 text-purple-700 dark:text-purple-400 ring-1 ring-inset ring-purple-600/20 dark:ring-purple-500/20 hover:bg-purple-100 dark:hover:bg-purple-500/20 transition-colors\"\n            onclick=\"window.open('/api/content/${row.id}', '_blank')\"\n            title=\"View API\"\n          >\n            <svg class=\"h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4\"/>\n            </svg>\n          </button>\n          <button\n            class=\"inline-flex items-center justify-center p-1.5 rounded-lg bg-red-50 dark:bg-red-500/10 text-red-700 dark:text-red-400 ring-1 ring-inset ring-red-600/20 dark:ring-red-500/20 hover:bg-red-100 dark:hover:bg-red-500/20 transition-colors\"\n            hx-delete=\"/admin/content/${row.id}\"\n            hx-confirm=\"Are you sure you want to delete this content item?\"\n            hx-target=\"#content-list\"\n            hx-swap=\"outerHTML\"\n            title=\"Delete\"\n          >\n            <svg class=\"h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"/>\n            </svg>\n          </button>\n        </div>\n      `\n    }\n  ]\n\n  const tableData: TableData<ContentItem> = {\n    tableId: 'content-table',\n    columns: tableColumns,\n    rows: data.contentItems,\n    selectable: true,\n    rowClickable: true,\n    rowClickUrl: (row: ContentItem) => `/admin/content/${row.id}/edit${currentParams ? `?ref=${encodeURIComponent(currentParams)}` : ''}`,\n    emptyMessage: 'No content found. Create your first content item to get started.'\n  }\n\n  // Prepare pagination data\n  const totalPages = Math.ceil(data.totalItems / data.itemsPerPage)\n  const startItem = (data.page - 1) * data.itemsPerPage + 1\n  const endItem = Math.min(data.page * data.itemsPerPage, data.totalItems)\n\n  const paginationData: PaginationData = {\n    currentPage: data.page,\n    totalPages,\n    totalItems: data.totalItems,\n    itemsPerPage: data.itemsPerPage,\n    startItem,\n    endItem,\n    baseUrl: '/admin/content',\n    queryParams: {\n      type: data.modelName,\n      status: data.status,\n      ...(data.search ? { search: data.search } : {})\n    },\n    showPageSizeSelector: true,\n    pageSizeOptions: [10, 20, 50, 100]\n  }\n\n  // Generate page content\n  const pageContent = `\n    <div>\n      <!-- Header -->\n      <div class=\"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6\">\n        <div>\n          <h1 class=\"text-2xl/8 font-semibold text-zinc-950 dark:text-white sm:text-xl/8\">Content Management</h1>\n          <p class=\"mt-2 text-sm/6 text-zinc-500 dark:text-zinc-400\">Manage and organize your content items</p>\n        </div>\n        <div class=\"mt-4 sm:mt-0 sm:ml-16 sm:flex-none\">\n          <a href=\"/admin/content/new\" class=\"inline-flex items-center justify-center rounded-lg bg-zinc-950 dark:bg-white px-3.5 py-2.5 text-sm font-semibold text-white dark:text-zinc-950 hover:bg-zinc-800 dark:hover:bg-zinc-100 transition-colors shadow-sm\">\n            <svg class=\"-ml-0.5 mr-1.5 h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n              <path d=\"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z\" />\n            </svg>\n            New Content\n          </a>\n        </div>\n      </div>\n      <!-- Filters -->\n      <div class=\"relative rounded-xl mb-6\">\n        <!-- Gradient Background -->\n        <div class=\"absolute inset-0 bg-gradient-to-r from-cyan-500/10 via-blue-500/10 to-purple-500/10 dark:from-cyan-400/20 dark:via-blue-400/20 dark:to-purple-400/20 rounded-xl\"></div>\n\n        <div class=\"relative bg-white/80 dark:bg-zinc-900/80 backdrop-blur-xl shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10 rounded-xl\">\n          <div class=\"px-6 py-5\">\n            <div class=\"flex items-center justify-between\">\n              <div class=\"flex items-center space-x-4 flex-1\">\n                <!-- Type Filter -->\n                <div>\n                  <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Type</label>\n                  <div class=\"grid grid-cols-1\">\n                    <select\n                      name=\"type\"\n                      onchange=\"updateContentFilters('type', this.value)\"\n                      class=\"col-start-1 row-start-1 w-full appearance-none rounded-lg bg-white/5 dark:bg-white/5 py-2 pl-3 pr-8 text-sm text-zinc-950 dark:text-white outline outline-1 -outline-offset-1 outline-cyan-500/30 dark:outline-cyan-400/30 *:bg-white dark:*:bg-zinc-800 focus-visible:outline focus-visible:outline-2 focus-visible:-outline-offset-2 focus-visible:outline-cyan-500 dark:focus-visible:outline-cyan-400 min-w-40\"\n                    >\n                      <option value=\"all\" ${data.modelName === 'all' ? 'selected' : ''}>All Types</option>\n                      ${data.models.map(model => `\n                        <option value=\"${model.name}\" ${data.modelName === model.name ? 'selected' : ''}>\n                          ${model.displayName}\n                        </option>\n                      `).join('')}\n                    </select>\n                    <svg viewBox=\"0 0 16 16\" fill=\"currentColor\" data-slot=\"icon\" aria-hidden=\"true\" class=\"pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-cyan-600 dark:text-cyan-400 sm:size-4\">\n                      <path d=\"M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z\" clip-rule=\"evenodd\" fill-rule=\"evenodd\" />\n                    </svg>\n                  </div>\n                </div>\n\n                <!-- Status Filter -->\n                <div>\n                  <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Status</label>\n                  <div class=\"grid grid-cols-1\">\n                    <select\n                      name=\"status\"\n                      onchange=\"updateContentFilters('status', this.value)\"\n                      class=\"col-start-1 row-start-1 w-full appearance-none rounded-lg bg-white/5 dark:bg-white/5 py-2 pl-3 pr-8 text-sm text-zinc-950 dark:text-white outline outline-1 -outline-offset-1 outline-cyan-500/30 dark:outline-cyan-400/30 *:bg-white dark:*:bg-zinc-800 focus-visible:outline focus-visible:outline-2 focus-visible:-outline-offset-2 focus-visible:outline-cyan-500 dark:focus-visible:outline-cyan-400 min-w-40\"\n                    >\n                      <option value=\"all\" ${data.status === 'all' ? 'selected' : ''}>All Status</option>\n                      <option value=\"draft\" ${data.status === 'draft' ? 'selected' : ''}>Draft</option>\n                      <option value=\"review\" ${data.status === 'review' ? 'selected' : ''}>Under Review</option>\n                      <option value=\"scheduled\" ${data.status === 'scheduled' ? 'selected' : ''}>Scheduled</option>\n                      <option value=\"published\" ${data.status === 'published' ? 'selected' : ''}>Published</option>\n                      <option value=\"archived\" ${data.status === 'archived' ? 'selected' : ''}>Archived</option>\n                      <option value=\"deleted\" ${data.status === 'deleted' ? 'selected' : ''}>Deleted</option>\n                    </select>\n                    <svg viewBox=\"0 0 16 16\" fill=\"currentColor\" data-slot=\"icon\" aria-hidden=\"true\" class=\"pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-cyan-600 dark:text-cyan-400 sm:size-4\">\n                      <path d=\"M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z\" clip-rule=\"evenodd\" fill-rule=\"evenodd\" />\n                    </svg>\n                  </div>\n                </div>\n\n                <!-- Search Input -->\n                <div class=\"flex-1 max-w-md\">\n                  <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Search</label>\n                  <form onsubmit=\"performContentSearch(event)\" class=\"flex items-center space-x-2\">\n                    <div class=\"relative group flex-1\">\n                      <input\n                        type=\"text\"\n                        name=\"search\"\n                        id=\"content-search-input\"\n                        value=\"${data.search || ''}\"\n                        oninput=\"toggleContentClearButton()\"\n                        placeholder=\"Search content...\"\n                        class=\"w-full rounded-full bg-white/90 dark:bg-zinc-800/90 backdrop-blur-sm px-4 py-2.5 pl-11 pr-10 text-sm text-zinc-950 dark:text-white border-2 border-cyan-200/50 dark:border-cyan-700/50 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:border-cyan-500 dark:focus:border-cyan-400 focus:bg-white dark:focus:bg-zinc-800 focus:shadow-lg focus:shadow-cyan-500/20 dark:focus:shadow-cyan-400/20 transition-all duration-300\"\n                      >\n                      <div class=\"absolute left-3.5 top-2.5 flex items-center justify-center w-5 h-5 rounded-full bg-gradient-to-br from-cyan-400 to-blue-500 dark:from-cyan-300 dark:to-blue-400 opacity-90 group-focus-within:opacity-100 transition-opacity\">\n                        <svg class=\"h-3 w-3 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" stroke-width=\"2.5\">\n                          <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"/>\n                        </svg>\n                      </div>\n                      <button\n                        type=\"button\"\n                        id=\"clear-content-search\"\n                        onclick=\"clearContentSearch()\"\n                        class=\"${data.search ? '' : 'hidden'} absolute right-3 top-3 flex items-center justify-center w-5 h-5 rounded-full bg-zinc-400/20 dark:bg-zinc-500/20 hover:bg-zinc-400/30 dark:hover:bg-zinc-500/30 transition-colors\"\n                      >\n                        <svg class=\"h-3 w-3 text-zinc-600 dark:text-zinc-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" stroke-width=\"2.5\">\n                          <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M6 18L18 6M6 6l12 12\"/>\n                        </svg>\n                      </button>\n                    </div>\n                    <button\n                      type=\"submit\"\n                      class=\"inline-flex items-center gap-x-1.5 px-4 py-2.5 bg-gradient-to-r from-cyan-500 to-blue-500 dark:from-cyan-400 dark:to-blue-400 text-white text-sm font-medium rounded-full hover:from-cyan-600 hover:to-blue-600 dark:hover:from-cyan-500 dark:hover:to-blue-500 shadow-md hover:shadow-lg transition-all duration-200\"\n                    >\n                      <svg class=\"h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" stroke-width=\"2.5\">\n                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"/>\n                      </svg>\n                      Search\n                    </button>\n                  </form>\n                  <script>\n                    function performContentSearch(event) {\n                      event.preventDefault();\n                      const searchInput = document.getElementById('content-search-input');\n                      const value = searchInput.value.trim();\n                      const params = new URLSearchParams(window.location.search);\n                      if (value) {\n                        params.set('search', value);\n                      } else {\n                        params.delete('search');\n                      }\n                      params.set('page', '1');\n                      window.location.href = window.location.pathname + '?' + params.toString();\n                    }\n\n                    function clearContentSearch() {\n                      const params = new URLSearchParams(window.location.search);\n                      params.delete('search');\n                      params.set('page', '1');\n                      window.location.href = window.location.pathname + (params.toString() ? '?' + params.toString() : '');\n                    }\n\n                    function toggleContentClearButton() {\n                      const searchInput = document.getElementById('content-search-input');\n                      const clearButton = document.getElementById('clear-content-search');\n                      if (searchInput.value.trim()) {\n                        clearButton.classList.remove('hidden');\n                      } else {\n                        clearButton.classList.add('hidden');\n                      }\n                    }\n\n                    function updateContentFilters(filterName, filterValue) {\n                      const params = new URLSearchParams(window.location.search);\n                      params.set(filterName, filterValue);\n                      params.set('page', '1');\n                      window.location.href = window.location.pathname + '?' + params.toString();\n                    }\n\n                    function clearAllFilters() {\n                      window.location.href = window.location.pathname;\n                    }\n                  </script>\n                </div>\n              </div>\n              <div class=\"flex items-center gap-x-3\">\n                <span class=\"text-sm/6 font-medium text-zinc-700 dark:text-zinc-300 px-3 py-1.5 rounded-full bg-white/60 dark:bg-zinc-800/60 backdrop-blur-sm\">${data.totalItems} ${data.totalItems === 1 ? 'item' : 'items'}</span>\n                ${filterBarData.actions?.map(action => `\n                  <button\n                    ${action.onclick ? `onclick=\"${action.onclick}\"` : ''}\n                    ${action.hxGet ? `hx-get=\"${action.hxGet}\"` : ''}\n                    ${action.hxTarget ? `hx-target=\"${action.hxTarget}\"` : ''}\n                    class=\"inline-flex items-center gap-x-1.5 px-3 py-1.5 bg-white/90 dark:bg-zinc-800/90 backdrop-blur-sm text-zinc-950 dark:text-white text-sm font-medium rounded-full ring-1 ring-inset ring-cyan-200/50 dark:ring-cyan-700/50 hover:bg-gradient-to-r hover:from-cyan-50 hover:to-blue-50 dark:hover:from-cyan-900/30 dark:hover:to-blue-900/30 hover:ring-cyan-300 dark:hover:ring-cyan-600 transition-all duration-200\"\n                  >\n                    ${action.label === 'Refresh' ? `\n                      <svg class=\"h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"/>\n                      </svg>\n                    ` : ''}\n                    ${action.label}\n                  </button>\n                `).join('') || ''}\n                ${filterBarData.bulkActions && filterBarData.bulkActions.length > 0 ? `\n                  <div class=\"relative inline-block\" id=\"bulk-actions-dropdown\">\n                    <button\n                      id=\"bulk-actions-btn\"\n                      onclick=\"toggleBulkActionsDropdown()\"\n                      class=\"inline-flex items-center gap-x-1.5 px-3 py-1.5 bg-zinc-100/60 dark:bg-zinc-800/60 backdrop-blur-sm text-zinc-400 dark:text-zinc-600 text-sm font-medium rounded-full ring-1 ring-inset ring-zinc-200/50 dark:ring-zinc-700/50 cursor-not-allowed\"\n                      disabled\n                    >\n                      Bulk Actions\n                      <svg viewBox=\"0 0 20 20\" fill=\"currentColor\" class=\"size-4\">\n                        <path d=\"M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z\" clip-rule=\"evenodd\" fill-rule=\"evenodd\" />\n                      </svg>\n                    </button>\n\n                    <div\n                      id=\"bulk-actions-menu\"\n                      class=\"hidden absolute right-0 mt-2 w-56 origin-top-right divide-y divide-zinc-200 dark:divide-white/10 rounded-lg bg-white dark:bg-zinc-900 shadow-xl ring-1 ring-zinc-950/5 dark:ring-white/10 z-50 transition-all duration-100 scale-95 opacity-0\"\n                      style=\"transition-behavior: allow-discrete;\"\n                    >\n                      <div class=\"py-1\">\n                        <button\n                          onclick=\"performBulkAction('publish')\"\n                          class=\"group/item flex w-full items-center px-4 py-2 text-sm text-zinc-700 dark:text-zinc-300 hover:bg-zinc-50 dark:hover:bg-white/5 hover:text-zinc-950 dark:hover:text-white transition-colors\"\n                        >\n                          <svg viewBox=\"0 0 20 20\" fill=\"currentColor\" class=\"mr-3 size-5 text-zinc-400 dark:text-zinc-500 group-hover/item:text-zinc-950 dark:group-hover/item:text-white\">\n                            <path fill-rule=\"evenodd\" d=\"M16.704 4.153a.75.75 0 0 1 .143 1.052l-8 10.5a.75.75 0 0 1-1.127.075l-4.5-4.5a.75.75 0 0 1 1.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 0 1 1.05-.143Z\" clip-rule=\"evenodd\" />\n                          </svg>\n                          Publish Selected\n                        </button>\n                        <button\n                          onclick=\"performBulkAction('draft')\"\n                          class=\"group/item flex w-full items-center px-4 py-2 text-sm text-zinc-700 dark:text-zinc-300 hover:bg-zinc-50 dark:hover:bg-white/5 hover:text-zinc-950 dark:hover:text-white transition-colors\"\n                        >\n                          <svg viewBox=\"0 0 20 20\" fill=\"currentColor\" class=\"mr-3 size-5 text-zinc-400 dark:text-zinc-500 group-hover/item:text-zinc-950 dark:group-hover/item:text-white\">\n                            <path d=\"m5.433 13.917 1.262-3.155A4 4 0 0 1 7.58 9.42l6.92-6.918a2.121 2.121 0 0 1 3 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 0 1-.65-.65Z\" />\n                            <path d=\"M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0 0 10 3H4.75A2.75 2.75 0 0 0 2 5.75v9.5A2.75 2.75 0 0 0 4.75 18h9.5A2.75 2.75 0 0 0 17 15.25V10a.75.75 0 0 0-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5Z\" />\n                          </svg>\n                          Move to Draft\n                        </button>\n                      </div>\n                      <div class=\"py-1\">\n                        <button\n                          onclick=\"performBulkAction('delete')\"\n                          class=\"group/item flex w-full items-center px-4 py-2 text-sm text-zinc-700 dark:text-zinc-300 hover:bg-red-50 dark:hover:bg-red-500/10 hover:text-red-600 dark:hover:text-red-400 transition-colors\"\n                        >\n                          <svg viewBox=\"0 0 20 20\" fill=\"currentColor\" class=\"mr-3 size-5 text-zinc-400 dark:text-zinc-500 group-hover/item:text-red-600 dark:group-hover/item:text-red-400\">\n                            <path fill-rule=\"evenodd\" d=\"M8.75 1A2.75 2.75 0 0 0 6 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 1 0 .23 1.482l.149-.022.841 10.518A2.75 2.75 0 0 0 7.596 19h4.807a2.75 2.75 0 0 0 2.742-2.53l.841-10.52.149.023a.75.75 0 0 0 .23-1.482A41.03 41.03 0 0 0 14 4.193V3.75A2.75 2.75 0 0 0 11.25 1h-2.5ZM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4ZM8.58 7.72a.75.75 0 0 0-1.5.06l.3 7.5a.75.75 0 1 0 1.5-.06l-.3-7.5Zm4.34.06a.75.75 0 1 0-1.5-.06l-.3 7.5a.75.75 0 1 0 1.5.06l.3-7.5Z\" clip-rule=\"evenodd\" fill-rule=\"evenodd\" />\n                          </svg>\n                          Delete Selected\n                        </button>\n                      </div>\n                    </div>\n                  </div>\n                ` : ''}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <!-- Content List -->\n      <div id=\"content-list\">\n        ${renderTable(tableData)}\n        ${renderPagination(paginationData)}\n      </div>\n      \n    </div>\n    \n    <!-- Modals -->\n    <div id=\"bulk-actions-modal\"></div>\n    <div id=\"versions-modal\"></div>\n    \n    <script>\n      // Update bulk actions button state\n      function updateBulkActionsButton() {\n        const checkboxes = document.querySelectorAll('input[type=\"checkbox\"].row-checkbox');\n        const checkedCount = Array.from(checkboxes).filter(cb => cb.checked).length;\n        const btn = document.getElementById('bulk-actions-btn');\n        const menu = document.getElementById('bulk-actions-menu');\n\n        if (!btn) return;\n\n        if (checkedCount > 0) {\n          btn.disabled = false;\n          btn.className = 'inline-flex items-center gap-x-1.5 px-3 py-1.5 bg-white/90 dark:bg-zinc-800/90 backdrop-blur-sm text-zinc-950 dark:text-white text-sm font-medium rounded-full ring-1 ring-inset ring-cyan-200/50 dark:ring-cyan-700/50 hover:bg-gradient-to-r hover:from-cyan-50 hover:to-blue-50 dark:hover:from-cyan-900/30 dark:hover:to-blue-900/30 hover:ring-cyan-300 dark:hover:ring-cyan-600 transition-all duration-200';\n        } else {\n          btn.disabled = true;\n          btn.className = 'inline-flex items-center gap-x-1.5 px-3 py-1.5 bg-zinc-100/60 dark:bg-zinc-800/60 backdrop-blur-sm text-zinc-400 dark:text-zinc-600 text-sm font-medium rounded-full ring-1 ring-inset ring-zinc-200/50 dark:ring-zinc-700/50 cursor-not-allowed';\n          // Hide menu when no items selected\n          if (menu) {\n            menu.classList.remove('scale-100', 'opacity-100');\n            menu.classList.add('scale-95', 'opacity-0', 'hidden');\n          }\n        }\n      }\n\n      // Select all functionality\n      document.addEventListener('change', function(e) {\n        if (e.target.id === 'select-all') {\n          const checkboxes = document.querySelectorAll('.row-checkbox');\n          checkboxes.forEach(cb => cb.checked = e.target.checked);\n          updateBulkActionsButton();\n        } else if (e.target.classList.contains('row-checkbox')) {\n          updateBulkActionsButton();\n        }\n      });\n\n      // Initialize button state on page load\n      document.addEventListener('DOMContentLoaded', function() {\n        updateBulkActionsButton();\n      });\n\n      // Toggle bulk actions dropdown\n      function toggleBulkActionsDropdown() {\n        const checkboxes = document.querySelectorAll('input[type=\"checkbox\"].row-checkbox');\n        const checkedCount = Array.from(checkboxes).filter(cb => cb.checked).length;\n\n        if (checkedCount === 0) return;\n\n        const menu = document.getElementById('bulk-actions-menu');\n        const isHidden = menu.classList.contains('hidden');\n\n        if (isHidden) {\n          menu.classList.remove('hidden');\n          setTimeout(() => {\n            menu.classList.remove('scale-95', 'opacity-0');\n            menu.classList.add('scale-100', 'opacity-100');\n          }, 10);\n        } else {\n          menu.classList.remove('scale-100', 'opacity-100');\n          menu.classList.add('scale-95', 'opacity-0');\n          setTimeout(() => {\n            menu.classList.add('hidden');\n          }, 100);\n        }\n      }\n\n      // Close dropdown when clicking outside\n      document.addEventListener('click', function(e) {\n        const dropdown = document.getElementById('bulk-actions-dropdown');\n        const menu = document.getElementById('bulk-actions-menu');\n        if (dropdown && menu && !dropdown.contains(e.target)) {\n          menu.classList.remove('scale-100', 'opacity-100');\n          menu.classList.add('scale-95', 'opacity-0');\n          setTimeout(() => {\n            menu.classList.add('hidden');\n          }, 100);\n        }\n      });\n\n      // Store current bulk action context\n      // Using var instead of let to avoid redeclaration errors when HTMX re-executes script tags\n      var currentBulkAction = null;\n      var currentSelectedIds = [];\n\n      // Perform bulk action\n      function performBulkAction(action) {\n        const selectedIds = Array.from(document.querySelectorAll('input[type=\"checkbox\"].row-checkbox:checked'))\n          .map(cb => cb.value)\n          .filter(id => id);\n\n        if (selectedIds.length === 0) {\n          alert('Please select at least one item');\n          return;\n        }\n\n        // Store context for confirmation\n        currentBulkAction = action;\n        currentSelectedIds = selectedIds;\n\n        // Update dialog content based on action\n        updateDialogContent(action, selectedIds.length);\n\n        // Show confirmation dialog\n        showConfirmDialog('bulk-action-confirm');\n      }\n\n      // Update dialog content dynamically\n      function updateDialogContent(action, count) {\n        const dialog = document.getElementById('bulk-action-confirm');\n        const titleEl = dialog.querySelector('h3');\n        const messageEl = dialog.querySelector('p');\n        const confirmBtn = dialog.querySelector('.confirm-button');\n\n        let title, message, btnText, btnClass;\n\n        switch(action) {\n          case 'delete':\n            title = 'Confirm Bulk Delete';\n            message = 'Are you sure you want to delete ' + count + ' selected item' + (count > 1 ? 's' : '') + '? This action cannot be undone.';\n            btnText = 'Delete';\n            btnClass = 'bg-red-500 hover:bg-red-400';\n            break;\n          case 'publish':\n            title = 'Confirm Bulk Publish';\n            message = 'Are you sure you want to publish ' + count + ' selected item' + (count > 1 ? 's' : '') + '? They will become publicly visible.';\n            btnText = 'Publish';\n            btnClass = 'bg-green-500 hover:bg-green-400';\n            break;\n          case 'draft':\n            title = 'Confirm Bulk Draft';\n            message = 'Are you sure you want to move ' + count + ' selected item' + (count > 1 ? 's' : '') + ' to draft status? They will be unpublished.';\n            btnText = 'Move to Draft';\n            btnClass = 'bg-blue-500 hover:bg-blue-400';\n            break;\n          default:\n            title = 'Confirm Bulk Action';\n            message = 'Are you sure you want to perform this action on ' + count + ' selected item' + (count > 1 ? 's' : '') + '?';\n            btnText = 'Confirm';\n            btnClass = 'bg-blue-500 hover:bg-blue-400';\n        }\n\n        titleEl.textContent = title;\n        messageEl.textContent = message;\n        confirmBtn.textContent = btnText;\n        confirmBtn.className = confirmBtn.className.replace(/bg-\\w+-\\d+\\s+hover:bg-\\w+-\\d+/, btnClass);\n      }\n\n      // Execute the bulk action after confirmation\n      function executeBulkAction() {\n        if (!currentBulkAction || currentSelectedIds.length === 0) return;\n\n        // Close dropdown\n        const menu = document.getElementById('bulk-actions-menu');\n        menu.classList.add('hidden');\n\n        fetch('/admin/content/bulk-action', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            action: currentBulkAction,\n            ids: currentSelectedIds\n          })\n        })\n        .then(res => res.json())\n        .then(data => {\n          if (data.success) {\n            location.reload();\n          } else {\n            alert('Error: ' + (data.error || 'Unknown error'));\n          }\n        })\n        .catch(err => {\n          console.error('Bulk action error:', err);\n          alert('Failed to perform bulk action');\n        })\n        .finally(() => {\n          // Clear context\n          currentBulkAction = null;\n          currentSelectedIds = [];\n        });\n      }\n\n      // Helper to get action text for display\n      function getActionText(action) {\n        const actionCount = currentSelectedIds.length;\n        switch(action) {\n          case 'publish':\n            return \\`publish \\${actionCount} item\\${actionCount > 1 ? 's' : ''}\\`;\n          case 'draft':\n            return \\`move \\${actionCount} item\\${actionCount > 1 ? 's' : ''} to draft\\`;\n          case 'delete':\n            return \\`delete \\${actionCount} item\\${actionCount > 1 ? 's' : ''}\\`;\n          default:\n            return \\`perform action on \\${actionCount} item\\${actionCount > 1 ? 's' : ''}\\`;\n        }\n      }\n\n    </script>\n\n    <!-- Confirmation Dialog for Bulk Actions -->\n    ${renderConfirmationDialog({\n      id: 'bulk-action-confirm',\n      title: 'Confirm Bulk Action',\n      message: 'Are you sure you want to perform this action? This operation will affect multiple items.',\n      confirmText: 'Confirm',\n      cancelText: 'Cancel',\n      confirmClass: 'bg-blue-500 hover:bg-blue-400',\n      iconColor: 'blue',\n      onConfirm: 'executeBulkAction()'\n    })}\n\n    <!-- Confirmation Dialog Script -->\n    ${getConfirmationDialogScript()}\n\n    <!-- Advanced Search Modal -->\n    <div id=\"advancedSearchModal\" class=\"hidden fixed inset-0 z-50 overflow-y-auto\" aria-labelledby=\"modal-title\" role=\"dialog\" aria-modal=\"true\">\n      <div class=\"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0\">\n        <!-- Background overlay -->\n        <div class=\"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity\" onclick=\"closeAdvancedSearch()\"></div>\n\n        <!-- Modal panel -->\n        <div class=\"inline-block align-bottom bg-white dark:bg-zinc-900 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full\">\n          <div class=\"bg-white dark:bg-zinc-900 px-4 pt-5 pb-4 sm:p-6\">\n            <!-- Header -->\n            <div class=\"flex items-center justify-between mb-4\">\n              <h3 class=\"text-lg font-semibold text-zinc-950 dark:text-white\" id=\"modal-title\">\n                 Advanced Search\n              </h3>\n              <button onclick=\"closeAdvancedSearch()\" class=\"text-zinc-400 hover:text-zinc-500 dark:hover:text-zinc-300\">\n                <svg class=\"h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\" />\n                </svg>\n              </button>\n            </div>\n\n            <!-- Search Form -->\n            <form id=\"advancedSearchForm\" class=\"space-y-4\">\n              <!-- Search Input -->\n              <div>\n                <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Search Query</label>\n                <div class=\"relative\">\n                  <input\n                    type=\"text\"\n                    id=\"searchQuery\"\n                    name=\"query\"\n                    placeholder=\"Enter your search query...\"\n                    class=\"w-full rounded-lg bg-white dark:bg-white/5 px-4 py-3 text-sm text-zinc-950 dark:text-white ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 focus:ring-2 focus:ring-indigo-500\"\n                    autocomplete=\"off\"\n                  />\n                  <div id=\"searchSuggestions\" class=\"hidden absolute z-10 w-full mt-1 bg-white dark:bg-zinc-800 rounded-lg shadow-lg border border-zinc-200 dark:border-zinc-700 max-h-60 overflow-y-auto\"></div>\n                </div>\n              </div>\n\n              <!-- Mode Toggle -->\n              <div>\n                <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Search Mode</label>\n                <div class=\"flex gap-4\">\n                  <label class=\"flex items-center\">\n                    <input type=\"radio\" name=\"mode\" value=\"ai\" checked class=\"mr-2\">\n                    <span class=\"text-sm text-zinc-950 dark:text-white\"> AI Search (Semantic)</span>\n                  </label>\n                  <label class=\"flex items-center\">\n                    <input type=\"radio\" name=\"mode\" value=\"keyword\" class=\"mr-2\">\n                    <span class=\"text-sm text-zinc-950 dark:text-white\"> Keyword Search</span>\n                  </label>\n                </div>\n              </div>\n\n              <!-- Filters -->\n              <div class=\"border-t border-zinc-200 dark:border-zinc-800 pt-4\">\n                <h4 class=\"text-sm font-semibold text-zinc-950 dark:text-white mb-3\">Filters</h4>\n                \n                <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <!-- Type Filter -->\n                  <div>\n                    <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Types</label>\n                    <select\n                      id=\"filterCollections\"\n                      name=\"collections\"\n                      multiple\n                      class=\"w-full rounded-lg bg-white dark:bg-white/5 px-3 py-2 text-sm text-zinc-950 dark:text-white ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10\"\n                      size=\"4\"\n                    >\n                      <option value=\"\">All Types</option>\n                      ${data.models.map(\n                        (model) => `\n                          <option value=\"${model.name}\">${model.displayName}</option>\n                        `\n                      ).join('')}\n                    </select>\n                    <p class=\"text-xs text-zinc-500 dark:text-zinc-400 mt-1\">Hold Ctrl/Cmd to select multiple</p>\n                  </div>\n\n                  <!-- Status Filter -->\n                  <div>\n                    <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Status</label>\n                    <select\n                      id=\"filterStatus\"\n                      name=\"status\"\n                      multiple\n                      class=\"w-full rounded-lg bg-white dark:bg-white/5 px-3 py-2 text-sm text-zinc-950 dark:text-white ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10\"\n                      size=\"4\"\n                    >\n                      <option value=\"published\">Published</option>\n                      <option value=\"draft\">Draft</option>\n                      <option value=\"review\">Under Review</option>\n                      <option value=\"scheduled\">Scheduled</option>\n                      <option value=\"archived\">Archived</option>\n                    </select>\n                  </div>\n                </div>\n              </div>\n\n              <!-- Actions -->\n              <div class=\"flex items-center justify-end gap-3 pt-4 border-t border-zinc-200 dark:border-zinc-800\">\n                <button\n                  type=\"button\"\n                  onclick=\"closeAdvancedSearch()\"\n                  class=\"inline-flex items-center justify-center rounded-lg bg-white dark:bg-zinc-800 px-4 py-2 text-sm font-semibold text-zinc-950 dark:text-white ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 hover:bg-zinc-50 dark:hover:bg-zinc-700\"\n                >\n                  Cancel\n                </button>\n                <button\n                  type=\"submit\"\n                  class=\"inline-flex items-center justify-center rounded-lg bg-indigo-600 text-white px-6 py-2.5 text-sm font-semibold hover:bg-indigo-500 shadow-sm\"\n                >\n                  Search\n                </button>\n              </div>\n            </form>\n          </div>\n\n          <!-- Results Area -->\n          <div id=\"searchResults\" class=\"hidden px-4 pb-4 sm:px-6\">\n            <div class=\"border-t border-zinc-200 dark:border-zinc-800 pt-4\">\n              <div id=\"searchResultsContent\" class=\"space-y-3\"></div>\n              <div id=\"searchResultsPagination\" class=\"mt-4 flex items-center justify-between\"></div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <script>\n      // Open modal\n      function openAdvancedSearch() {\n        document.getElementById('advancedSearchModal').classList.remove('hidden');\n        document.getElementById('searchQuery').focus();\n      }\n\n      // Close modal\n      function closeAdvancedSearch() {\n        document.getElementById('advancedSearchModal').classList.add('hidden');\n        document.getElementById('searchResults').classList.add('hidden');\n      }\n\n      // Autocomplete\n      // Using var instead of let to avoid redeclaration errors when HTMX re-executes script tags\n      var autocompleteTimeout;\n      var searchQueryInput = document.getElementById('searchQuery');\n      if (searchQueryInput) {\n        searchQueryInput.addEventListener('input', (e) => {\n          const query = e.target.value.trim();\n          const suggestionsDiv = document.getElementById('searchSuggestions');\n          \n          clearTimeout(autocompleteTimeout);\n          \n          if (query.length < 2) {\n            suggestionsDiv.classList.add('hidden');\n            return;\n          }\n\n          autocompleteTimeout = setTimeout(async () => {\n            try {\n              const res = await fetch(\\`/api/search/suggest?q=\\${encodeURIComponent(query)}\\`);\n              const { data } = await res.json();\n              \n              if (data && data.length > 0) {\n                suggestionsDiv.innerHTML = data.map(s => \\`\n                  <div class=\"px-4 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-700 cursor-pointer\" onclick=\"selectSuggestion('\\${s.replace(/'/g, \"\\\\'\")}')\">\\${s}</div>\n                \\`).join('');\n                suggestionsDiv.classList.remove('hidden');\n              } else {\n                suggestionsDiv.classList.add('hidden');\n              }\n            } catch (error) {\n              console.error('Autocomplete error:', error);\n            }\n          }, 300);\n        });\n      }\n\n      function selectSuggestion(suggestion) {\n        document.getElementById('searchQuery').value = suggestion;\n        document.getElementById('searchSuggestions').classList.add('hidden');\n      }\n\n      // Hide suggestions when clicking outside\n      document.addEventListener('click', (e) => {\n        const suggestionsDiv = document.getElementById('searchSuggestions');\n        if (!e.target.closest('#searchQuery') && !e.target.closest('#searchSuggestions')) {\n          suggestionsDiv.classList.add('hidden');\n        }\n      });\n\n      // Form submission\n      var advancedSearchForm = document.getElementById('advancedSearchForm');\n      if (advancedSearchForm) {\n        advancedSearchForm.addEventListener('submit', async (e) => {\n          e.preventDefault();\n          \n          const formData = new FormData(e.target);\n          const query = formData.get('query');\n          const mode = formData.get('mode') || 'ai';\n          \n          // Build filters\n          const filters = {};\n          \n          const collections = Array.from(formData.getAll('collections')).filter(c => c !== '');\n          if (collections.length > 0) {\n            // Need to convert collection names to IDs - for now, pass names\n            filters.collections = collections;\n          }\n          \n          const status = Array.from(formData.getAll('status'));\n          if (status.length > 0) {\n            filters.status = status;\n          }\n          \n          const dateStart = formData.get('date_start');\n          const dateEnd = formData.get('date_end');\n          if (dateStart || dateEnd) {\n            filters.dateRange = {\n              start: dateStart ? new Date(dateStart) : null,\n              end: dateEnd ? new Date(dateEnd) : null,\n              field: 'created_at'\n            };\n          }\n\n          // Execute search\n          try {\n            const res = await fetch('/api/search', {\n              method: 'POST',\n              headers: {'Content-Type': 'application/json'},\n              body: JSON.stringify({\n                query,\n                mode,\n                filters,\n                limit: 20\n              })\n            });\n\n            const { data } = await res.json();\n            \n            if (data && data.results) {\n              displaySearchResults(data);\n            }\n          } catch (error) {\n            console.error('Search error:', error);\n            alert('Search failed. Please try again.');\n          }\n        });\n      }\n\n      function displaySearchResults(searchData) {\n        const resultsDiv = document.getElementById('searchResultsContent');\n        const resultsSection = document.getElementById('searchResults');\n        \n        if (searchData.results.length === 0) {\n          resultsDiv.innerHTML = '<p class=\"text-sm text-zinc-500 dark:text-zinc-400\">No results found.</p>';\n        } else {\n          resultsDiv.innerHTML = searchData.results.map(result => \\`\n            <div class=\"p-4 rounded-lg border border-zinc-200 dark:border-zinc-800 hover:bg-zinc-50 dark:hover:bg-zinc-800\">\n              <div class=\"flex items-start justify-between\">\n                <div class=\"flex-1\">\n                  <h4 class=\"text-sm font-semibold text-zinc-950 dark:text-white mb-1\">\n                    <a href=\"/admin/content/\\${result.id}/edit\" class=\"hover:text-indigo-600 dark:hover:text-indigo-400\">\\${result.title || 'Untitled'}</a>\n                  </h4>\n                  <p class=\"text-xs text-zinc-500 dark:text-zinc-400 mb-2\">\n                    \\${result.collection_name}  \\${new Date(result.created_at).toLocaleDateString()}\n                    \\${result.relevance_score ? \\`  Relevance: \\${(result.relevance_score * 100).toFixed(0)}%\\` : ''}\n                  </p>\n                  \\${result.snippet ? \\`<p class=\"text-sm text-zinc-600 dark:text-zinc-400\">\\${result.snippet}</p>\\` : ''}\n                </div>\n                <div class=\"ml-4\">\n                  <span class=\"px-2 py-1 text-xs rounded-full \\${result.status === 'published' ? 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300' : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300'}\">\\${result.status}</span>\n                </div>\n              </div>\n            </div>\n          \\`).join('');\n        }\n        \n        resultsSection.classList.remove('hidden');\n        resultsSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });\n      }\n\n      // Make functions globally available\n      window.openAdvancedSearch = openAdvancedSearch;\n      window.closeAdvancedSearch = closeAdvancedSearch;\n    </script>\n  `\n\n  // Prepare layout data\n  const layoutData: AdminLayoutCatalystData = {\n    title: 'Content Management',\n    pageTitle: 'Content Management',\n    currentPath: '/admin/content',\n    user: data.user,\n    version: data.version,\n    content: pageContent\n  }\n\n  return renderAdminLayoutCatalyst(layoutData)\n}\n","export interface ContentVersion {\n  id: string\n  version: number\n  data: any\n  author_id: string\n  author_name?: string\n  created_at: number\n  is_current?: boolean\n}\n\nexport interface VersionHistoryData {\n  contentId: string\n  versions: ContentVersion[]\n  currentVersion: number\n}\n\nexport function renderVersionHistory(data: VersionHistoryData): string {\n  return `\n    <div class=\"version-history-modal\">\n      <div class=\"backdrop-blur-xl bg-white/10 rounded-xl border border-white/20 shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden\">\n        <!-- Header -->\n        <div class=\"relative px-6 py-4 border-b border-white/10\">\n          <div class=\"absolute inset-0 bg-gradient-to-r from-blue-600/10 via-purple-600/10 to-pink-600/10\"></div>\n          <div class=\"relative flex items-center justify-between\">\n            <h3 class=\"text-lg font-semibold text-white\">Version History</h3>\n            <button onclick=\"closeVersionHistory()\" class=\"text-gray-300 hover:text-white\">\n              <svg class=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\"></path>\n              </svg>\n            </button>\n          </div>\n        </div>\n        \n        <!-- Versions List -->\n        <div class=\"overflow-y-auto max-h-[calc(90vh-120px)]\">\n          <div class=\"p-6 space-y-4\">\n            ${data.versions.map((version, index) => `\n              <div class=\"version-item backdrop-blur-sm bg-white/5 rounded-xl border border-white/10 p-4 ${version.is_current ? 'ring-2 ring-blue-500/50' : ''}\">\n                <div class=\"flex items-center justify-between mb-3\">\n                  <div class=\"flex items-center space-x-3\">\n                    <span class=\"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${version.is_current ? 'bg-blue-500/20 text-blue-300' : 'bg-white/10 text-gray-300'}\">\n                      Version ${version.version}${version.is_current ? ' (Current)' : ''}\n                    </span>\n                    <span class=\"text-sm text-gray-300\">\n                      ${new Date(version.created_at).toLocaleString()}\n                    </span>\n                  </div>\n                  <div class=\"flex items-center space-x-2\">\n                    ${!version.is_current ? `\n                      <button \n                        onclick=\"restoreVersion('${data.contentId}', ${version.version})\"\n                        class=\"inline-flex items-center px-3 py-1 bg-green-600 text-white text-sm rounded-xl hover:bg-green-700 transition-all\"\n                      >\n                        <svg class=\"w-4 h-4 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6\"></path>\n                        </svg>\n                        Restore\n                      </button>\n                    ` : ''}\n                    <button \n                      onclick=\"previewVersion('${data.contentId}', ${version.version})\"\n                      class=\"inline-flex items-center px-3 py-1 bg-blue-600 text-white text-sm rounded-xl hover:bg-blue-700 transition-all\"\n                    >\n                      <svg class=\"w-4 h-4 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\"></path>\n                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\"></path>\n                      </svg>\n                      Preview\n                    </button>\n                  </div>\n                </div>\n                \n                <!-- Version Summary -->\n                <div class=\"version-summary text-sm\">\n                  <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <div>\n                      <span class=\"text-gray-400\">Title:</span>\n                      <span class=\"text-white ml-2\">${escapeHtml(version.data?.title || 'Untitled')}</span>\n                    </div>\n                    <div>\n                      <span class=\"text-gray-400\">Author:</span>\n                      <span class=\"text-white ml-2\">${escapeHtml(version.author_name || 'Unknown')}</span>\n                    </div>\n                    ${version.data?.excerpt ? `\n                      <div class=\"md:col-span-2\">\n                        <span class=\"text-gray-400\">Excerpt:</span>\n                        <p class=\"text-white mt-1 text-xs\">${escapeHtml(version.data.excerpt.substring(0, 200))}${version.data.excerpt.length > 200 ? '...' : ''}</p>\n                      </div>\n                    ` : ''}\n                  </div>\n                </div>\n                \n                <!-- Changes Summary (if not current) -->\n                ${!version.is_current && index < data.versions.length - 1 ? `\n                  <div class=\"mt-3 pt-3 border-t border-white/10\">\n                    <button \n                      onclick=\"toggleChanges('changes-${version.version}')\"\n                      class=\"text-sm text-blue-400 hover:text-blue-300 transition-colors\"\n                    >\n                      <svg class=\"w-4 h-4 inline mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M8 9l4-4 4 4m0 6l-4 4-4-4\"></path>\n                      </svg>\n                      View Changes\n                    </button>\n                    <div id=\"changes-${version.version}\" class=\"hidden mt-2 text-xs text-gray-300\">\n                      <em>Change detection coming soon...</em>\n                    </div>\n                  </div>\n                ` : ''}\n              </div>\n            `).join('')}\n          </div>\n        </div>\n        \n        <!-- Footer -->\n        <div class=\"px-6 py-4 border-t border-white/10 bg-white/5\">\n          <div class=\"flex justify-between items-center\">\n            <span class=\"text-sm text-gray-400\">\n              ${data.versions.length} version${data.versions.length !== 1 ? 's' : ''} total\n            </span>\n            <button \n              onclick=\"closeVersionHistory()\"\n              class=\"px-4 py-2 bg-white/10 text-white rounded-xl border border-white/20 hover:bg-white/20 transition-all\"\n            >\n              Close\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n    \n    <script>\n      function closeVersionHistory() {\n        document.querySelector('.version-history-modal').closest('.fixed').remove();\n      }\n      \n      function restoreVersion(contentId, version) {\n        if (confirm(\\`Are you sure you want to restore to version \\${version}? This will create a new version with the restored content.\\`)) {\n          fetch(\\`/admin/content/\\${contentId}/restore/\\${version}\\`, {\n            method: 'POST'\n          })\n          .then(response => response.json())\n          .then(data => {\n            if (data.success) {\n              showNotification('Version restored successfully! Refreshing page...', 'success');\n              setTimeout(() => {\n                window.location.reload();\n              }, 1500);\n            } else {\n              showNotification('Failed to restore version', 'error');\n            }\n          })\n          .catch(error => {\n            console.error('Error restoring version:', error);\n            showNotification('Error restoring version', 'error');\n          });\n        }\n      }\n      \n      function previewVersion(contentId, version) {\n        const preview = window.open('', '_blank');\n        preview.document.write('<p>Loading version preview...</p>');\n        \n        fetch(\\`/admin/content/\\${contentId}/version/\\${version}/preview\\`)\n        .then(response => response.text())\n        .then(html => {\n          preview.document.open();\n          preview.document.write(html);\n          preview.document.close();\n        })\n        .catch(error => {\n          preview.document.write('<p>Error loading preview</p>');\n        });\n      }\n      \n      function toggleChanges(elementId) {\n        const element = document.getElementById(elementId);\n        element.classList.toggle('hidden');\n      }\n    </script>\n  `\n}\n\nfunction escapeHtml(text: string): string {\n  if (typeof text !== 'string') return String(text || '')\n  return text.replace(/[&<>\"']/g, (char) => ({\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;'\n  }[char] || char))\n}","/**\n * Fixed Content Type Definitions\n *\n * WarpCMS uses 5 hardcoded content types instead of dynamic collections.\n * The `collectionId` column in the content table stores the type name.\n */\n\nexport interface ContentTypeField {\n  name: string\n  label: string\n  type: 'text' | 'textarea' | 'richtext' | 'file' | 'tags'\n  required?: boolean\n  placeholder?: string\n  /** Accepted MIME types for file fields */\n  accept?: string\n  /** Help text shown below the field */\n  helpText?: string\n}\n\nexport interface ContentType {\n  name: string\n  displayName: string\n  description: string\n  icon: string\n  fields: ContentTypeField[]\n  /** Accepted MIME types for the primary file upload (if any) */\n  acceptedMimeTypes?: string\n}\n\nexport const CONTENT_TYPES: Record<string, ContentType> = {\n  image: {\n    name: 'image',\n    displayName: 'Image',\n    description: 'Upload and manage images with metadata',\n    icon: `<svg class=\"h-6 w-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\"/>\n    </svg>`,\n    acceptedMimeTypes: 'image/*',\n    fields: [\n      { name: 'title', label: 'Title', type: 'text', required: true, placeholder: 'Image title' },\n      { name: 'alt_text', label: 'Alt Text', type: 'text', placeholder: 'Descriptive alt text for accessibility' },\n      { name: 'description', label: 'Description', type: 'textarea', placeholder: 'Optional description' },\n      { name: 'file', label: 'Image File', type: 'file', required: true, accept: 'image/*', helpText: 'JPG, PNG, GIF, WebP, SVG' },\n      { name: 'tags', label: 'Tags', type: 'tags', placeholder: 'Comma-separated tags' },\n    ],\n  },\n  pdf: {\n    name: 'pdf',\n    displayName: 'PDF',\n    description: 'Upload and manage PDF documents',\n    icon: `<svg class=\"h-6 w-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z\"/>\n    </svg>`,\n    acceptedMimeTypes: 'application/pdf',\n    fields: [\n      { name: 'title', label: 'Title', type: 'text', required: true, placeholder: 'Document title' },\n      { name: 'description', label: 'Description', type: 'textarea', placeholder: 'Optional description' },\n      { name: 'file', label: 'PDF File', type: 'file', required: true, accept: 'application/pdf', helpText: 'PDF files only' },\n      { name: 'tags', label: 'Tags', type: 'tags', placeholder: 'Comma-separated tags' },\n    ],\n  },\n  text: {\n    name: 'text',\n    displayName: 'Text',\n    description: 'Create plain text content',\n    icon: `<svg class=\"h-6 w-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 6h16M4 12h16M4 18h7\"/>\n    </svg>`,\n    fields: [\n      { name: 'title', label: 'Title', type: 'text', required: true, placeholder: 'Content title' },\n      { name: 'content', label: 'Content', type: 'textarea', required: true, placeholder: 'Write your content here...' },\n      { name: 'tags', label: 'Tags', type: 'tags', placeholder: 'Comma-separated tags' },\n    ],\n  },\n  html: {\n    name: 'html',\n    displayName: 'HTML',\n    description: 'Create rich HTML content with the visual editor',\n    icon: `<svg class=\"h-6 w-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4\"/>\n    </svg>`,\n    fields: [\n      { name: 'title', label: 'Title', type: 'text', required: true, placeholder: 'Content title' },\n      { name: 'content', label: 'Content', type: 'richtext', required: true },\n      { name: 'tags', label: 'Tags', type: 'tags', placeholder: 'Comma-separated tags' },\n    ],\n  },\n  file: {\n    name: 'file',\n    displayName: 'File',\n    description: 'Upload and manage any type of file',\n    icon: `<svg class=\"h-6 w-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13\"/>\n    </svg>`,\n    fields: [\n      { name: 'title', label: 'Title', type: 'text', required: true, placeholder: 'File title' },\n      { name: 'description', label: 'Description', type: 'textarea', placeholder: 'Optional description' },\n      { name: 'file', label: 'File', type: 'file', required: true, helpText: 'Any file type' },\n      { name: 'tags', label: 'Tags', type: 'tags', placeholder: 'Comma-separated tags' },\n    ],\n  },\n}\n\n/** Get a content type by name, or undefined if not found */\nexport function getContentType(name: string): ContentType | undefined {\n  return CONTENT_TYPES[name]\n}\n\n/** Get all content type names */\nexport function getContentTypeNames(): string[] {\n  return Object.keys(CONTENT_TYPES)\n}\n\n/** Get all content types as an array */\nexport function getAllContentTypes(): ContentType[] {\n  return Object.values(CONTENT_TYPES)\n}\n","import { Hono } from 'hono'\nimport { html } from 'hono/html'\nimport type { D1Database } from '@cloudflare/workers-types'\nimport { requireAuth } from '../middleware'\nimport { renderContentFormPage, ContentFormData } from '../templates/pages/admin-content-form.template'\nimport { renderContentListPage, ContentListPageData } from '../templates/pages/admin-content-list.template'\nimport { renderVersionHistory, VersionHistoryData, ContentVersion } from '../templates/components/version-history.template'\nimport { getCacheService, CACHE_CONFIGS } from '../services/cache'\nimport type { Bindings, Variables } from '../app'\nimport { getContentType, getAllContentTypes, CONTENT_TYPES } from '../content-types'\nimport type { ContentType, ContentTypeField } from '../content-types'\n\nconst adminContentRoutes = new Hono<{ Bindings: Bindings; Variables: Variables }>()\n\n// Apply authentication middleware\nadminContentRoutes.use('*', requireAuth())\n\n/**\n * Extract field data from form submission based on content type fields.\n * For file fields, the actual file URL is stored (uploaded separately via /api/media).\n */\nfunction extractFormData(\n  fields: ContentTypeField[],\n  formData: FormData\n): { data: Record<string, any>; errors: Record<string, string[]> } {\n  const data: Record<string, any> = {}\n  const errors: Record<string, string[]> = {}\n\n  for (const field of fields) {\n    const value = formData.get(field.name)\n\n    if (field.type === 'tags') {\n      // Tags are comma-separated\n      data[field.name] = value ? String(value).split(',').map(t => t.trim()).filter(Boolean) : []\n    } else if (field.type === 'file') {\n      // File field stores the URL from the upload (set via JS after upload)\n      data[field.name] = value ? String(value) : ''\n    } else {\n      data[field.name] = value ? String(value) : ''\n    }\n\n    // Validate required fields\n    if (field.required) {\n      const val = data[field.name]\n      const isEmpty = val === '' || val === null || val === undefined ||\n        (Array.isArray(val) && val.length === 0)\n      if (isEmpty) {\n        errors[field.name] = [`${field.label} is required`]\n      }\n    }\n  }\n\n  return { data, errors }\n}\n\n// ---------------------------------------------------------------------------\n// Content list (main page)\n// ---------------------------------------------------------------------------\nadminContentRoutes.get('/', async (c) => {\n  try {\n    const user = c.get('user')\n    const url = new URL(c.req.url)\n    const db = c.env.DB\n\n    const page = parseInt(url.searchParams.get('page') || '1')\n    const limit = parseInt(url.searchParams.get('limit') || '20')\n    const typeName = url.searchParams.get('type') || 'all'\n    const status = url.searchParams.get('status') || 'all'\n    const search = url.searchParams.get('search') || ''\n    const offset = (page - 1) * limit\n\n    // Build where conditions - no JOIN on collections, use collection_id as type name\n    const conditions: string[] = []\n    const params: any[] = []\n\n    if (status !== 'deleted') {\n      conditions.push(\"c.status != 'deleted'\")\n    }\n\n    if (search) {\n      conditions.push('(c.title LIKE ? OR c.slug LIKE ? OR c.data LIKE ?)')\n      params.push(`%${search}%`, `%${search}%`, `%${search}%`)\n    }\n\n    if (typeName !== 'all') {\n      conditions.push('c.collection_id = ?')\n      params.push(typeName)\n    }\n\n    if (status !== 'all' && status !== 'deleted') {\n      conditions.push('c.status = ?')\n      params.push(status)\n    } else if (status === 'deleted') {\n      conditions.push(\"c.status = 'deleted'\")\n    }\n\n    const whereClause = conditions.length > 0 ? `WHERE ${conditions.join(' AND ')}` : ''\n\n    // Get total count\n    const countStmt = db.prepare(`SELECT COUNT(*) as count FROM content c ${whereClause}`)\n    const countResult = await countStmt.bind(...params).first() as any\n    const totalItems = countResult?.count || 0\n\n    // Get content items\n    const contentStmt = db.prepare(`\n      SELECT c.id, c.title, c.slug, c.status, c.collection_id, c.created_at, c.updated_at,\n             u.first_name, u.last_name, u.email as author_email\n      FROM content c\n      LEFT JOIN users u ON c.author_id = u.id\n      ${whereClause}\n      ORDER BY c.updated_at DESC\n      LIMIT ? OFFSET ?\n    `)\n    const { results } = await contentStmt.bind(...params, limit, offset).all()\n\n    const statusConfig: Record<string, { class: string; text: string }> = {\n      draft: { class: 'bg-zinc-50 dark:bg-zinc-500/10 text-zinc-700 dark:text-zinc-400 ring-1 ring-inset ring-zinc-600/20 dark:ring-zinc-500/20', text: 'Draft' },\n      review: { class: 'bg-amber-50 dark:bg-amber-500/10 text-amber-700 dark:text-amber-400 ring-1 ring-inset ring-amber-600/20 dark:ring-amber-500/20', text: 'Under Review' },\n      scheduled: { class: 'bg-blue-50 dark:bg-blue-500/10 text-blue-700 dark:text-blue-400 ring-1 ring-inset ring-blue-600/20 dark:ring-blue-500/20', text: 'Scheduled' },\n      published: { class: 'bg-green-50 dark:bg-green-500/10 text-green-700 dark:text-green-400 ring-1 ring-inset ring-green-600/20 dark:ring-green-500/20', text: 'Published' },\n      archived: { class: 'bg-purple-50 dark:bg-purple-500/10 text-purple-700 dark:text-purple-400 ring-1 ring-inset ring-purple-600/20 dark:ring-purple-500/20', text: 'Archived' },\n      deleted: { class: 'bg-red-50 dark:bg-red-500/10 text-red-700 dark:text-red-400 ring-1 ring-inset ring-red-600/20 dark:ring-red-500/20', text: 'Deleted' },\n    }\n\n    const contentItems = (results || []).map((row: any) => {\n      const cfg = (statusConfig[row.status] ?? statusConfig.draft)!\n      const statusBadge = `<span class=\"inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ${cfg.class}\">${cfg.text}</span>`\n\n      const authorName = row.first_name && row.last_name\n        ? `${row.first_name} ${row.last_name}`\n        : row.author_email || 'Unknown'\n\n      // Resolve display name from content type\n      const ct = getContentType(row.collection_id)\n      const typeDisplayName = ct?.displayName || row.collection_id || 'Unknown'\n\n      return {\n        id: row.id,\n        title: row.title,\n        slug: row.slug,\n        modelName: typeDisplayName,\n        statusBadge,\n        authorName,\n        formattedDate: new Date(row.updated_at).toLocaleDateString(),\n        availableActions: [] as string[],\n      }\n    })\n\n    // Build type list for filter dropdown\n    const types = getAllContentTypes().map(ct => ({\n      name: ct.name,\n      displayName: ct.displayName,\n    }))\n\n    const pageData: ContentListPageData = {\n      modelName: typeName,\n      status,\n      page,\n      search,\n      models: types,\n      contentItems,\n      totalItems,\n      itemsPerPage: limit,\n      user: user ? { name: user.email, email: user.email, role: user.role } : undefined,\n      version: c.get('appVersion'),\n    }\n\n    return c.html(renderContentListPage(pageData))\n  } catch (error) {\n    console.error('Error fetching content list:', error)\n    return c.html(`<p>Error loading content: ${error}</p>`)\n  }\n})\n\n// ---------------------------------------------------------------------------\n// New content - type picker\n// ---------------------------------------------------------------------------\nadminContentRoutes.get('/new', async (c) => {\n  try {\n    const user = c.get('user')\n    const url = new URL(c.req.url)\n    const typeName = url.searchParams.get('type')\n\n    if (!typeName) {\n      // Show type picker page\n      const types = getAllContentTypes()\n      const { renderAdminLayoutCatalyst } = await import('../templates/layouts/admin-layout-catalyst.template')\n\n      const cards = types.map(ct => `\n        <a href=\"/admin/content/new?type=${ct.name}\"\n           class=\"group block rounded-xl bg-white dark:bg-zinc-800 p-6 shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10 hover:ring-cyan-500/50 dark:hover:ring-cyan-400/50 hover:shadow-md transition-all\">\n          <div class=\"flex items-center gap-4\">\n            <div class=\"flex h-12 w-12 items-center justify-center rounded-lg bg-cyan-50 dark:bg-cyan-500/10 text-cyan-600 dark:text-cyan-400\">\n              ${ct.icon}\n            </div>\n            <div>\n              <h3 class=\"text-base font-semibold text-zinc-950 dark:text-white group-hover:text-cyan-600 dark:group-hover:text-cyan-400 transition-colors\">${ct.displayName}</h3>\n              <p class=\"text-sm text-zinc-500 dark:text-zinc-400\">${ct.description}</p>\n            </div>\n          </div>\n        </a>\n      `).join('')\n\n      const pageContent = `\n        <div class=\"mb-6\">\n          <a href=\"/admin/content\" class=\"inline-flex items-center gap-1.5 text-sm text-zinc-500 dark:text-zinc-400 hover:text-zinc-700 dark:hover:text-zinc-300 transition-colors\">\n            <svg class=\"h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 19l-7-7 7-7\"/></svg>\n            Back to Content\n          </a>\n        </div>\n        <div class=\"mb-8\">\n          <h1 class=\"text-2xl font-semibold text-zinc-950 dark:text-white\">Create New Content</h1>\n          <p class=\"mt-2 text-sm text-zinc-500 dark:text-zinc-400\">Choose a content type to get started</p>\n        </div>\n        <div class=\"grid gap-4 sm:grid-cols-2 lg:grid-cols-3\">\n          ${cards}\n        </div>\n      `\n\n      return c.html(renderAdminLayoutCatalyst({\n        title: 'New Content',\n        currentPath: '/admin/content',\n        user: user ? { name: user.email, email: user.email, role: user.role } : undefined,\n        version: c.get('appVersion'),\n        content: pageContent,\n      }))\n    }\n\n    const contentType = getContentType(typeName)\n    if (!contentType) {\n      return c.html(renderContentFormPage({\n        contentType: { name: 'unknown', displayName: 'Unknown', description: '', icon: '', fields: [] },\n        error: 'Content type not found.',\n        user: user ? { name: user.email, email: user.email, role: user.role } : undefined,\n      }))\n    }\n\n    return c.html(renderContentFormPage({\n      contentType,\n      isEdit: false,\n      user: user ? { name: user.email, email: user.email, role: user.role } : undefined,\n      version: c.get('appVersion'),\n    }))\n  } catch (error) {\n    console.error('Error loading new content form:', error)\n    return c.html(renderContentFormPage({\n      contentType: { name: 'unknown', displayName: 'Unknown', description: '', icon: '', fields: [] },\n      error: 'Failed to load content form.',\n      user: c.get('user') ? { name: c.get('user')!.email, email: c.get('user')!.email, role: c.get('user')!.role } : undefined,\n    }))\n  }\n})\n\n// ---------------------------------------------------------------------------\n// Edit content form\n// ---------------------------------------------------------------------------\nadminContentRoutes.get('/:id/edit', async (c) => {\n  try {\n    const id = c.req.param('id')\n    const user = c.get('user')\n    const db = c.env.DB\n    const url = new URL(c.req.url)\n    const referrerParams = url.searchParams.get('ref') || ''\n\n    const cache = getCacheService(CACHE_CONFIGS.content!)\n    const content = await cache.getOrSet(\n      cache.generateKey('content', id),\n      async () => {\n        const stmt = db.prepare('SELECT * FROM content WHERE id = ?')\n        return await stmt.bind(id).first() as any\n      }\n    )\n\n    if (!content) {\n      return c.html(renderContentFormPage({\n        contentType: { name: 'unknown', displayName: 'Unknown', description: '', icon: '', fields: [] },\n        error: 'Content not found.',\n        user: user ? { name: user.email, email: user.email, role: user.role } : undefined,\n      }))\n    }\n\n    // Resolve content type from collection_id\n    const contentType = getContentType(content.collection_id) || {\n      name: content.collection_id || 'unknown',\n      displayName: content.collection_id || 'Unknown',\n      description: '',\n      icon: '',\n      fields: [],\n    }\n\n    const contentData = content.data ? JSON.parse(content.data) : {}\n\n    return c.html(renderContentFormPage({\n      id: content.id,\n      title: content.title,\n      slug: content.slug,\n      data: contentData,\n      status: content.status,\n      contentType,\n      isEdit: true,\n      referrerParams,\n      user: user ? { name: user.email, email: user.email, role: user.role } : undefined,\n      version: c.get('appVersion'),\n    }))\n  } catch (error) {\n    console.error('Error loading edit content form:', error)\n    return c.html(renderContentFormPage({\n      contentType: { name: 'unknown', displayName: 'Unknown', description: '', icon: '', fields: [] },\n      error: 'Failed to load content for editing.',\n      user: c.get('user') ? { name: c.get('user')!.email, email: c.get('user')!.email, role: c.get('user')!.role } : undefined,\n    }))\n  }\n})\n\n// ---------------------------------------------------------------------------\n// Create content\n// ---------------------------------------------------------------------------\nadminContentRoutes.post('/', async (c) => {\n  try {\n    const user = c.get('user')\n    const formData = await c.req.formData()\n    const typeName = formData.get('content_type') as string\n    const action = formData.get('action') as string\n\n    const contentType = getContentType(typeName)\n    if (!contentType) {\n      return c.html(html`<div class=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\">Invalid content type.</div>`)\n    }\n\n    const db = c.env.DB\n    const { data, errors } = extractFormData(contentType.fields, formData)\n\n    if (Object.keys(errors).length > 0) {\n      return c.html(renderContentFormPage({\n        contentType,\n        data,\n        validationErrors: errors,\n        error: 'Please fix the validation errors below.',\n        user: user ? { name: user.email, email: user.email, role: user.role } : undefined,\n      }))\n    }\n\n    // Generate slug\n    let slug = (data.title || 'untitled').toLowerCase()\n      .replace(/[^a-z0-9\\s-]/g, '')\n      .replace(/\\s+/g, '-')\n      .replace(/-+/g, '-')\n\n    let status = formData.get('status') as string || 'draft'\n    if (action === 'save_and_publish') status = 'published'\n\n    const contentId = crypto.randomUUID()\n    const now = Date.now()\n\n    await db.prepare(`\n      INSERT INTO content (id, collection_id, slug, title, data, status, author_id, created_at, updated_at)\n      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n    `).bind(contentId, typeName, slug, data.title || 'Untitled', JSON.stringify(data), status, user?.userId || 'unknown', now, now).run()\n\n    // Invalidate cache\n    const cache = getCacheService(CACHE_CONFIGS.content!)\n    await cache.invalidate('content:list:*')\n\n    // Create initial version\n    await db.prepare(`\n      INSERT INTO content_versions (id, content_id, version, data, author_id, created_at)\n      VALUES (?, ?, ?, ?, ?, ?)\n    `).bind(crypto.randomUUID(), contentId, 1, JSON.stringify(data), user?.userId || 'unknown', now).run()\n\n    // Log workflow\n    await db.prepare(`\n      INSERT INTO workflow_history (id, content_id, action, from_status, to_status, user_id, created_at)\n      VALUES (?, ?, ?, ?, ?, ?, ?)\n    `).bind(crypto.randomUUID(), contentId, 'created', 'none', status, user?.userId || 'unknown', now).run()\n\n    const referrerParams = formData.get('referrer_params') as string\n    const redirectUrl = action === 'save_and_continue'\n      ? `/admin/content/${contentId}/edit?success=Content saved successfully!${referrerParams ? `&ref=${encodeURIComponent(referrerParams)}` : ''}`\n      : referrerParams\n        ? `/admin/content?${referrerParams}&success=Content created successfully!`\n        : `/admin/content?type=${typeName}&success=Content created successfully!`\n\n    const isHTMX = c.req.header('HX-Request') === 'true'\n    return isHTMX\n      ? c.text('', 200, { 'HX-Redirect': redirectUrl })\n      : c.redirect(redirectUrl)\n  } catch (error) {\n    console.error('Error creating content:', error)\n    return c.html(html`<div class=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\">Failed to create content. Please try again.</div>`)\n  }\n})\n\n// ---------------------------------------------------------------------------\n// Update content\n// ---------------------------------------------------------------------------\nadminContentRoutes.put('/:id', async (c) => {\n  try {\n    const id = c.req.param('id')\n    const user = c.get('user')\n    const formData = await c.req.formData()\n    const action = formData.get('action') as string\n\n    const db = c.env.DB\n\n    const existingContent = await db.prepare('SELECT * FROM content WHERE id = ?').bind(id).first() as any\n    if (!existingContent) {\n      return c.html(html`<div class=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\">Content not found.</div>`)\n    }\n\n    const contentType = getContentType(existingContent.collection_id)\n    if (!contentType) {\n      return c.html(html`<div class=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\">Content type not found.</div>`)\n    }\n\n    const { data, errors } = extractFormData(contentType.fields, formData)\n\n    if (Object.keys(errors).length > 0) {\n      return c.html(renderContentFormPage({\n        id,\n        contentType,\n        data,\n        validationErrors: errors,\n        error: 'Please fix the validation errors below.',\n        isEdit: true,\n        user: user ? { name: user.email, email: user.email, role: user.role } : undefined,\n      }))\n    }\n\n    let slug = (data.title || 'untitled').toLowerCase()\n      .replace(/[^a-z0-9\\s-]/g, '')\n      .replace(/\\s+/g, '-')\n      .replace(/-+/g, '-')\n\n    let status = formData.get('status') as string || existingContent.status\n    if (action === 'save_and_publish') status = 'published'\n\n    const now = Date.now()\n\n    await db.prepare(`\n      UPDATE content SET slug = ?, title = ?, data = ?, status = ?, updated_at = ?\n      WHERE id = ?\n    `).bind(slug, data.title || 'Untitled', JSON.stringify(data), status, now, id).run()\n\n    // Invalidate cache\n    const cache = getCacheService(CACHE_CONFIGS.content!)\n    await cache.delete(cache.generateKey('content', id))\n    await cache.invalidate('content:list:*')\n\n    // Create version if content changed\n    const existingData = JSON.parse(existingContent.data || '{}')\n    if (JSON.stringify(existingData) !== JSON.stringify(data)) {\n      const versionResult = await db.prepare('SELECT MAX(version) as max_version FROM content_versions WHERE content_id = ?').bind(id).first() as any\n      const nextVersion = (versionResult?.max_version || 0) + 1\n      await db.prepare(`\n        INSERT INTO content_versions (id, content_id, version, data, author_id, created_at)\n        VALUES (?, ?, ?, ?, ?, ?)\n      `).bind(crypto.randomUUID(), id, nextVersion, JSON.stringify(data), user?.userId || 'unknown', now).run()\n    }\n\n    // Log workflow if status changed\n    if (status !== existingContent.status) {\n      await db.prepare(`\n        INSERT INTO workflow_history (id, content_id, action, from_status, to_status, user_id, created_at)\n        VALUES (?, ?, ?, ?, ?, ?, ?)\n      `).bind(crypto.randomUUID(), id, 'status_changed', existingContent.status, status, user?.userId || 'unknown', now).run()\n    }\n\n    const referrerParams = formData.get('referrer_params') as string\n    const redirectUrl = action === 'save_and_continue'\n      ? `/admin/content/${id}/edit?success=Content updated successfully!${referrerParams ? `&ref=${encodeURIComponent(referrerParams)}` : ''}`\n      : referrerParams\n        ? `/admin/content?${referrerParams}&success=Content updated successfully!`\n        : `/admin/content?type=${existingContent.collection_id}&success=Content updated successfully!`\n\n    const isHTMX = c.req.header('HX-Request') === 'true'\n    return isHTMX\n      ? c.text('', 200, { 'HX-Redirect': redirectUrl })\n      : c.redirect(redirectUrl)\n  } catch (error) {\n    console.error('Error updating content:', error)\n    return c.html(html`<div class=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\">Failed to update content. Please try again.</div>`)\n  }\n})\n\n// ---------------------------------------------------------------------------\n// Duplicate content\n// ---------------------------------------------------------------------------\nadminContentRoutes.post('/duplicate', async (c) => {\n  try {\n    const user = c.get('user')\n    const formData = await c.req.formData()\n    const originalId = formData.get('id') as string\n    if (!originalId) return c.json({ success: false, error: 'Content ID required' })\n\n    const db = c.env.DB\n    const original = await db.prepare('SELECT * FROM content WHERE id = ?').bind(originalId).first() as any\n    if (!original) return c.json({ success: false, error: 'Content not found' })\n\n    const newId = crypto.randomUUID()\n    const now = Date.now()\n    const originalData = JSON.parse(original.data || '{}')\n    originalData.title = `${originalData.title || 'Untitled'} (Copy)`\n\n    await db.prepare(`\n      INSERT INTO content (id, collection_id, slug, title, data, status, author_id, created_at, updated_at)\n      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n    `).bind(newId, original.collection_id, `${original.slug}-copy-${Date.now()}`, originalData.title, JSON.stringify(originalData), 'draft', user?.userId || 'unknown', now, now).run()\n\n    return c.json({ success: true, id: newId })\n  } catch (error) {\n    console.error('Error duplicating content:', error)\n    return c.json({ success: false, error: 'Failed to duplicate content' })\n  }\n})\n\n// ---------------------------------------------------------------------------\n// Bulk action\n// ---------------------------------------------------------------------------\nadminContentRoutes.post('/bulk-action', async (c) => {\n  try {\n    const body = await c.req.json()\n    const { action, ids } = body\n    if (!action || !ids || ids.length === 0) return c.json({ success: false, error: 'Action and IDs required' })\n\n    const db = c.env.DB\n    const now = Date.now()\n    const placeholders = ids.map(() => '?').join(',')\n\n    if (action === 'delete') {\n      await db.prepare(`UPDATE content SET status = 'deleted', updated_at = ? WHERE id IN (${placeholders})`).bind(now, ...ids).run()\n    } else if (action === 'publish' || action === 'draft') {\n      const publishedAt = action === 'publish' ? now : null\n      await db.prepare(`UPDATE content SET status = ?, published_at = ?, updated_at = ? WHERE id IN (${placeholders})`).bind(action, publishedAt, now, ...ids).run()\n    } else {\n      return c.json({ success: false, error: 'Invalid action' })\n    }\n\n    const cache = getCacheService(CACHE_CONFIGS.content!)\n    for (const contentId of ids) {\n      await cache.delete(cache.generateKey('content', contentId))\n    }\n    await cache.invalidate('content:list:*')\n\n    return c.json({ success: true, count: ids.length })\n  } catch (error) {\n    console.error('Bulk action error:', error)\n    return c.json({ success: false, error: 'Failed to perform bulk action' })\n  }\n})\n\n// ---------------------------------------------------------------------------\n// Delete content (soft)\n// ---------------------------------------------------------------------------\nadminContentRoutes.delete('/:id', async (c) => {\n  try {\n    const id = c.req.param('id')\n    const db = c.env.DB\n\n    const content = await db.prepare('SELECT id FROM content WHERE id = ?').bind(id).first() as any\n    if (!content) return c.json({ success: false, error: 'Content not found' }, 404)\n\n    const now = Date.now()\n    await db.prepare(`UPDATE content SET status = 'deleted', updated_at = ? WHERE id = ?`).bind(now, id).run()\n\n    const cache = getCacheService(CACHE_CONFIGS.content!)\n    await cache.delete(cache.generateKey('content', id))\n    await cache.invalidate('content:list:*')\n\n    return c.html(`\n      <div id=\"content-list\" hx-get=\"/admin/content\" hx-trigger=\"load\" hx-swap=\"outerHTML\">\n        <div class=\"flex items-center justify-center p-8\">\n          <div class=\"text-center\">\n            <svg class=\"mx-auto h-12 w-12 text-lime-500 dark:text-lime-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 13l4 4L19 7\"/>\n            </svg>\n            <p class=\"mt-2 text-sm text-zinc-600 dark:text-zinc-400\">Content deleted successfully. Refreshing...</p>\n          </div>\n        </div>\n      </div>\n    `)\n  } catch (error) {\n    console.error('Delete content error:', error)\n    return c.json({ success: false, error: 'Failed to delete content' }, 500)\n  }\n})\n\n// ---------------------------------------------------------------------------\n// Version history\n// ---------------------------------------------------------------------------\nadminContentRoutes.get('/:id/versions', async (c) => {\n  try {\n    const id = c.req.param('id')\n    const db = c.env.DB\n\n    const content = await db.prepare('SELECT * FROM content WHERE id = ?').bind(id).first() as any\n    if (!content) return c.html('<p>Content not found</p>')\n\n    const { results } = await db.prepare(`\n      SELECT cv.*, u.first_name, u.last_name, u.email\n      FROM content_versions cv\n      LEFT JOIN users u ON cv.author_id = u.id\n      WHERE cv.content_id = ?\n      ORDER BY cv.version DESC\n    `).bind(id).all()\n\n    const versions: ContentVersion[] = (results || []).map((row: any) => ({\n      id: row.id,\n      version: row.version,\n      data: JSON.parse(row.data || '{}'),\n      author_id: row.author_id,\n      author_name: row.first_name && row.last_name ? `${row.first_name} ${row.last_name}` : row.email,\n      created_at: row.created_at,\n      is_current: false,\n    }))\n\n    if (versions.length > 0) versions[0]!.is_current = true\n\n    return c.html(renderVersionHistory({\n      contentId: id,\n      versions,\n      currentVersion: versions.length > 0 ? versions[0]!.version : 1,\n    }))\n  } catch (error) {\n    console.error('Error loading version history:', error)\n    return c.html('<p>Error loading version history</p>')\n  }\n})\n\n// ---------------------------------------------------------------------------\n// Restore version\n// ---------------------------------------------------------------------------\nadminContentRoutes.post('/:id/restore/:version', async (c) => {\n  try {\n    const id = c.req.param('id')\n    const version = parseInt(c.req.param('version'))\n    const user = c.get('user')\n    const db = c.env.DB\n\n    const versionData = await db.prepare('SELECT * FROM content_versions WHERE content_id = ? AND version = ?').bind(id, version).first() as any\n    if (!versionData) return c.json({ success: false, error: 'Version not found' })\n\n    const currentContent = await db.prepare('SELECT * FROM content WHERE id = ?').bind(id).first() as any\n    if (!currentContent) return c.json({ success: false, error: 'Content not found' })\n\n    const restoredData = JSON.parse(versionData.data)\n    const now = Date.now()\n\n    await db.prepare('UPDATE content SET title = ?, data = ?, updated_at = ? WHERE id = ?')\n      .bind(restoredData.title || 'Untitled', versionData.data, now, id).run()\n\n    const nextVersionResult = await db.prepare('SELECT MAX(version) as max_version FROM content_versions WHERE content_id = ?').bind(id).first() as any\n    const nextVersion = (nextVersionResult?.max_version || 0) + 1\n\n    await db.prepare('INSERT INTO content_versions (id, content_id, version, data, author_id, created_at) VALUES (?, ?, ?, ?, ?, ?)')\n      .bind(crypto.randomUUID(), id, nextVersion, versionData.data, user?.userId || 'unknown', now).run()\n\n    await db.prepare('INSERT INTO workflow_history (id, content_id, action, from_status, to_status, user_id, comment, created_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?)')\n      .bind(crypto.randomUUID(), id, 'version_restored', currentContent.status, currentContent.status, user?.userId || 'unknown', `Restored to version ${version}`, now).run()\n\n    return c.json({ success: true })\n  } catch (error) {\n    console.error('Error restoring version:', error)\n    return c.json({ success: false, error: 'Failed to restore version' })\n  }\n})\n\n// ---------------------------------------------------------------------------\n// Preview specific version\n// ---------------------------------------------------------------------------\nadminContentRoutes.get('/:id/version/:version/preview', async (c) => {\n  try {\n    const id = c.req.param('id')\n    const version = parseInt(c.req.param('version'))\n    const db = c.env.DB\n\n    const versionData = await db.prepare(`\n      SELECT cv.*, c.collection_id\n      FROM content_versions cv\n      JOIN content c ON cv.content_id = c.id\n      WHERE cv.content_id = ? AND cv.version = ?\n    `).bind(id, version).first() as any\n\n    if (!versionData) return c.html('<p>Version not found</p>')\n\n    const ct = getContentType(versionData.collection_id)\n    const data = JSON.parse(versionData.data || '{}')\n\n    return c.html(`\n      <!DOCTYPE html>\n      <html lang=\"en\">\n      <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>Version ${version} Preview: ${data.title || 'Untitled'}</title>\n        <style>\n          body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }\n          h1 { color: #333; }\n          .meta { color: #666; font-size: 14px; margin-bottom: 20px; padding: 10px; background: #f5f5f5; border-radius: 5px; }\n          .version-badge { background: #007cba; color: white; padding: 5px 10px; border-radius: 15px; font-size: 12px; }\n        </style>\n      </head>\n      <body>\n        <div class=\"meta\">\n          <span class=\"version-badge\">Version ${version}</span>\n          <strong>Type:</strong> ${ct?.displayName || versionData.collection_id}<br>\n          <strong>Created:</strong> ${new Date(versionData.created_at).toLocaleString()}<br>\n          <em>Historical version preview</em>\n        </div>\n        <h1>${data.title || 'Untitled'}</h1>\n        <div>${data.content || ''}</div>\n        <h3>All Field Data:</h3>\n        <pre style=\"background: #f5f5f5; padding: 15px; border-radius: 5px; overflow-x: auto;\">${JSON.stringify(data, null, 2)}</pre>\n      </body>\n      </html>\n    `)\n  } catch (error) {\n    console.error('Error generating version preview:', error)\n    return c.html('<p>Error generating preview</p>')\n  }\n})\n\nexport default adminContentRoutes\n","import { renderAdminLayoutCatalyst, AdminLayoutCatalystData } from '../layouts/admin-layout-catalyst.template'\nimport { renderAlert } from '../alert.template'\n\nexport interface UserProfile {\n  id: string\n  email: string\n  username: string\n  first_name: string\n  last_name: string\n  phone?: string\n  bio?: string\n  avatar_url?: string\n  timezone: string\n  language: string\n  theme: string\n  email_notifications: boolean\n  two_factor_enabled: boolean\n  role: string\n  created_at: number\n  last_login_at?: number\n}\n\nexport interface ProfilePageData {\n  profile: UserProfile\n  timezones: Array<{ value: string; label: string }>\n  languages: Array<{ value: string; label: string }>\n  error?: string\n  success?: string\n  user?: {\n    name: string\n    email: string\n    role: string\n  }\n  version?: string\n}\n\nexport function renderAvatarImage(avatarUrl: string | undefined, firstName: string, lastName: string): string {\n  return `<div id=\"avatar-image-container\" class=\"w-24 h-24 rounded-full mx-auto mb-4 overflow-hidden bg-gradient-to-br from-cyan-400 to-purple-400 flex items-center justify-center ring-4 ring-zinc-950/5 dark:ring-white/10\">\n    ${avatarUrl\n      ? `<img src=\"${avatarUrl}\" alt=\"Profile picture\" class=\"w-full h-full object-cover\">`\n      : `<span class=\"text-2xl font-bold text-white\">${firstName.charAt(0)}${lastName.charAt(0)}</span>`\n    }\n  </div>`\n}\n\nexport function renderProfilePage(data: ProfilePageData): string {\n  const pageContent = `\n    <div class=\"space-y-8\">\n      <!-- Header -->\n      <div class=\"sm:flex sm:items-center sm:justify-between\">\n        <div>\n          <h1 class=\"text-2xl/8 font-semibold text-zinc-950 dark:text-white sm:text-xl/8\">User Profile</h1>\n          <p class=\"mt-2 text-sm/6 text-zinc-500 dark:text-zinc-400\">\n            Manage your account settings and preferences\n          </p>\n        </div>\n      </div>\n\n      <!-- Alert Messages -->\n      ${data.error ? renderAlert({ type: 'error', message: data.error, dismissible: true }) : ''}\n      ${data.success ? renderAlert({ type: 'success', message: data.success, dismissible: true }) : ''}\n\n      <!-- Profile Form -->\n      <div class=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n        <!-- Main Profile Form -->\n        <div class=\"lg:col-span-2\">\n          <div class=\"rounded-xl bg-white dark:bg-zinc-900 shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10\">\n            <!-- Form Header -->\n            <div class=\"px-6 py-5 border-b border-zinc-950/5 dark:border-white/5\">\n              <div class=\"flex items-center gap-x-3\">\n                <div class=\"flex h-10 w-10 items-center justify-center rounded-lg bg-zinc-950 dark:bg-white\">\n                  <svg class=\"h-5 w-5 text-white dark:text-zinc-950\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\"/>\n                  </svg>\n                </div>\n                <div>\n                  <h2 class=\"text-base font-semibold text-zinc-950 dark:text-white\">Profile Information</h2>\n                  <p class=\"text-sm text-zinc-500 dark:text-zinc-400\">Update your account details</p>\n                </div>\n              </div>\n            </div>\n\n            <!-- Form Content -->\n            <form id=\"profile-form\" hx-put=\"/admin/profile\" hx-target=\"#form-messages\" class=\"p-6 space-y-6\">\n              <div id=\"form-messages\"></div>\n\n              <!-- Basic Information -->\n              <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <div>\n                  <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">First Name</label>\n                  <input\n                    type=\"text\"\n                    name=\"first_name\"\n                    value=\"${data.profile.first_name}\"\n                    required\n                    class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                    placeholder=\"Enter your first name\"\n                  >\n                </div>\n                <div>\n                  <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Last Name</label>\n                  <input\n                    type=\"text\"\n                    name=\"last_name\"\n                    value=\"${data.profile.last_name}\"\n                    required\n                    class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                    placeholder=\"Enter your last name\"\n                  >\n                </div>\n              </div>\n\n              <div>\n                <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Username</label>\n                <input\n                  type=\"text\"\n                  name=\"username\"\n                  value=\"${data.profile.username}\"\n                  required\n                  class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                  placeholder=\"Enter your username\"\n                >\n              </div>\n\n              <div>\n                <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Email Address</label>\n                <input\n                  type=\"email\"\n                  name=\"email\"\n                  value=\"${data.profile.email}\"\n                  required\n                  class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                  placeholder=\"Enter your email address\"\n                >\n              </div>\n\n              <div>\n                <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Phone Number</label>\n                <input\n                  type=\"tel\"\n                  name=\"phone\"\n                  value=\"${data.profile.phone || ''}\"\n                  class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                  placeholder=\"Enter your phone number\"\n                >\n              </div>\n\n              <div>\n                <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Bio</label>\n                <textarea\n                  name=\"bio\"\n                  rows=\"3\"\n                  class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow resize-none\"\n                  placeholder=\"Tell us about yourself...\"\n                >${data.profile.bio || ''}</textarea>\n              </div>\n\n              <!-- Preferences -->\n              <div class=\"pt-6 border-t border-zinc-950/5 dark:border-white/5\">\n                <h3 class=\"text-base font-semibold text-zinc-950 dark:text-white mb-4\">Preferences</h3>\n\n                <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  <div>\n                    <label for=\"timezone\" class=\"block text-sm/6 font-medium text-zinc-950 dark:text-white mb-2\">Timezone</label>\n                    <div class=\"grid grid-cols-1\">\n                      <select id=\"timezone\" name=\"timezone\" class=\"col-start-1 row-start-1 w-full appearance-none rounded-md bg-white/5 dark:bg-white/5 py-1.5 pl-3 pr-8 text-base text-zinc-950 dark:text-white outline outline-1 -outline-offset-1 outline-zinc-500/30 dark:outline-zinc-400/30 *:bg-white dark:*:bg-zinc-800 focus-visible:outline focus-visible:outline-2 focus-visible:-outline-offset-2 focus-visible:outline-zinc-500 dark:focus-visible:outline-zinc-400 sm:text-sm/6\">\n                        ${data.timezones.map(tz => `\n                          <option value=\"${tz.value}\" ${tz.value === data.profile.timezone ? 'selected' : ''}>${tz.label}</option>\n                        `).join('')}\n                      </select>\n                      <svg viewBox=\"0 0 16 16\" fill=\"currentColor\" aria-hidden=\"true\" class=\"pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-zinc-600 dark:text-zinc-400 sm:size-4\">\n                        <path d=\"M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z\" clip-rule=\"evenodd\" fill-rule=\"evenodd\" />\n                      </svg>\n                    </div>\n                  </div>\n                  <div>\n                    <label for=\"language\" class=\"block text-sm/6 font-medium text-zinc-950 dark:text-white mb-2\">Language</label>\n                    <div class=\"grid grid-cols-1\">\n                      <select id=\"language\" name=\"language\" class=\"col-start-1 row-start-1 w-full appearance-none rounded-md bg-white/5 dark:bg-white/5 py-1.5 pl-3 pr-8 text-base text-zinc-950 dark:text-white outline outline-1 -outline-offset-1 outline-zinc-500/30 dark:outline-zinc-400/30 *:bg-white dark:*:bg-zinc-800 focus-visible:outline focus-visible:outline-2 focus-visible:-outline-offset-2 focus-visible:outline-zinc-500 dark:focus-visible:outline-zinc-400 sm:text-sm/6\">\n                        ${data.languages.map(lang => `\n                          <option value=\"${lang.value}\" ${lang.value === data.profile.language ? 'selected' : ''}>${lang.label}</option>\n                        `).join('')}\n                      </select>\n                      <svg viewBox=\"0 0 16 16\" fill=\"currentColor\" aria-hidden=\"true\" class=\"pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-zinc-600 dark:text-zinc-400 sm:size-4\">\n                        <path d=\"M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z\" clip-rule=\"evenodd\" fill-rule=\"evenodd\" />\n                      </svg>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <!-- Notifications -->\n              <div class=\"pt-6 border-t border-zinc-950/5 dark:border-white/5\">\n                <h3 class=\"text-base font-semibold text-zinc-950 dark:text-white mb-4\">Notifications</h3>\n\n                <div class=\"space-y-5\">\n                  <div class=\"flex gap-3\">\n                    <div class=\"flex h-6 shrink-0 items-center\">\n                      <div class=\"group grid size-4 grid-cols-1\">\n                        <input\n                          type=\"checkbox\"\n                          id=\"email_notifications\"\n                          name=\"email_notifications\"\n                          value=\"1\"\n                          ${data.profile.email_notifications ? 'checked' : ''}\n                          class=\"col-start-1 row-start-1 appearance-none rounded border border-zinc-950/10 dark:border-white/10 bg-white dark:bg-white/5 checked:border-indigo-500 checked:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 disabled:border-zinc-950/5 dark:disabled:border-white/5 disabled:bg-zinc-950/10 dark:disabled:bg-white/10 forced-colors:appearance-auto\"\n                        />\n                        <svg viewBox=\"0 0 14 14\" fill=\"none\" class=\"pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-[:disabled]:stroke-zinc-950/25 dark:group-has-[:disabled]:stroke-white/25\">\n                          <path d=\"M3 8L6 11L11 3.5\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:checked]:opacity-100\" />\n                        </svg>\n                      </div>\n                    </div>\n                    <div class=\"text-sm/6\">\n                      <label for=\"email_notifications\" class=\"font-medium text-zinc-950 dark:text-white\">Email notifications</label>\n                      <p class=\"text-zinc-500 dark:text-zinc-400\">Receive email updates about new features and product announcements.</p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <!-- Submit Button -->\n              <div class=\"pt-6 border-t border-zinc-950/5 dark:border-white/5\">\n                <button\n                  type=\"submit\"\n                  class=\"inline-flex justify-center items-center gap-x-2 rounded-lg bg-zinc-950 dark:bg-white px-4 py-2.5 text-sm font-semibold text-white dark:text-zinc-950 hover:bg-zinc-800 dark:hover:bg-zinc-100 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-zinc-950 dark:focus-visible:outline-white transition-colors\"\n                >\n                  <svg class=\"h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 13l4 4L19 7\"/>\n                  </svg>\n                  Update Profile\n                </button>\n              </div>\n            </form>\n          </div>\n        </div>\n\n        <!-- Profile Sidebar -->\n        <div class=\"lg:col-span-1 space-y-6\">\n          <!-- Avatar -->\n          <div class=\"rounded-xl bg-white dark:bg-zinc-900 shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10 p-6\">\n            <h3 class=\"text-base font-semibold text-zinc-950 dark:text-white mb-4\">Profile Picture</h3>\n\n            <div class=\"text-center\">\n              ${renderAvatarImage(data.profile.avatar_url, data.profile.first_name, data.profile.last_name)}\n\n              <form id=\"avatar-form\" hx-post=\"/admin/profile/avatar\" hx-target=\"#avatar-messages\" hx-encoding=\"multipart/form-data\">\n                <input\n                  type=\"file\"\n                  name=\"avatar\"\n                  accept=\"image/*\"\n                  class=\"hidden\"\n                  id=\"avatar-input\"\n                  onchange=\"document.getElementById('avatar-form').dispatchEvent(new Event('submit'))\"\n                >\n                <label\n                  for=\"avatar-input\"\n                  class=\"inline-flex items-center gap-x-2 rounded-lg bg-white dark:bg-zinc-800 px-4 py-2.5 text-sm font-semibold text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 hover:bg-zinc-50 dark:hover:bg-zinc-700 transition-colors cursor-pointer\"\n                >\n                  <svg class=\"h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z\"/>\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 13a3 3 0 11-6 0 3 3 0 016 0z\"/>\n                  </svg>\n                  Change Picture\n                </label>\n              </form>\n\n              <div id=\"avatar-messages\" class=\"mt-3\"></div>\n            </div>\n          </div>\n\n          <!-- Account Info -->\n          <div class=\"rounded-xl bg-white dark:bg-zinc-900 shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10 p-6\">\n            <h3 class=\"text-base font-semibold text-zinc-950 dark:text-white mb-4\">Account Information</h3>\n\n            <dl class=\"space-y-3 text-sm\">\n              <div>\n                <dt class=\"text-zinc-500 dark:text-zinc-400\">Role</dt>\n                <dd class=\"mt-1\">\n                  <span class=\"inline-flex items-center rounded-md bg-blue-50 dark:bg-blue-500/10 px-2 py-1 text-xs font-medium text-blue-700 dark:text-blue-400 ring-1 ring-inset ring-blue-700/10 dark:ring-blue-400/20 capitalize\">\n                    ${data.profile.role}\n                  </span>\n                </dd>\n              </div>\n              <div>\n                <dt class=\"text-zinc-500 dark:text-zinc-400\">Member Since</dt>\n                <dd class=\"mt-1 text-zinc-950 dark:text-white\">${new Date(data.profile.created_at).toLocaleDateString()}</dd>\n              </div>\n              ${data.profile.last_login_at ? `\n                <div>\n                  <dt class=\"text-zinc-500 dark:text-zinc-400\">Last Login</dt>\n                  <dd class=\"mt-1 text-zinc-950 dark:text-white\">${new Date(data.profile.last_login_at).toLocaleDateString()}</dd>\n                </div>\n              ` : ''}\n              <div>\n                <dt class=\"text-zinc-500 dark:text-zinc-400\">Two-Factor Auth</dt>\n                <dd class=\"mt-1\">\n                  ${data.profile.two_factor_enabled\n                    ? '<span class=\"inline-flex items-center rounded-md bg-green-50 dark:bg-green-500/10 px-2 py-1 text-xs font-medium text-green-700 dark:text-green-400 ring-1 ring-inset ring-green-600/20 dark:ring-green-500/20\">Enabled</span>'\n                    : '<span class=\"inline-flex items-center rounded-md bg-zinc-50 dark:bg-zinc-800 px-2 py-1 text-xs font-medium text-zinc-600 dark:text-zinc-400 ring-1 ring-inset ring-zinc-500/10 dark:ring-zinc-400/20\">Disabled</span>'\n                  }\n                </dd>\n              </div>\n            </dl>\n          </div>\n\n          <!-- Security Actions -->\n          <div class=\"rounded-xl bg-white dark:bg-zinc-900 shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10 p-6\">\n            <h3 class=\"text-base font-semibold text-zinc-950 dark:text-white mb-4\">Security</h3>\n\n            <div class=\"space-y-2\">\n              <button\n                type=\"button\"\n                onclick=\"showChangePasswordModal()\"\n                class=\"w-full text-left flex items-center gap-x-3 px-3 py-2 text-sm text-zinc-950 dark:text-white hover:bg-zinc-50 dark:hover:bg-zinc-800/50 rounded-lg transition-colors\"\n              >\n                <svg class=\"w-4 h-4 text-zinc-500 dark:text-zinc-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-3.586l4.293-4.293A6 6 0 0119 9z\"/>\n                </svg>\n                <span class=\"font-medium\">Change Password</span>\n              </button>\n\n              <button\n                type=\"button\"\n                onclick=\"toggle2FA()\"\n                class=\"w-full text-left flex items-center gap-x-3 px-3 py-2 text-sm text-zinc-950 dark:text-white hover:bg-zinc-50 dark:hover:bg-zinc-800/50 rounded-lg transition-colors\"\n              >\n                <svg class=\"w-4 h-4 text-zinc-500 dark:text-zinc-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\"/>\n                </svg>\n                <span class=\"font-medium\">${data.profile.two_factor_enabled ? 'Disable' : 'Enable'} 2FA</span>\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Change Password Modal -->\n    <div id=\"password-modal\" class=\"fixed inset-0 bg-zinc-950/50 backdrop-blur-sm flex items-center justify-center z-50 hidden\">\n      <div class=\"rounded-xl bg-white dark:bg-zinc-900 shadow-2xl ring-1 ring-zinc-950/5 dark:ring-white/10 w-full max-w-md mx-4\">\n        <div class=\"px-6 py-5 border-b border-zinc-950/5 dark:border-white/5\">\n          <div class=\"flex items-center justify-between\">\n            <h3 class=\"text-base font-semibold text-zinc-950 dark:text-white\">Change Password</h3>\n            <button onclick=\"closePasswordModal()\" class=\"text-zinc-500 dark:text-zinc-400 hover:text-zinc-950 dark:hover:text-white transition-colors\">\n              <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\"></path>\n              </svg>\n            </button>\n          </div>\n        </div>\n\n        <form id=\"password-form\" hx-post=\"/admin/profile/password\" hx-target=\"#password-messages\" class=\"p-6 space-y-4\">\n          <div id=\"password-messages\"></div>\n\n          <div>\n            <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Current Password</label>\n            <input\n              type=\"password\"\n              name=\"current_password\"\n              required\n              class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n              placeholder=\"Enter current password\"\n            >\n          </div>\n\n          <div>\n            <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">New Password</label>\n            <input\n              type=\"password\"\n              name=\"new_password\"\n              required\n              minlength=\"8\"\n              class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n              placeholder=\"Enter new password\"\n            >\n            <p class=\"mt-1 text-xs text-zinc-500 dark:text-zinc-400\">Must be at least 8 characters</p>\n          </div>\n\n          <div>\n            <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Confirm New Password</label>\n            <input\n              type=\"password\"\n              name=\"confirm_password\"\n              required\n              minlength=\"8\"\n              class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n              placeholder=\"Confirm new password\"\n            >\n          </div>\n\n          <div class=\"flex justify-end gap-x-3 pt-4 border-t border-zinc-950/5 dark:border-white/5\">\n            <button\n              type=\"button\"\n              onclick=\"closePasswordModal()\"\n              class=\"rounded-lg bg-white dark:bg-zinc-800 px-4 py-2.5 text-sm font-semibold text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 hover:bg-zinc-50 dark:hover:bg-zinc-700 transition-colors\"\n            >\n              Cancel\n            </button>\n            <button\n              type=\"submit\"\n              class=\"inline-flex items-center gap-x-2 rounded-lg bg-zinc-950 dark:bg-white px-4 py-2.5 text-sm font-semibold text-white dark:text-zinc-950 hover:bg-zinc-800 dark:hover:bg-zinc-100 transition-colors\"\n            >\n              <svg class=\"h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 13l4 4L19 7\"/>\n              </svg>\n              Update Password\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n\n    <script>\n      function showChangePasswordModal() {\n        document.getElementById('password-modal').classList.remove('hidden');\n      }\n\n      function closePasswordModal() {\n        document.getElementById('password-modal').classList.add('hidden');\n        document.getElementById('password-form').reset();\n      }\n\n      function toggle2FA() {\n        // TODO: Implement 2FA toggle\n        alert('Two-factor authentication setup coming soon!');\n      }\n\n      // Close modal on escape key\n      document.addEventListener('keydown', function(e) {\n        if (e.key === 'Escape' && !document.getElementById('password-modal').classList.contains('hidden')) {\n          closePasswordModal();\n        }\n      });\n\n      // Close modal on backdrop click\n      document.getElementById('password-modal').addEventListener('click', function(e) {\n        if (e.target === this) {\n          closePasswordModal();\n        }\n      });\n    </script>\n  `\n\n  const layoutData: AdminLayoutCatalystData = {\n    title: 'User Profile',\n    pageTitle: 'Profile',\n    currentPath: '/admin/profile',\n    user: data.user,\n    version: data.version,\n    content: pageContent\n  }\n\n  return renderAdminLayoutCatalyst(layoutData)\n}\n","export type AlertType = 'success' | 'error' | 'warning' | 'info'\n\nexport interface AlertData {\n  type: AlertType\n  title?: string\n  message: string\n  dismissible?: boolean\n  className?: string\n  icon?: boolean\n}\n\nexport function renderAlert(data: AlertData): string {\n  const typeClasses = {\n    success: 'bg-green-50 dark:bg-green-500/10 border border-green-600/20 dark:border-green-500/20',\n    error: 'bg-error/10 border border-red-600/20 dark:border-red-500/20',\n    warning: 'bg-amber-50 dark:bg-amber-500/10 border border-amber-600/20 dark:border-amber-500/20',\n    info: 'bg-blue-50 dark:bg-blue-500/10 border border-blue-600/20 dark:border-blue-500/20'\n  }\n\n  const iconClasses = {\n    success: 'text-green-600 dark:text-green-400',\n    error: 'text-red-600 dark:text-red-400',\n    warning: 'text-amber-600 dark:text-amber-400',\n    info: 'text-blue-600 dark:text-blue-400'\n  }\n\n  const textClasses = {\n    success: 'text-green-900 dark:text-green-300',\n    error: 'text-red-900 dark:text-red-300',\n    warning: 'text-amber-900 dark:text-amber-300',\n    info: 'text-blue-900 dark:text-blue-300'\n  }\n\n  const messageTextClasses = {\n    success: 'text-green-700 dark:text-green-400',\n    error: 'text-red-700 dark:text-red-400',\n    warning: 'text-amber-700 dark:text-amber-400',\n    info: 'text-blue-700 dark:text-blue-400'\n  }\n\n  const icons = {\n    success: `<path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clip-rule=\"evenodd\" />`,\n    error: `<path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clip-rule=\"evenodd\" />`,\n    warning: `<path fill-rule=\"evenodd\" d=\"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\" clip-rule=\"evenodd\" />`,\n    info: `<path fill-rule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z\" clip-rule=\"evenodd\" />`\n  }\n\n  return `\n    <div class=\"rounded-lg p-4 ${typeClasses[data.type]} ${data.className || ''}\" ${data.dismissible ? 'id=\"dismissible-alert\"' : ''}>\n      <div class=\"flex\">\n        ${data.icon !== false ? `\n          <div class=\"flex-shrink-0\">\n            <svg class=\"h-5 w-5 ${iconClasses[data.type]}\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n              ${icons[data.type]}\n            </svg>\n          </div>\n        ` : ''}\n        <div class=\"${data.icon !== false ? 'ml-3' : ''}\">\n          ${data.title ? `\n            <h3 class=\"text-sm font-semibold ${textClasses[data.type]}\">\n              ${data.title}\n            </h3>\n          ` : ''}\n          <div class=\"${data.title ? 'mt-1 text-sm' : 'text-sm'} ${messageTextClasses[data.type]}\">\n            <p>${data.message}</p>\n          </div>\n        </div>\n        ${data.dismissible ? `\n          <div class=\"ml-auto pl-3\">\n            <div class=\"-mx-1.5 -my-1.5\">\n              <button\n                type=\"button\"\n                class=\"inline-flex rounded-md p-1.5 ${iconClasses[data.type]} hover:bg-opacity-20 focus:outline-none focus:ring-2 focus:ring-offset-2\"\n                onclick=\"document.getElementById('dismissible-alert').remove()\"\n              >\n                <span class=\"sr-only\">Dismiss</span>\n                <svg class=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                  <path fill-rule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clip-rule=\"evenodd\" />\n                </svg>\n              </button>\n            </div>\n          </div>\n        ` : ''}\n      </div>\n    </div>\n  `\n}\n\nexport function renderSuccessAlert(message: string, title?: string): string {\n  return renderAlert({ type: 'success', message, title })\n}\n\nexport function renderErrorAlert(message: string, title?: string): string {\n  return renderAlert({ type: 'error', message, title })\n}\n\nexport function renderWarningAlert(message: string, title?: string): string {\n  return renderAlert({ type: 'warning', message, title })\n}\n\nexport function renderInfoAlert(message: string, title?: string): string {\n  return renderAlert({ type: 'info', message, title })\n}\n","import { renderAdminLayout, AdminLayoutData } from '../layouts/admin-layout-v2.template'\n\nexport interface ActivityLog {\n  id: string\n  user_id: string\n  action: string\n  resource_type?: string\n  resource_id?: string\n  details?: any\n  ip_address?: string\n  user_agent?: string\n  created_at: number\n  user_email?: string\n  user_name?: string\n}\n\nexport interface ActivityLogsPageData {\n  logs: ActivityLog[]\n  pagination: {\n    page: number\n    limit: number\n    total: number\n    pages: number\n  }\n  filters: {\n    user_id?: string\n    action?: string\n    resource_type?: string\n    date_from?: string\n    date_to?: string\n  }\n  user?: {\n    name: string\n    email: string\n    role: string\n  }\n}\n\nexport function renderActivityLogsPage(data: ActivityLogsPageData): string {\n  const pageContent = `\n    <div class=\"w-full px-4 sm:px-6 lg:px-8 py-6\">\n      <!-- Header -->\n      <div class=\"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6\">\n        <div>\n          <h1 class=\"text-2xl font-semibold text-white\">Activity Logs</h1>\n          <p class=\"mt-2 text-sm text-gray-300\">Monitor user actions and system activity</p>\n        </div>\n      </div>\n\n      <!-- Breadcrumb -->\n      <nav class=\"flex mb-6\" aria-label=\"Breadcrumb\">\n        <ol class=\"flex items-center space-x-3\">\n          <li>\n            <a href=\"/admin\" class=\"text-gray-300 hover:text-white transition-colors\">\n              <svg class=\"h-5 w-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path d=\"M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z\"/>\n              </svg>\n            </a>\n          </li>\n          <li class=\"flex items-center\">\n            <svg class=\"h-5 w-5 text-gray-400 mx-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path fill-rule=\"evenodd\" d=\"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z\" clip-rule=\"evenodd\"/>\n            </svg>\n            <span class=\"text-sm font-medium text-gray-200\">Activity Logs</span>\n          </li>\n        </ol>\n      </nav>\n\n      <!-- Filters -->\n      <div class=\"backdrop-blur-xl bg-white/10 rounded-xl border border-white/20 shadow-2xl p-6 mb-6\">\n        <h3 class=\"text-lg font-semibold text-white mb-4\">Filters</h3>\n        \n        <form method=\"GET\" action=\"/admin/activity-logs\" class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n          <div>\n            <label class=\"block text-sm font-medium text-gray-300 mb-2\">Action</label>\n            <select name=\"action\" class=\"w-full px-3 py-2 bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl text-white focus:outline-none focus:bg-white/10 focus:border-white/30\">\n              <option value=\"\">All Actions</option>\n              <option value=\"user.login\" ${data.filters.action === 'user.login' ? 'selected' : ''}>User Login</option>\n              <option value=\"user.logout\" ${data.filters.action === 'user.logout' ? 'selected' : ''}>User Logout</option>\n              <option value=\"user.invite_sent\" ${data.filters.action === 'user.invite_sent' ? 'selected' : ''}>User Invited</option>\n              <option value=\"user.invitation_accepted\" ${data.filters.action === 'user.invitation_accepted' ? 'selected' : ''}>Invitation Accepted</option>\n              <option value=\"profile.update\" ${data.filters.action === 'profile.update' ? 'selected' : ''}>Profile Update</option>\n              <option value=\"profile.password_change\" ${data.filters.action === 'profile.password_change' ? 'selected' : ''}>Password Change</option>\n              <option value=\"content.create\" ${data.filters.action === 'content.create' ? 'selected' : ''}>Content Created</option>\n              <option value=\"content.update\" ${data.filters.action === 'content.update' ? 'selected' : ''}>Content Updated</option>\n              <option value=\"content.delete\" ${data.filters.action === 'content.delete' ? 'selected' : ''}>Content Deleted</option>\n              <option value=\"collection.create\" ${data.filters.action === 'collection.create' ? 'selected' : ''}>Collection Created</option>\n              <option value=\"collection.update\" ${data.filters.action === 'collection.update' ? 'selected' : ''}>Collection Updated</option>\n            </select>\n          </div>\n\n          <div>\n            <label class=\"block text-sm font-medium text-gray-300 mb-2\">Resource Type</label>\n            <select name=\"resource_type\" class=\"w-full px-3 py-2 bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl text-white focus:outline-none focus:bg-white/10 focus:border-white/30\">\n              <option value=\"\">All Resources</option>\n              <option value=\"users\" ${data.filters.resource_type === 'users' ? 'selected' : ''}>Users</option>\n              <option value=\"content\" ${data.filters.resource_type === 'content' ? 'selected' : ''}>Content</option>\n              <option value=\"collections\" ${data.filters.resource_type === 'collections' ? 'selected' : ''}>Collections</option>\n              <option value=\"media\" ${data.filters.resource_type === 'media' ? 'selected' : ''}>Media</option>\n              <option value=\"settings\" ${data.filters.resource_type === 'settings' ? 'selected' : ''}>Settings</option>\n            </select>\n          </div>\n\n          <div>\n            <label class=\"block text-sm font-medium text-gray-300 mb-2\">From Date</label>\n            <input \n              type=\"date\" \n              name=\"date_from\" \n              value=\"${data.filters.date_from || ''}\"\n              class=\"w-full px-3 py-2 bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl text-white focus:outline-none focus:bg-white/10 focus:border-white/30\"\n            >\n          </div>\n\n          <div>\n            <label class=\"block text-sm font-medium text-gray-300 mb-2\">To Date</label>\n            <input \n              type=\"date\" \n              name=\"date_to\" \n              value=\"${data.filters.date_to || ''}\"\n              class=\"w-full px-3 py-2 bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl text-white focus:outline-none focus:bg-white/10 focus:border-white/30\"\n            >\n          </div>\n\n          <div class=\"md:col-span-2 lg:col-span-4 flex gap-3\">\n            <button \n              type=\"submit\"\n              class=\"px-6 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-medium rounded-xl hover:from-blue-700 hover:to-purple-700 transition-all\"\n            >\n              Apply Filters\n            </button>\n            <a \n              href=\"/admin/activity-logs\"\n              class=\"px-6 py-2 bg-white/10 text-white rounded-xl border border-white/20 hover:bg-white/20 transition-all\"\n            >\n              Clear Filters\n            </a>\n          </div>\n        </form>\n      </div>\n\n      <!-- Activity Logs Table -->\n      <div class=\"backdrop-blur-xl bg-white/10 rounded-xl border border-white/20 shadow-2xl overflow-hidden\">\n        <div class=\"relative px-6 py-4 border-b border-white/10\">\n          <div class=\"absolute inset-0 bg-gradient-to-r from-blue-600/10 via-purple-600/10 to-pink-600/10\"></div>\n          <div class=\"relative flex items-center justify-between\">\n            <h2 class=\"text-xl font-semibold text-white\">Recent Activity</h2>\n            <div class=\"text-sm text-gray-300\">\n              Showing ${data.logs.length} of ${data.pagination.total} logs\n            </div>\n          </div>\n        </div>\n\n        <div class=\"overflow-x-auto\">\n          <table class=\"w-full\">\n            <thead class=\"bg-white/5\">\n              <tr>\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider\">Timestamp</th>\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider\">User</th>\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider\">Action</th>\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider\">Resource</th>\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider\">IP Address</th>\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider\">Details</th>\n              </tr>\n            </thead>\n            <tbody class=\"divide-y divide-white/10\">\n              ${data.logs.map(log => `\n                <tr class=\"hover:bg-white/5 transition-colors\">\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-300\">\n                    ${new Date(log.created_at).toLocaleString()}\n                  </td>\n                  <td class=\"px-6 py-4 whitespace-nowrap\">\n                    <div class=\"text-sm text-white\">${log.user_name || 'Unknown'}</div>\n                    <div class=\"text-xs text-gray-400\">${log.user_email || 'N/A'}</div>\n                  </td>\n                  <td class=\"px-6 py-4 whitespace-nowrap\">\n                    <span class=\"inline-flex px-2 py-1 text-xs font-medium rounded-full ${getActionBadgeClass(log.action)}\">\n                      ${formatAction(log.action)}\n                    </span>\n                  </td>\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-300\">\n                    ${log.resource_type ? `\n                      <div class=\"text-white\">${log.resource_type}</div>\n                      ${log.resource_id ? `<div class=\"text-xs text-gray-400\">${log.resource_id}</div>` : ''}\n                    ` : 'N/A'}\n                  </td>\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-300\">\n                    ${log.ip_address || 'N/A'}\n                  </td>\n                  <td class=\"px-6 py-4 text-sm text-gray-300\">\n                    ${log.details ? `\n                      <details class=\"cursor-pointer\">\n                        <summary class=\"text-blue-400 hover:text-blue-300\">View Details</summary>\n                        <pre class=\"mt-2 text-xs bg-black/20 p-2 rounded overflow-x-auto\">${JSON.stringify(log.details, null, 2)}</pre>\n                      </details>\n                    ` : 'N/A'}\n                  </td>\n                </tr>\n              `).join('')}\n            </tbody>\n          </table>\n        </div>\n\n        ${data.logs.length === 0 ? `\n          <div class=\"text-center py-12\">\n            <svg class=\"mx-auto h-12 w-12 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"/>\n            </svg>\n            <h3 class=\"mt-2 text-sm font-medium text-gray-300\">No activity logs found</h3>\n            <p class=\"mt-1 text-sm text-gray-500\">Try adjusting your filters or check back later.</p>\n          </div>\n        ` : ''}\n\n        <!-- Pagination -->\n        ${data.pagination.pages > 1 ? `\n          <div class=\"px-6 py-4 border-t border-white/10 flex items-center justify-between\">\n            <div class=\"text-sm text-gray-300\">\n              Page ${data.pagination.page} of ${data.pagination.pages} (${data.pagination.total} total logs)\n            </div>\n            <div class=\"flex space-x-2\">\n              ${data.pagination.page > 1 ? `\n                <a href=\"?page=${data.pagination.page - 1}&${new URLSearchParams(data.filters as Record<string, string>).toString()}\" \n                   class=\"px-3 py-1 bg-white/10 text-white rounded-lg border border-white/20 hover:bg-white/20 transition-all\">\n                  Previous\n                </a>\n              ` : ''}\n              ${data.pagination.page < data.pagination.pages ? `\n                <a href=\"?page=${data.pagination.page + 1}&${new URLSearchParams(data.filters as Record<string, string>).toString()}\" \n                   class=\"px-3 py-1 bg-white/10 text-white rounded-lg border border-white/20 hover:bg-white/20 transition-all\">\n                  Next\n                </a>\n              ` : ''}\n            </div>\n          </div>\n        ` : ''}\n      </div>\n    </div>\n  `\n\n  const layoutData: AdminLayoutData = {\n    title: 'Activity Logs',\n    pageTitle: 'Activity Logs',\n    currentPath: '/admin/activity-logs',\n    user: data.user,\n    content: pageContent\n  }\n\n  return renderAdminLayout(layoutData)\n}\n\nfunction getActionBadgeClass(action: string): string {\n  if (action.includes('login') || action.includes('logout')) {\n    return 'bg-blue-500/20 text-blue-300'\n  } else if (action.includes('create') || action.includes('invite')) {\n    return 'bg-green-500/20 text-green-300'\n  } else if (action.includes('update') || action.includes('change')) {\n    return 'bg-yellow-500/20 text-yellow-300'\n  } else if (action.includes('delete') || action.includes('cancel')) {\n    return 'bg-red-500/20 text-red-300'\n  } else {\n    return 'bg-gray-500/20 text-gray-300'\n  }\n}\n\nfunction formatAction(action: string): string {\n  // Convert action from dot notation to readable format\n  return action\n    .split('.')\n    .map(part => part.replace(/_/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase()))\n    .join(' - ')\n}","import { renderAdminLayoutCatalyst, AdminLayoutCatalystData } from '../layouts/admin-layout-catalyst.template'\nimport { renderAlert } from '../alert.template'\nimport { renderConfirmationDialog, getConfirmationDialogScript } from '../components/confirmation-dialog.template'\nimport { escapeHtml } from '../../utils/sanitize'\n\nexport interface UserProfileData {\n  displayName?: string\n  bio?: string\n  company?: string\n  jobTitle?: string\n  website?: string\n  location?: string\n  dateOfBirth?: number\n}\n\nexport interface UserEditData {\n  id: string\n  email: string\n  username: string\n  firstName: string\n  lastName: string\n  phone?: string\n  avatarUrl?: string\n  role: string\n  isActive: boolean\n  emailVerified: boolean\n  twoFactorEnabled: boolean\n  createdAt: number\n  lastLoginAt?: number\n  profile?: UserProfileData\n}\n\nexport interface UserEditPageData {\n  userToEdit: UserEditData\n  roles: Array<{ value: string; label: string }>\n  error?: string\n  success?: string\n  user?: {\n    name: string\n    email: string\n    role: string\n  }\n}\n\nexport function renderUserEditPage(data: UserEditPageData): string {\n  const pageContent = `\n    <div>\n      <!-- Header -->\n      <div class=\"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6\">\n        <div>\n          <div class=\"flex items-center gap-3 mb-2\">\n            <a href=\"/admin/users\" class=\"text-zinc-500 dark:text-zinc-400 hover:text-zinc-950 dark:hover:text-white transition-colors\">\n              <svg class=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 19l-7-7 7-7\"/>\n              </svg>\n            </a>\n            <h1 class=\"text-2xl/8 font-semibold text-zinc-950 dark:text-white sm:text-xl/8\">Edit User</h1>\n          </div>\n          <p class=\"mt-2 text-sm/6 text-zinc-500 dark:text-zinc-400\">Update user account and permissions</p>\n        </div>\n        <div class=\"mt-4 sm:mt-0 sm:ml-16 sm:flex-none flex space-x-3\">\n          <button\n            type=\"submit\"\n            form=\"user-edit-form\"\n            class=\"inline-flex items-center justify-center rounded-lg bg-zinc-950 dark:bg-white px-3.5 py-2.5 text-sm font-semibold text-white dark:text-zinc-950 hover:bg-zinc-800 dark:hover:bg-zinc-100 transition-colors shadow-sm\"\n          >\n            <svg class=\"-ml-0.5 mr-1.5 h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 13l4 4L19 7\"/>\n            </svg>\n            Save Changes\n          </button>\n          <a\n            href=\"/admin/users\"\n            class=\"inline-flex items-center justify-center rounded-lg bg-white dark:bg-zinc-800 px-3.5 py-2.5 text-sm font-semibold text-zinc-950 dark:text-white ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 hover:bg-zinc-50 dark:hover:bg-zinc-700 transition-colors shadow-sm\"\n          >\n            Cancel\n          </a>\n        </div>\n      </div>\n\n      <!-- Alert Messages -->\n      <div id=\"form-messages\">\n        ${data.error ? renderAlert({ type: 'error', message: data.error, dismissible: true }) : ''}\n        ${data.success ? renderAlert({ type: 'success', message: data.success, dismissible: true }) : ''}\n      </div>\n\n      <!-- User Edit Form -->\n      <div class=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        <!-- Main Form -->\n        <div class=\"lg:col-span-2\">\n          <div class=\"rounded-xl bg-white dark:bg-zinc-900 shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10 p-8\">\n            <form id=\"user-edit-form\" hx-put=\"/admin/users/${data.userToEdit.id}\" hx-target=\"#form-messages\">\n\n              <!-- Basic Information -->\n              <div class=\"mb-8\">\n                <h3 class=\"text-base font-semibold text-zinc-950 dark:text-white mb-4\">Basic Information</h3>\n                <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  <div>\n                    <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">First Name</label>\n                    <input\n                      type=\"text\"\n                      name=\"first_name\"\n                      value=\"${escapeHtml(data.userToEdit.firstName || '')}\"\n                      required\n                      class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                    />\n                  </div>\n\n                  <div>\n                    <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Last Name</label>\n                    <input\n                      type=\"text\"\n                      name=\"last_name\"\n                      value=\"${escapeHtml(data.userToEdit.lastName || '')}\"\n                      required\n                      class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                    />\n                  </div>\n\n                  <div>\n                    <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Username</label>\n                    <input\n                      type=\"text\"\n                      name=\"username\"\n                      value=\"${escapeHtml(data.userToEdit.username || '')}\"\n                      required\n                      class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                    />\n                  </div>\n\n                  <div>\n                    <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Email</label>\n                    <input\n                      type=\"email\"\n                      name=\"email\"\n                      value=\"${escapeHtml(data.userToEdit.email || '')}\"\n                      required\n                      class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                    />\n                  </div>\n\n                  <div>\n                    <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Phone</label>\n                    <input\n                      type=\"tel\"\n                      name=\"phone\"\n                      value=\"${escapeHtml(data.userToEdit.phone || '')}\"\n                      class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                    />\n                  </div>\n\n                  <div>\n                    <label for=\"role\" class=\"block text-sm/6 font-medium text-zinc-950 dark:text-white\">Role</label>\n                    <div class=\"mt-2 grid grid-cols-1\">\n                      <select\n                        id=\"role\"\n                        name=\"role\"\n                        class=\"col-start-1 row-start-1 w-full appearance-none rounded-md bg-white/5 dark:bg-white/5 py-1.5 pl-3 pr-8 text-base text-zinc-950 dark:text-white outline outline-1 -outline-offset-1 outline-zinc-500/30 dark:outline-zinc-400/30 *:bg-white dark:*:bg-zinc-800 focus-visible:outline focus-visible:outline-2 focus-visible:-outline-offset-2 focus-visible:outline-zinc-500 dark:focus-visible:outline-zinc-400 sm:text-sm/6\"\n                      >\n                        ${data.roles.map(role => `\n                          <option value=\"${escapeHtml(role.value)}\" ${data.userToEdit.role === role.value ? 'selected' : ''}>${escapeHtml(role.label)}</option>\n                        `).join('')}\n                      </select>\n                      <svg viewBox=\"0 0 16 16\" fill=\"currentColor\" data-slot=\"icon\" aria-hidden=\"true\" class=\"pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-zinc-600 dark:text-zinc-400 sm:size-4\">\n                        <path d=\"M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z\" clip-rule=\"evenodd\" fill-rule=\"evenodd\" />\n                      </svg>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <!-- Profile Information -->\n              <div class=\"mb-8\">\n                <h3 class=\"text-base font-semibold text-zinc-950 dark:text-white mb-4\">Profile Information</h3>\n                <p class=\"text-sm text-zinc-500 dark:text-zinc-400 mb-4\">Extended profile data for this user</p>\n                <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  <div>\n                    <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Display Name</label>\n                    <input\n                      type=\"text\"\n                      name=\"profile_display_name\"\n                      value=\"${escapeHtml(data.userToEdit.profile?.displayName || '')}\"\n                      placeholder=\"Public display name\"\n                      class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                    />\n                  </div>\n\n                  <div>\n                    <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Company</label>\n                    <input\n                      type=\"text\"\n                      name=\"profile_company\"\n                      value=\"${escapeHtml(data.userToEdit.profile?.company || '')}\"\n                      placeholder=\"Company or organization\"\n                      class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                    />\n                  </div>\n\n                  <div>\n                    <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Job Title</label>\n                    <input\n                      type=\"text\"\n                      name=\"profile_job_title\"\n                      value=\"${escapeHtml(data.userToEdit.profile?.jobTitle || '')}\"\n                      placeholder=\"Job title or role\"\n                      class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                    />\n                  </div>\n\n                  <div>\n                    <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Website</label>\n                    <input\n                      type=\"url\"\n                      name=\"profile_website\"\n                      value=\"${escapeHtml(data.userToEdit.profile?.website || '')}\"\n                      placeholder=\"https://example.com\"\n                      class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                    />\n                  </div>\n\n                  <div>\n                    <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Location</label>\n                    <input\n                      type=\"text\"\n                      name=\"profile_location\"\n                      value=\"${escapeHtml(data.userToEdit.profile?.location || '')}\"\n                      placeholder=\"City, Country\"\n                      class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                    />\n                  </div>\n\n                  <div>\n                    <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Date of Birth</label>\n                    <input\n                      type=\"date\"\n                      name=\"profile_date_of_birth\"\n                      value=\"${data.userToEdit.profile?.dateOfBirth ? new Date(data.userToEdit.profile.dateOfBirth).toISOString().split('T')[0] : ''}\"\n                      class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                    />\n                  </div>\n                </div>\n\n                <div class=\"mt-6\">\n                  <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Bio</label>\n                  <textarea\n                    name=\"profile_bio\"\n                    rows=\"3\"\n                    placeholder=\"Short bio or description\"\n                    class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                  >${escapeHtml(data.userToEdit.profile?.bio || '')}</textarea>\n                </div>\n              </div>\n\n              <!-- Account Status -->\n              <div class=\"mb-8\">\n                <h3 class=\"text-base font-semibold text-zinc-950 dark:text-white mb-4\">Account Status</h3>\n                <div class=\"space-y-4\">\n                  <div class=\"flex gap-3\">\n                    <div class=\"flex h-6 shrink-0 items-center\">\n                      <div class=\"group grid size-4 grid-cols-1\">\n                        <input\n                          type=\"checkbox\"\n                          id=\"is_active\"\n                          name=\"is_active\"\n                          value=\"1\"\n                          ${data.userToEdit.isActive ? 'checked' : ''}\n                          class=\"col-start-1 row-start-1 appearance-none rounded border border-zinc-950/10 dark:border-white/10 bg-white dark:bg-white/5 checked:border-indigo-500 checked:bg-indigo-500 indeterminate:border-indigo-500 indeterminate:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 disabled:border-zinc-950/5 dark:disabled:border-white/5 disabled:bg-zinc-950/10 dark:disabled:bg-white/10 disabled:checked:bg-zinc-950/10 dark:disabled:checked:bg-white/10 forced-colors:appearance-auto\"\n                        />\n                        <svg viewBox=\"0 0 14 14\" fill=\"none\" class=\"pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-[:disabled]:stroke-zinc-950/25 dark:group-has-[:disabled]:stroke-white/25\">\n                          <path d=\"M3 8L6 11L11 3.5\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:checked]:opacity-100\" />\n                          <path d=\"M3 7H11\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:indeterminate]:opacity-100\" />\n                        </svg>\n                      </div>\n                    </div>\n                    <div class=\"text-sm/6\">\n                      <label for=\"is_active\" class=\"font-medium text-zinc-950 dark:text-white\">Account Active</label>\n                      <p class=\"text-zinc-500 dark:text-zinc-400\">User can sign in and access the system</p>\n                    </div>\n                  </div>\n\n                  <div class=\"flex gap-3\">\n                    <div class=\"flex h-6 shrink-0 items-center\">\n                      <div class=\"group grid size-4 grid-cols-1\">\n                        <input\n                          type=\"checkbox\"\n                          id=\"email_verified\"\n                          name=\"email_verified\"\n                          value=\"1\"\n                          ${data.userToEdit.emailVerified ? 'checked' : ''}\n                          class=\"col-start-1 row-start-1 appearance-none rounded border border-zinc-950/10 dark:border-white/10 bg-white dark:bg-white/5 checked:border-indigo-500 checked:bg-indigo-500 indeterminate:border-indigo-500 indeterminate:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 disabled:border-zinc-950/5 dark:disabled:border-white/5 disabled:bg-zinc-950/10 dark:disabled:bg-white/10 disabled:checked:bg-zinc-950/10 dark:disabled:checked:bg-white/10 forced-colors:appearance-auto\"\n                        />\n                        <svg viewBox=\"0 0 14 14\" fill=\"none\" class=\"pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-[:disabled]:stroke-zinc-950/25 dark:group-has-[:disabled]:stroke-white/25\">\n                          <path d=\"M3 8L6 11L11 3.5\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:checked]:opacity-100\" />\n                          <path d=\"M3 7H11\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:indeterminate]:opacity-100\" />\n                        </svg>\n                      </div>\n                    </div>\n                    <div class=\"text-sm/6\">\n                      <label for=\"email_verified\" class=\"font-medium text-zinc-950 dark:text-white\">Email Verified</label>\n                      <p class=\"text-zinc-500 dark:text-zinc-400\">User has verified their email address</p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n            </form>\n          </div>\n        </div>\n\n        <!-- Sidebar -->\n        <div class=\"lg:col-span-1\">\n          <!-- User Stats -->\n          <div class=\"rounded-xl bg-white dark:bg-zinc-900 shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10 p-6 mb-6\">\n            <h3 class=\"text-base font-semibold text-zinc-950 dark:text-white mb-4\">User Details</h3>\n            <dl class=\"space-y-4 text-sm\">\n              <div>\n                <dt class=\"text-zinc-500 dark:text-zinc-400\">User ID</dt>\n                <dd class=\"mt-1 text-zinc-950 dark:text-white font-mono text-xs\">${data.userToEdit.id}</dd>\n              </div>\n              <div>\n                <dt class=\"text-zinc-500 dark:text-zinc-400\">Created</dt>\n                <dd class=\"mt-1 text-zinc-950 dark:text-white\">${new Date(data.userToEdit.createdAt).toLocaleDateString()}</dd>\n              </div>\n              ${data.userToEdit.lastLoginAt ? `\n                <div>\n                  <dt class=\"text-zinc-500 dark:text-zinc-400\">Last Login</dt>\n                  <dd class=\"mt-1 text-zinc-950 dark:text-white\">${new Date(data.userToEdit.lastLoginAt).toLocaleDateString()}</dd>\n                </div>\n              ` : ''}\n              <div>\n                <dt class=\"text-zinc-500 dark:text-zinc-400\">Status</dt>\n                <dd class=\"mt-1\">\n                  ${data.userToEdit.isActive\n                    ? '<span class=\"inline-flex items-center px-2 py-0.5 rounded-md text-xs font-medium bg-lime-50 dark:bg-lime-500/10 text-lime-700 dark:text-lime-300 ring-1 ring-inset ring-lime-700/10 dark:ring-lime-400/20\">Active</span>'\n                    : '<span class=\"inline-flex items-center px-2 py-0.5 rounded-md text-xs font-medium bg-red-50 dark:bg-red-500/10 text-red-700 dark:text-red-400 ring-1 ring-inset ring-red-700/10 dark:ring-red-500/20\">Inactive</span>'\n                  }\n                </dd>\n              </div>\n              ${data.userToEdit.twoFactorEnabled ? `\n                <div>\n                  <dt class=\"text-zinc-500 dark:text-zinc-400\">Security</dt>\n                  <dd class=\"mt-1\">\n                    <span class=\"inline-flex items-center px-2 py-0.5 rounded-md text-xs font-medium bg-blue-50 dark:bg-blue-500/10 text-blue-700 dark:text-blue-400 ring-1 ring-inset ring-blue-700/10 dark:ring-blue-500/20\">2FA Enabled</span>\n                  </dd>\n                </div>\n              ` : ''}\n            </dl>\n          </div>\n\n          <!-- Danger Zone -->\n          <div class=\"rounded-xl bg-red-50 dark:bg-red-500/10 shadow-sm ring-1 ring-red-600/20 dark:ring-red-500/20 p-6\">\n            <h3 class=\"text-base font-semibold text-red-900 dark:text-red-300 mb-2\">Danger Zone</h3>\n            <p class=\"text-sm text-red-700 dark:text-red-400 mb-4\">Irreversible and destructive actions</p>\n\n            <div class=\"flex gap-3 mb-4\">\n              <div class=\"flex h-6 shrink-0 items-center\">\n                <div class=\"group grid size-4 grid-cols-1\">\n                  <input\n                    type=\"checkbox\"\n                    id=\"hard-delete-checkbox\"\n                    class=\"col-start-1 row-start-1 appearance-none rounded border border-red-300 dark:border-red-700 bg-white dark:bg-red-950/50 checked:border-red-600 checked:bg-red-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-600 disabled:border-red-200 dark:disabled:border-red-900 disabled:bg-red-50 dark:disabled:bg-red-950/30 disabled:checked:bg-red-300 dark:disabled:checked:bg-red-900 forced-colors:appearance-auto\"\n                  />\n                  <svg viewBox=\"0 0 14 14\" fill=\"none\" class=\"pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-[:disabled]:stroke-red-950/25 dark:group-has-[:disabled]:stroke-white/25\">\n                    <path d=\"M3 8L6 11L11 3.5\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:checked]:opacity-100\" />\n                    <path d=\"M3 7H11\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:indeterminate]:opacity-100\" />\n                  </svg>\n                </div>\n              </div>\n              <div class=\"text-sm/6\">\n                <label for=\"hard-delete-checkbox\" class=\"font-medium text-red-900 dark:text-red-300 cursor-pointer\">Hard Delete (Permanent)</label>\n                <p class=\"text-red-700 dark:text-red-400\">Permanently remove from database. Unchecked performs soft delete (deactivate only).</p>\n              </div>\n            </div>\n\n            <button\n              onclick=\"deleteUser('${data.userToEdit.id}')\"\n              class=\"w-full inline-flex items-center justify-center rounded-lg bg-red-600 px-3 py-2 text-sm font-semibold text-white hover:bg-red-700 transition-colors\"\n            >\n              <svg class=\"-ml-0.5 mr-1.5 h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"/>\n              </svg>\n              Delete User\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <script>\n      let userIdToDelete = null;\n\n      function deleteUser(userId) {\n        userIdToDelete = userId;\n        showConfirmDialog('delete-user-confirm');\n      }\n\n      function performDeleteUser() {\n        if (!userIdToDelete) return;\n\n        const checkbox = document.getElementById('hard-delete-checkbox');\n        const hardDelete = checkbox ? checkbox.checked : false;\n\n        fetch(\\`/admin/users/\\${userIdToDelete}\\`, {\n          method: 'DELETE',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({ hardDelete })\n        })\n        .then(response => response.json())\n        .then(data => {\n          if (data.success) {\n            // Add a small delay to ensure database transaction completes\n            // and add cache busting to force refresh\n            setTimeout(() => {\n              window.location.href = '/admin/users?_t=' + Date.now()\n            }, 300)\n          } else {\n            alert('Error deleting user: ' + (data.error || 'Unknown error'))\n          }\n        })\n        .catch(error => {\n          console.error('Error:', error)\n          alert('Error deleting user')\n        })\n        .finally(() => {\n          userIdToDelete = null;\n        });\n      }\n    </script>\n\n    <!-- Confirmation Dialogs -->\n    ${renderConfirmationDialog({\n      id: 'delete-user-confirm',\n      title: 'Delete User',\n      message: 'Are you sure you want to delete this user? Check the \"Hard Delete\" option to permanently remove all data from the database. This action cannot be undone!',\n      confirmText: 'Delete',\n      cancelText: 'Cancel',\n      iconColor: 'red',\n      confirmClass: 'bg-red-500 hover:bg-red-400',\n      onConfirm: 'performDeleteUser()'\n    })}\n\n    ${getConfirmationDialogScript()}\n  `\n\n  const layoutData: AdminLayoutCatalystData = {\n    title: 'Edit User',\n    pageTitle: `Edit User - ${data.userToEdit.firstName} ${data.userToEdit.lastName}`,\n    currentPath: '/admin/users',\n    user: data.user,\n    content: pageContent\n  }\n\n  return renderAdminLayoutCatalyst(layoutData)\n}\n","export interface ConfirmationDialogOptions {\n  id: string\n  title: string\n  message: string\n  confirmText?: string\n  cancelText?: string\n  confirmClass?: string\n  iconColor?: 'red' | 'yellow' | 'blue'\n  onConfirm?: string // JavaScript code to execute on confirm\n}\n\nexport function renderConfirmationDialog(options: ConfirmationDialogOptions): string {\n  const {\n    id,\n    title,\n    message,\n    confirmText = 'Confirm',\n    cancelText = 'Cancel',\n    confirmClass = 'bg-red-500 hover:bg-red-400',\n    iconColor = 'red',\n    onConfirm = ''\n  } = options\n\n  const iconColorClasses = {\n    red: 'bg-red-500/10 text-red-400',\n    yellow: 'bg-yellow-500/10 text-yellow-400',\n    blue: 'bg-blue-500/10 text-blue-400'\n  }\n\n  return `\n    <el-dialog>\n      <dialog\n        id=\"${id}\"\n        aria-labelledby=\"${id}-title\"\n        class=\"fixed inset-0 m-0 size-auto max-h-none max-w-none overflow-y-auto bg-transparent p-0 backdrop:bg-transparent\"\n      >\n        <el-dialog-backdrop class=\"fixed inset-0 bg-gray-900/50 transition-opacity data-[closed]:opacity-0 data-[enter]:duration-300 data-[leave]:duration-200 data-[enter]:ease-out data-[leave]:ease-in\"></el-dialog-backdrop>\n\n        <div tabindex=\"0\" class=\"flex min-h-full items-end justify-center p-4 text-center focus:outline focus:outline-0 sm:items-center sm:p-0\">\n          <el-dialog-panel class=\"relative transform overflow-hidden rounded-lg bg-gray-800 px-4 pb-4 pt-5 text-left shadow-xl outline outline-1 -outline-offset-1 outline-white/10 transition-all data-[closed]:translate-y-4 data-[closed]:opacity-0 data-[enter]:duration-300 data-[leave]:duration-200 data-[enter]:ease-out data-[leave]:ease-in sm:my-8 sm:w-full sm:max-w-lg sm:p-6 data-[closed]:sm:translate-y-0 data-[closed]:sm:scale-95\">\n            <div class=\"sm:flex sm:items-start\">\n              <div class=\"mx-auto flex size-12 shrink-0 items-center justify-center rounded-full ${iconColorClasses[iconColor]} sm:mx-0 sm:size-10\">\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\" data-slot=\"icon\" aria-hidden=\"true\" class=\"size-6\">\n                  <path d=\"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z\" stroke-linecap=\"round\" stroke-linejoin=\"round\" />\n                </svg>\n              </div>\n              <div class=\"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left\">\n                <h3 id=\"${id}-title\" class=\"text-base font-semibold text-white\">${title}</h3>\n                <div class=\"mt-2\">\n                  <p class=\"text-sm text-gray-400\">${message}</p>\n                </div>\n              </div>\n            </div>\n            <div class=\"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse\">\n              <button\n                type=\"button\"\n                onclick=\"${onConfirm}; document.getElementById('${id}').close()\"\n                command=\"close\"\n                commandfor=\"${id}\"\n                class=\"confirm-button inline-flex w-full justify-center rounded-md ${confirmClass} px-3 py-2 text-sm font-semibold text-white sm:ml-3 sm:w-auto\"\n              >\n                ${confirmText}\n              </button>\n              <button\n                type=\"button\"\n                command=\"close\"\n                commandfor=\"${id}\"\n                class=\"mt-3 inline-flex w-full justify-center rounded-md bg-white/10 px-3 py-2 text-sm font-semibold text-white ring-1 ring-inset ring-white/5 hover:bg-white/20 sm:mt-0 sm:w-auto\"\n              >\n                ${cancelText}\n              </button>\n            </div>\n          </el-dialog-panel>\n        </div>\n      </dialog>\n    </el-dialog>\n  `\n}\n\n/**\n * Helper function to show a confirmation dialog programmatically\n * Usage in templates: Add this script and call showConfirmDialog()\n */\nexport function getConfirmationDialogScript(): string {\n  return `\n    <script src=\"https://cdn.jsdelivr.net/npm/@tailwindplus/elements@1\" type=\"module\"></script>\n    <script>\n      function showConfirmDialog(dialogId) {\n        const dialog = document.getElementById(dialogId);\n        if (dialog) {\n          dialog.showModal();\n        }\n      }\n    </script>\n  `\n}\n","import { renderAdminLayoutCatalyst, AdminLayoutCatalystData } from '../layouts/admin-layout-catalyst.template'\nimport { renderAlert } from '../alert.template'\n\nexport interface UserNewPageData {\n  roles: Array<{ value: string; label: string }>\n  error?: string\n  success?: string\n  user?: {\n    name: string\n    email: string\n    role: string\n  }\n}\n\nexport function renderUserNewPage(data: UserNewPageData): string {\n  const pageContent = `\n    <div>\n      <!-- Header -->\n      <div class=\"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6\">\n        <div>\n          <div class=\"flex items-center gap-3 mb-2\">\n            <a href=\"/admin/users\" class=\"text-zinc-500 dark:text-zinc-400 hover:text-zinc-950 dark:hover:text-white transition-colors\">\n              <svg class=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 19l-7-7 7-7\"/>\n              </svg>\n            </a>\n            <h1 class=\"text-2xl/8 font-semibold text-zinc-950 dark:text-white sm:text-xl/8\">Create New User</h1>\n          </div>\n          <p class=\"mt-2 text-sm/6 text-zinc-500 dark:text-zinc-400\">Add a new user account to the system</p>\n        </div>\n        <div class=\"mt-4 sm:mt-0 sm:ml-16 sm:flex-none flex space-x-3\">\n          <button\n            type=\"submit\"\n            form=\"user-new-form\"\n            class=\"inline-flex items-center justify-center rounded-lg bg-zinc-950 dark:bg-white px-3.5 py-2.5 text-sm font-semibold text-white dark:text-zinc-950 hover:bg-zinc-800 dark:hover:bg-zinc-100 transition-colors shadow-sm\"\n          >\n            <svg class=\"-ml-0.5 mr-1.5 h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n              <path d=\"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z\" />\n            </svg>\n            Create User\n          </button>\n          <a\n            href=\"/admin/users\"\n            class=\"inline-flex items-center justify-center rounded-lg bg-white dark:bg-zinc-800 px-3.5 py-2.5 text-sm font-semibold text-zinc-950 dark:text-white ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 hover:bg-zinc-50 dark:hover:bg-zinc-700 transition-colors shadow-sm\"\n          >\n            Cancel\n          </a>\n        </div>\n      </div>\n\n      <!-- Alert Messages -->\n      <div id=\"form-messages\">\n        ${data.error ? renderAlert({ type: 'error', message: data.error, dismissible: true }) : ''}\n        ${data.success ? renderAlert({ type: 'success', message: data.success, dismissible: true }) : ''}\n      </div>\n\n      <!-- User New Form -->\n      <div class=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        <!-- Main Form -->\n        <div class=\"lg:col-span-2\">\n          <div class=\"rounded-xl bg-white dark:bg-zinc-900 shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10 p-8\">\n            <form id=\"user-new-form\" hx-post=\"/admin/users/new\" hx-target=\"#form-messages\">\n\n              <!-- Basic Information -->\n              <div class=\"mb-8\">\n                <h3 class=\"text-base font-semibold text-zinc-950 dark:text-white mb-4\">Basic Information</h3>\n                <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  <div>\n                    <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">\n                      First Name <span class=\"text-red-500\">*</span>\n                    </label>\n                    <input\n                      type=\"text\"\n                      name=\"first_name\"\n                      required\n                      placeholder=\"Enter first name\"\n                      class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                    />\n                  </div>\n\n                  <div>\n                    <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">\n                      Last Name <span class=\"text-red-500\">*</span>\n                    </label>\n                    <input\n                      type=\"text\"\n                      name=\"last_name\"\n                      required\n                      placeholder=\"Enter last name\"\n                      class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                    />\n                  </div>\n\n                  <div>\n                    <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">\n                      Username <span class=\"text-red-500\">*</span>\n                    </label>\n                    <input\n                      type=\"text\"\n                      name=\"username\"\n                      required\n                      placeholder=\"Enter username\"\n                      class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                    />\n                  </div>\n\n                  <div>\n                    <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">\n                      Email <span class=\"text-red-500\">*</span>\n                    </label>\n                    <input\n                      type=\"email\"\n                      name=\"email\"\n                      required\n                      placeholder=\"user@example.com\"\n                      class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                    />\n                  </div>\n\n                  <div>\n                    <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Phone</label>\n                    <input\n                      type=\"tel\"\n                      name=\"phone\"\n                      placeholder=\"+1 (555) 000-0000\"\n                      class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                    />\n                  </div>\n\n                  <div>\n                    <label for=\"role\" class=\"block text-sm/6 font-medium text-zinc-950 dark:text-white\">\n                      Role <span class=\"text-red-500\">*</span>\n                    </label>\n                    <div class=\"mt-2 grid grid-cols-1\">\n                      <select\n                        id=\"role\"\n                        name=\"role\"\n                        required\n                        class=\"col-start-1 row-start-1 w-full appearance-none rounded-md bg-white/5 dark:bg-white/5 py-1.5 pl-3 pr-8 text-base text-zinc-950 dark:text-white outline outline-1 -outline-offset-1 outline-zinc-500/30 dark:outline-zinc-400/30 *:bg-white dark:*:bg-zinc-800 focus-visible:outline focus-visible:outline-2 focus-visible:-outline-offset-2 focus-visible:outline-zinc-500 dark:focus-visible:outline-zinc-400 sm:text-sm/6\"\n                      >\n                        ${data.roles.map(role => `\n                          <option value=\"${role.value}\">${role.label}</option>\n                        `).join('')}\n                      </select>\n                      <svg viewBox=\"0 0 16 16\" fill=\"currentColor\" data-slot=\"icon\" aria-hidden=\"true\" class=\"pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-zinc-600 dark:text-zinc-400 sm:size-4\">\n                        <path d=\"M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z\" clip-rule=\"evenodd\" fill-rule=\"evenodd\" />\n                      </svg>\n                    </div>\n                  </div>\n                </div>\n\n                <div class=\"mt-6\">\n                  <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Bio</label>\n                  <textarea\n                    name=\"bio\"\n                    rows=\"3\"\n                    placeholder=\"Enter a short bio (optional)\"\n                    class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                  ></textarea>\n                </div>\n              </div>\n\n              <!-- Password -->\n              <div class=\"mb-8\">\n                <h3 class=\"text-base font-semibold text-zinc-950 dark:text-white mb-4\">Password</h3>\n                <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  <div>\n                    <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">\n                      Password <span class=\"text-red-500\">*</span>\n                    </label>\n                    <input\n                      type=\"password\"\n                      name=\"password\"\n                      required\n                      placeholder=\"Enter password (min 8 characters)\"\n                      minlength=\"8\"\n                      class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                    />\n                  </div>\n\n                  <div>\n                    <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">\n                      Confirm Password <span class=\"text-red-500\">*</span>\n                    </label>\n                    <input\n                      type=\"password\"\n                      name=\"confirm_password\"\n                      required\n                      placeholder=\"Confirm password\"\n                      minlength=\"8\"\n                      class=\"w-full rounded-lg bg-white dark:bg-zinc-800 px-3 py-2 text-sm text-zinc-950 dark:text-white shadow-sm ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-950 dark:focus:ring-white transition-shadow\"\n                    />\n                  </div>\n                </div>\n              </div>\n\n              <!-- Account Status -->\n              <div class=\"mb-8\">\n                <h3 class=\"text-base font-semibold text-zinc-950 dark:text-white mb-4\">Account Status</h3>\n                <div class=\"space-y-5\">\n                  <div class=\"flex gap-3\">\n                    <div class=\"flex h-6 shrink-0 items-center\">\n                      <div class=\"group grid size-4 grid-cols-1\">\n                        <input\n                          type=\"checkbox\"\n                          id=\"is_active\"\n                          name=\"is_active\"\n                          value=\"1\"\n                          checked\n                          class=\"col-start-1 row-start-1 appearance-none rounded border border-zinc-950/10 dark:border-white/10 bg-white dark:bg-white/5 checked:border-indigo-500 checked:bg-indigo-500 indeterminate:border-indigo-500 indeterminate:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 disabled:border-zinc-950/5 dark:disabled:border-white/5 disabled:bg-zinc-950/10 dark:disabled:bg-white/10 disabled:checked:bg-zinc-950/10 dark:disabled:checked:bg-white/10 forced-colors:appearance-auto\"\n                        />\n                        <svg viewBox=\"0 0 14 14\" fill=\"none\" class=\"pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-[:disabled]:stroke-zinc-950/25 dark:group-has-[:disabled]:stroke-white/25\">\n                          <path d=\"M3 8L6 11L11 3.5\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:checked]:opacity-100\" />\n                          <path d=\"M3 7H11\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:indeterminate]:opacity-100\" />\n                        </svg>\n                      </div>\n                    </div>\n                    <div class=\"text-sm/6\">\n                      <label for=\"is_active\" class=\"font-medium text-zinc-950 dark:text-white\">Account Active</label>\n                      <p class=\"text-zinc-500 dark:text-zinc-400\">User can sign in and access the system</p>\n                    </div>\n                  </div>\n\n                  <div class=\"flex gap-3\">\n                    <div class=\"flex h-6 shrink-0 items-center\">\n                      <div class=\"group grid size-4 grid-cols-1\">\n                        <input\n                          type=\"checkbox\"\n                          id=\"email_verified\"\n                          name=\"email_verified\"\n                          value=\"1\"\n                          class=\"col-start-1 row-start-1 appearance-none rounded border border-zinc-950/10 dark:border-white/10 bg-white dark:bg-white/5 checked:border-indigo-500 checked:bg-indigo-500 indeterminate:border-indigo-500 indeterminate:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 disabled:border-zinc-950/5 dark:disabled:border-white/5 disabled:bg-zinc-950/10 dark:disabled:bg-white/10 disabled:checked:bg-zinc-950/10 dark:disabled:checked:bg-white/10 forced-colors:appearance-auto\"\n                        />\n                        <svg viewBox=\"0 0 14 14\" fill=\"none\" class=\"pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-[:disabled]:stroke-zinc-950/25 dark:group-has-[:disabled]:stroke-white/25\">\n                          <path d=\"M3 8L6 11L11 3.5\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:checked]:opacity-100\" />\n                          <path d=\"M3 7H11\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:indeterminate]:opacity-100\" />\n                        </svg>\n                      </div>\n                    </div>\n                    <div class=\"text-sm/6\">\n                      <label for=\"email_verified\" class=\"font-medium text-zinc-950 dark:text-white\">Email Verified</label>\n                      <p class=\"text-zinc-500 dark:text-zinc-400\">Mark email as verified</p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n            </form>\n          </div>\n        </div>\n\n        <!-- Sidebar -->\n        <div class=\"lg:col-span-1\">\n          <!-- Help Text -->\n          <div class=\"rounded-xl bg-blue-50 dark:bg-blue-500/10 shadow-sm ring-1 ring-blue-600/20 dark:ring-blue-500/20 p-6\">\n            <h3 class=\"text-base font-semibold text-blue-900 dark:text-blue-300 mb-2\">Creating a User</h3>\n            <div class=\"text-sm text-blue-700 dark:text-blue-400 space-y-3\">\n              <p>Fill in the required fields marked with <span class=\"text-red-500\">*</span> to create a new user account.</p>\n              <p>The password must be at least 8 characters long.</p>\n              <p>By default, new users are created as active and can sign in immediately.</p>\n              <p>You can edit user details and permissions after creation.</p>\n            </div>\n          </div>\n\n          <!-- Role Descriptions -->\n          <div class=\"rounded-xl bg-white dark:bg-zinc-900 shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10 p-6 mt-6\">\n            <h3 class=\"text-base font-semibold text-zinc-950 dark:text-white mb-4\">Role Descriptions</h3>\n            <dl class=\"space-y-3 text-sm\">\n              <div>\n                <dt class=\"font-medium text-zinc-950 dark:text-white\">Administrator</dt>\n                <dd class=\"text-zinc-500 dark:text-zinc-400\">Full system access and permissions</dd>\n              </div>\n              <div>\n                <dt class=\"font-medium text-zinc-950 dark:text-white\">Editor</dt>\n                <dd class=\"text-zinc-500 dark:text-zinc-400\">Can create and edit content</dd>\n              </div>\n              <div>\n                <dt class=\"font-medium text-zinc-950 dark:text-white\">Author</dt>\n                <dd class=\"text-zinc-500 dark:text-zinc-400\">Can create own content</dd>\n              </div>\n              <div>\n                <dt class=\"font-medium text-zinc-950 dark:text-white\">Viewer</dt>\n                <dd class=\"text-zinc-500 dark:text-zinc-400\">Read-only access</dd>\n              </div>\n            </dl>\n          </div>\n        </div>\n      </div>\n    </div>\n  `\n\n  const layoutData: AdminLayoutCatalystData = {\n    title: 'Create User',\n    pageTitle: 'Create New User',\n    currentPath: '/admin/users',\n    user: data.user,\n    content: pageContent\n  }\n\n  return renderAdminLayoutCatalyst(layoutData)\n}\n","import { renderAdminLayoutCatalyst, AdminLayoutCatalystData } from '../layouts/admin-layout-catalyst.template'\nimport { renderPagination, PaginationData } from '../pagination.template'\nimport { renderAlert } from '../alert.template'\nimport { renderTable, TableColumn, TableData } from '../table.template'\nimport { renderConfirmationDialog, getConfirmationDialogScript } from '../components/confirmation-dialog.template'\n\nexport interface User {\n  id: string\n  email: string\n  username: string\n  firstName: string\n  lastName: string\n  role: string\n  avatar?: string\n  isActive: boolean\n  lastLoginAt?: number\n  createdAt: number\n  updatedAt: number\n  formattedLastLogin?: string\n  formattedCreatedAt?: string\n}\n\nexport interface UsersListPageData {\n  users: User[]\n  pagination?: PaginationData\n  currentPage: number\n  totalPages: number\n  totalUsers: number\n  statusFilter?: string\n  roleFilter?: string\n  searchFilter?: string\n  error?: string\n  success?: string\n  user?: {\n    name: string\n    email: string\n    role: string\n  }\n  version?: string\n}\n\nexport function renderUsersListPage(data: UsersListPageData): string {\n  const columns: TableColumn[] = [\n    {\n      key: 'avatar',\n      label: '',\n      className: 'w-12',\n      sortable: false,\n      render: (value: string | null, row: User) => {\n        const initials = `${row.firstName.charAt(0)}${row.lastName.charAt(0)}`.toUpperCase()\n        if (value) {\n          return `<img src=\"${value}\" alt=\"${row.firstName} ${row.lastName}\" class=\"w-8 h-8 rounded-full\">`\n        }\n        return `\n          <div class=\"w-8 h-8 bg-gradient-to-br from-cyan-400 to-blue-500 dark:from-cyan-300 dark:to-blue-400 rounded-full flex items-center justify-center\">\n            <span class=\"text-xs font-medium text-white\">${initials}</span>\n          </div>\n        `\n      }\n    },\n    {\n      key: 'name',\n      label: 'Name',\n      sortable: true,\n      sortType: 'string',\n      render: (_value: any, row: User) => {\n        const escapeHtml = (text: string) => text.replace(/[&<>\"']/g, (char) => ({\n          '&': '&amp;',\n          '<': '&lt;',\n          '>': '&gt;',\n          '\"': '&quot;',\n          \"'\": '&#39;'\n        }[char] || char))\n        \n        const truncatedFirstName = row.firstName.length > 25 ? row.firstName.substring(0, 25) + '...' : row.firstName\n        const truncatedLastName = row.lastName.length > 25 ? row.lastName.substring(0, 25) + '...' : row.lastName\n        const fullName = escapeHtml(`${truncatedFirstName} ${truncatedLastName}`)\n        const truncatedUsername = row.username.length > 100 ? row.username.substring(0, 100) + '...' : row.username\n        const username = escapeHtml(truncatedUsername)\n        const statusBadge = row.isActive ?\n          '<span class=\"inline-flex items-center px-2 py-0.5 rounded-md text-xs font-medium bg-lime-50 dark:bg-lime-500/10 text-lime-700 dark:text-lime-300 ring-1 ring-inset ring-lime-700/10 dark:ring-lime-400/20 ml-2\">Active</span>' :\n          '<span class=\"inline-flex items-center px-2 py-0.5 rounded-md text-xs font-medium bg-red-50 dark:bg-red-500/10 text-red-700 dark:text-red-400 ring-1 ring-inset ring-red-700/10 dark:ring-red-500/20 ml-2\">Inactive</span>'\n        return `\n          <div>\n            <div class=\"text-sm font-medium text-zinc-950 dark:text-white\">${fullName}${statusBadge}</div>\n            <div class=\"text-sm text-zinc-500 dark:text-zinc-400\">@${username}</div>\n          </div>\n        `\n      }\n    },\n    {\n      key: 'email',\n      label: 'Email',\n      sortable: true,\n      sortType: 'string',\n      render: (value: string) => {\n        const escapeHtml = (text: string) => text.replace(/[&<>\"']/g, (char) => ({\n          '&': '&amp;',\n          '<': '&lt;',\n          '>': '&gt;',\n          '\"': '&quot;',\n          \"'\": '&#39;'\n        }[char] || char))\n        const escapedEmail = escapeHtml(value)\n        return `<a href=\"mailto:${escapedEmail}\" class=\"text-cyan-600 dark:text-cyan-400 hover:text-cyan-700 dark:hover:text-cyan-300 transition-colors\">${escapedEmail}</a>`\n      }\n    },\n    {\n      key: 'role',\n      label: 'Role',\n      sortable: true,\n      sortType: 'string',\n      render: (value: string) => {\n        const roleColors = {\n          admin: 'bg-red-50 dark:bg-red-500/10 text-red-700 dark:text-red-400 ring-1 ring-inset ring-red-700/10 dark:ring-red-500/20',\n          editor: 'bg-blue-50 dark:bg-blue-500/10 text-blue-700 dark:text-blue-400 ring-1 ring-inset ring-blue-700/10 dark:ring-blue-500/20',\n          author: 'bg-cyan-50 dark:bg-cyan-500/10 text-cyan-700 dark:text-cyan-400 ring-1 ring-inset ring-cyan-700/10 dark:ring-cyan-500/20',\n          viewer: 'bg-zinc-50 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 ring-1 ring-inset ring-zinc-500/10 dark:ring-zinc-400/20'\n        }\n        const colorClass = roleColors[value as keyof typeof roleColors] || 'bg-zinc-50 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 ring-1 ring-inset ring-zinc-500/10 dark:ring-zinc-400/20'\n        return `<span class=\"inline-flex items-center px-2 py-0.5 rounded-md text-xs font-medium ${colorClass}\">${value.charAt(0).toUpperCase() + value.slice(1)}</span>`\n      }\n    },\n    {\n      key: 'lastLoginAt',\n      label: 'Last Login',\n      sortable: true,\n      sortType: 'date',\n      render: (value: number | null) => {\n        if (!value) return '<span class=\"text-zinc-500 dark:text-zinc-400\">Never</span>'\n        return `<span class=\"text-sm text-zinc-500 dark:text-zinc-400\">${new Date(value).toLocaleDateString()}</span>`\n      }\n    },\n    {\n      key: 'createdAt',\n      label: 'Created',\n      sortable: true,\n      sortType: 'date',\n      render: (value: number) => `<span class=\"text-sm text-zinc-500 dark:text-zinc-400\">${new Date(value).toLocaleDateString()}</span>`\n    },\n    {\n      key: 'actions',\n      label: 'Actions',\n      className: 'text-right',\n      sortable: false,\n      render: (_value: any, row: User) => `\n        <div class=\"flex justify-end space-x-2\">\n          ${row.isActive ?\n            `<button onclick=\"toggleUserStatus('${row.id}', false)\" title=\"Deactivate user\" class=\"inline-flex items-center justify-center p-2 text-sm font-medium rounded-lg bg-gradient-to-r from-red-500 to-pink-500 dark:from-red-400 dark:to-pink-400 text-white hover:from-red-600 hover:to-pink-600 dark:hover:from-red-500 dark:hover:to-pink-500 shadow-sm transition-all duration-200\">\n              <svg class=\"h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636\"/>\n              </svg>\n            </button>` :\n            `<button onclick=\"toggleUserStatus('${row.id}', true)\" title=\"Activate user\" class=\"inline-flex items-center justify-center p-2 text-sm font-medium rounded-lg bg-gradient-to-r from-lime-500 to-green-500 dark:from-lime-400 dark:to-green-400 text-white hover:from-lime-600 hover:to-green-600 dark:hover:from-lime-500 dark:hover:to-green-500 shadow-sm transition-all duration-200\">\n              <svg class=\"h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"/>\n              </svg>\n            </button>`\n          }\n        </div>\n      `\n    }\n  ]\n\n  const tableData: TableData<User> = {\n    tableId: 'users-table',\n    columns,\n    rows: data.users,\n    selectable: false,\n    rowClickable: true,\n    rowClickUrl: (row: User) => `/admin/users/${row.id}/edit`,\n    emptyMessage: 'No users found'\n  }\n\n  const pageContent = `\n    <div>\n      <!-- Header -->\n      <div class=\"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6\">\n        <div>\n          <h1 class=\"text-2xl/8 font-semibold text-zinc-950 dark:text-white sm:text-xl/8\">User Management</h1>\n          <p class=\"mt-2 text-sm/6 text-zinc-500 dark:text-zinc-400\">Manage user accounts and permissions</p>\n        </div>\n        <div class=\"mt-4 sm:mt-0 sm:ml-16 sm:flex-none flex space-x-3\">\n          <a href=\"/admin/users/new\" class=\"inline-flex items-center justify-center rounded-lg bg-zinc-950 dark:bg-white px-3.5 py-2.5 text-sm font-semibold text-white dark:text-zinc-950 hover:bg-zinc-800 dark:hover:bg-zinc-100 transition-colors shadow-sm\">\n            <svg class=\"-ml-0.5 mr-1.5 h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n              <path d=\"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z\" />\n            </svg>\n            Add User\n          </a>\n          <button class=\"inline-flex items-center justify-center rounded-lg bg-white dark:bg-zinc-800 px-3.5 py-2.5 text-sm font-semibold text-zinc-950 dark:text-white ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 hover:bg-zinc-50 dark:hover:bg-zinc-700 transition-colors shadow-sm\" onclick=\"exportUsers()\">\n            <svg class=\"-ml-0.5 mr-1.5 h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"></path>\n            </svg>\n            Export\n          </button>\n        </div>\n      </div>\n\n      <!-- Alert Messages -->\n      ${data.error ? renderAlert({ type: 'error', message: data.error, dismissible: true }) : ''}\n      ${data.success ? renderAlert({ type: 'success', message: data.success, dismissible: true }) : ''}\n\n      <!-- Stats -->\n      <div class=\"mb-6\">\n        <h3 class=\"text-base font-semibold text-zinc-950 dark:text-white\">User Statistics</h3>\n        <dl class=\"mt-5 grid grid-cols-1 divide-zinc-950/5 dark:divide-white/10 overflow-hidden rounded-lg bg-zinc-800/75 dark:bg-zinc-800/75 ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 md:grid-cols-4 md:divide-x md:divide-y-0\">\n          <div class=\"px-4 py-5 sm:p-6\">\n            <dt class=\"text-base font-normal text-zinc-700 dark:text-zinc-100\">Total Users</dt>\n            <dd class=\"mt-1 flex items-baseline justify-between md:block lg:flex\">\n              <div class=\"flex items-baseline text-2xl font-semibold text-cyan-400\">\n                ${data.totalUsers}\n              </div>\n              <div class=\"inline-flex items-baseline rounded-full bg-lime-400/10 text-lime-600 dark:text-lime-400 px-2.5 py-0.5 text-sm font-medium md:mt-2 lg:mt-0\">\n                <svg viewBox=\"0 0 20 20\" fill=\"currentColor\" class=\"-ml-1 mr-0.5 size-5 shrink-0 self-center\">\n                  <path d=\"M10 17a.75.75 0 0 1-.75-.75V5.612L5.29 9.77a.75.75 0 0 1-1.08-1.04l5.25-5.5a.75.75 0 0 1 1.08 0l5.25 5.5a.75.75 0 1 1-1.08 1.04l-3.96-4.158V16.25A.75.75 0 0 1 10 17Z\" clip-rule=\"evenodd\" fill-rule=\"evenodd\" />\n                </svg>\n                <span class=\"sr-only\">Increased by</span>\n                5.2%\n              </div>\n            </dd>\n          </div>\n          <div class=\"px-4 py-5 sm:p-6\">\n            <dt class=\"text-base font-normal text-zinc-700 dark:text-zinc-100\">Active Users</dt>\n            <dd class=\"mt-1 flex items-baseline justify-between md:block lg:flex\">\n              <div class=\"flex items-baseline text-2xl font-semibold text-lime-400\">\n                ${data.users.filter(u => u.isActive).length}\n              </div>\n              <div class=\"inline-flex items-baseline rounded-full bg-lime-400/10 text-lime-600 dark:text-lime-400 px-2.5 py-0.5 text-sm font-medium md:mt-2 lg:mt-0\">\n                <svg viewBox=\"0 0 20 20\" fill=\"currentColor\" class=\"-ml-1 mr-0.5 size-5 shrink-0 self-center\">\n                  <path d=\"M10 17a.75.75 0 0 1-.75-.75V5.612L5.29 9.77a.75.75 0 0 1-1.08-1.04l5.25-5.5a.75.75 0 0 1 1.08 0l5.25 5.5a.75.75 0 1 1-1.08 1.04l-3.96-4.158V16.25A.75.75 0 0 1 10 17Z\" clip-rule=\"evenodd\" fill-rule=\"evenodd\" />\n                </svg>\n                <span class=\"sr-only\">Increased by</span>\n                3.1%\n              </div>\n            </dd>\n          </div>\n          <div class=\"px-4 py-5 sm:p-6\">\n            <dt class=\"text-base font-normal text-zinc-700 dark:text-zinc-100\">Administrators</dt>\n            <dd class=\"mt-1 flex items-baseline justify-between md:block lg:flex\">\n              <div class=\"flex items-baseline text-2xl font-semibold text-pink-400\">\n                ${data.users.filter(u => u.role === 'admin').length}\n              </div>\n              <div class=\"inline-flex items-baseline rounded-full bg-lime-400/10 text-lime-600 dark:text-lime-400 px-2.5 py-0.5 text-sm font-medium md:mt-2 lg:mt-0\">\n                <svg viewBox=\"0 0 20 20\" fill=\"currentColor\" class=\"-ml-1 mr-0.5 size-5 shrink-0 self-center\">\n                  <path d=\"M10 17a.75.75 0 0 1-.75-.75V5.612L5.29 9.77a.75.75 0 0 1-1.08-1.04l5.25-5.5a.75.75 0 0 1 1.08 0l5.25 5.5a.75.75 0 1 1-1.08 1.04l-3.96-4.158V16.25A.75.75 0 0 1 10 17Z\" clip-rule=\"evenodd\" fill-rule=\"evenodd\" />\n                </svg>\n                <span class=\"sr-only\">Increased by</span>\n                1.8%\n              </div>\n            </dd>\n          </div>\n          <div class=\"px-4 py-5 sm:p-6\">\n            <dt class=\"text-base font-normal text-zinc-700 dark:text-zinc-100\">Active This Week</dt>\n            <dd class=\"mt-1 flex items-baseline justify-between md:block lg:flex\">\n              <div class=\"flex items-baseline text-2xl font-semibold text-purple-400\">\n                ${data.users.filter(u => u.lastLoginAt && u.lastLoginAt > Date.now() - 7 * 24 * 60 * 60 * 1000).length}\n              </div>\n              <div class=\"inline-flex items-baseline rounded-full bg-pink-400/10 text-pink-600 dark:text-pink-400 px-2.5 py-0.5 text-sm font-medium md:mt-2 lg:mt-0\">\n                <svg viewBox=\"0 0 20 20\" fill=\"currentColor\" class=\"-ml-1 mr-0.5 size-5 shrink-0 self-center\">\n                  <path d=\"M10 3a.75.75 0 0 1 .75.75v10.638l3.96-4.158a.75.75 0 1 1 1.08 1.04l-5.25 5.5a.75.75 0 0 1-1.08 0l-5.25-5.5a.75.75 0 1 1 1.08-1.04l3.96 4.158V3.75A.75.75 0 0 1 10 3Z\" clip-rule=\"evenodd\" fill-rule=\"evenodd\" />\n                </svg>\n                <span class=\"sr-only\">Decreased by</span>\n                2.3%\n              </div>\n            </dd>\n          </div>\n        </dl>\n      </div>\n\n      <!-- Filters with Gradient Background -->\n      <div class=\"relative rounded-xl overflow-hidden mb-6\">\n        <!-- Gradient Background Layer -->\n        <div class=\"absolute inset-0 bg-gradient-to-r from-purple-500/10 via-pink-500/10 to-blue-500/10 dark:from-purple-400/20 dark:via-pink-400/20 dark:to-blue-400/20\"></div>\n\n        <!-- Content Layer with backdrop blur -->\n        <div class=\"relative bg-white/80 dark:bg-zinc-900/80 backdrop-blur-xl shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10\">\n          <div class=\"px-6 py-5\">\n            <div class=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n              <!-- Modern Search Input -->\n              <div>\n                <label class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Search</label>\n                <div class=\"relative group\">\n                  <input\n                    type=\"text\"\n                    name=\"search\"\n                    id=\"user-search-input\"\n                    value=\"${data.searchFilter || ''}\"\n                    placeholder=\"Search users...\"\n                    class=\"rounded-full bg-white/90 dark:bg-zinc-800/90 backdrop-blur-sm px-4 py-2.5 pl-11 text-sm w-full text-zinc-950 dark:text-white border-2 border-purple-200/50 dark:border-purple-700/50 placeholder:text-zinc-400 dark:placeholder:text-zinc-500 focus:outline-none focus:border-purple-500 dark:focus:border-purple-400 focus:bg-white dark:focus:bg-zinc-800 focus:shadow-lg focus:shadow-purple-500/20 dark:focus:shadow-purple-400/20 transition-all duration-300\"\n                    hx-get=\"/admin/users\"\n                    hx-trigger=\"keyup changed delay:300ms\"\n                    hx-target=\"body\"\n                    hx-include=\"[name='role'], [name='status']\"\n                    hx-on::after-request=\"\n                      const input = document.getElementById('user-search-input');\n                      if (input && document.activeElement === input) {\n                        const len = input.value.length;\n                        setTimeout(() => {\n                          input.focus();\n                          input.setSelectionRange(len, len);\n                        }, 10);\n                      }\n                    \"\n                  >\n                  <!-- Gradient search icon -->\n                  <div class=\"absolute left-3.5 top-2.5 flex items-center justify-center w-5 h-5 rounded-full bg-gradient-to-br from-purple-400 to-pink-500 dark:from-purple-300 dark:to-pink-400 opacity-90 group-focus-within:opacity-100 transition-opacity\">\n                    <svg class=\"h-3 w-3 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" stroke-width=\"2.5\">\n                      <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"/>\n                    </svg>\n                  </div>\n                </div>\n              </div>\n\n              <div>\n                <label class=\"block text-sm/6 font-medium text-zinc-950 dark:text-white\">Role</label>\n                <div class=\"mt-2 grid grid-cols-1\">\n                  <select\n                    name=\"role\"\n                    hx-get=\"/admin/users\"\n                    hx-trigger=\"change\"\n                    hx-target=\"body\"\n                    hx-include=\"[name='search'], [name='status']\"\n                    class=\"col-start-1 row-start-1 w-full appearance-none rounded-md bg-white/5 dark:bg-white/5 py-1.5 pl-3 pr-8 text-base text-zinc-950 dark:text-white outline outline-1 -outline-offset-1 outline-purple-500/30 dark:outline-purple-400/30 *:bg-white dark:*:bg-zinc-800 focus-visible:outline focus-visible:outline-2 focus-visible:-outline-offset-2 focus-visible:outline-purple-500 dark:focus-visible:outline-purple-400 sm:text-sm/6\"\n                  >\n                    <option value=\"\" ${!data.roleFilter ? 'selected' : ''}>All Roles</option>\n                    <option value=\"admin\" ${data.roleFilter === 'admin' ? 'selected' : ''}>Admin</option>\n                    <option value=\"editor\" ${data.roleFilter === 'editor' ? 'selected' : ''}>Editor</option>\n                    <option value=\"author\" ${data.roleFilter === 'author' ? 'selected' : ''}>Author</option>\n                    <option value=\"viewer\" ${data.roleFilter === 'viewer' ? 'selected' : ''}>Viewer</option>\n                  </select>\n                  <svg viewBox=\"0 0 16 16\" fill=\"currentColor\" data-slot=\"icon\" aria-hidden=\"true\" class=\"pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-purple-600 dark:text-purple-400 sm:size-4\">\n                    <path d=\"M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z\" clip-rule=\"evenodd\" fill-rule=\"evenodd\" />\n                  </svg>\n                </div>\n              </div>\n\n              <div>\n                <label class=\"block text-sm/6 font-medium text-zinc-950 dark:text-white\">Status</label>\n                <div class=\"mt-2 grid grid-cols-1\">\n                  <select\n                    name=\"status\"\n                    hx-get=\"/admin/users\"\n                    hx-trigger=\"change\"\n                    hx-target=\"body\"\n                    hx-include=\"[name='search'], [name='role']\"\n                    class=\"col-start-1 row-start-1 w-full appearance-none rounded-md bg-white/5 dark:bg-white/5 py-1.5 pl-3 pr-8 text-base text-zinc-950 dark:text-white outline outline-1 -outline-offset-1 outline-purple-500/30 dark:outline-purple-400/30 *:bg-white dark:*:bg-zinc-800 focus-visible:outline focus-visible:outline-2 focus-visible:-outline-offset-2 focus-visible:outline-purple-500 dark:focus-visible:outline-purple-400 sm:text-sm/6\"\n                  >\n                    <option value=\"active\" ${!data.statusFilter || data.statusFilter === 'active' ? 'selected' : ''}>Active</option>\n                    <option value=\"inactive\" ${data.statusFilter === 'inactive' ? 'selected' : ''}>Inactive</option>\n                    <option value=\"all\" ${data.statusFilter === 'all' ? 'selected' : ''}>All Users</option>\n                  </select>\n                  <svg viewBox=\"0 0 16 16\" fill=\"currentColor\" data-slot=\"icon\" aria-hidden=\"true\" class=\"pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-purple-600 dark:text-purple-400 sm:size-4\">\n                    <path d=\"M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z\" clip-rule=\"evenodd\" fill-rule=\"evenodd\" />\n                  </svg>\n                </div>\n              </div>\n\n              <div>\n                <label class=\"block text-sm/6 font-medium text-zinc-950 dark:text-white\">&nbsp;</label>\n                <div class=\"mt-2\">\n                  <button\n                    class=\"inline-flex items-center gap-x-1.5 justify-center px-4 py-2 bg-white/90 dark:bg-zinc-800/90 backdrop-blur-sm text-zinc-950 dark:text-white text-sm font-medium rounded-full ring-1 ring-inset ring-purple-200/50 dark:ring-purple-700/50 hover:bg-gradient-to-r hover:from-purple-50 hover:to-pink-50 dark:hover:from-purple-900/30 dark:hover:to-pink-900/30 hover:ring-purple-300 dark:hover:ring-purple-600 transition-all duration-200 w-full\"\n                    onclick=\"clearFilters()\"\n                  >\n                    <svg class=\"h-4 w-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\"/>\n                    </svg>\n                    Clear Filters\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Users Table -->\n      ${renderTable(tableData)}\n\n      <!-- Pagination -->\n      ${data.pagination ? renderPagination(data.pagination) : ''}\n    </div>\n\n    <script>\n      let userStatusData = null;\n\n      function toggleUserStatus(userId, activate) {\n        userStatusData = { userId, activate };\n        showConfirmDialog('toggle-user-status-confirm');\n      }\n\n      function performToggleUserStatus() {\n        if (!userStatusData) return;\n\n        const { userId, activate } = userStatusData;\n\n        fetch(\\`/admin/users/\\${userId}/toggle\\`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({ active: activate })\n        })\n        .then(response => response.json())\n        .then(data => {\n          if (data.success) {\n            location.reload()\n          } else {\n            alert('Error updating user status')\n          }\n        })\n        .catch(error => {\n          console.error('Error:', error)\n          alert('Error updating user status')\n        })\n        .finally(() => {\n          userStatusData = null;\n        });\n      }\n\n      function clearFilters() {\n        window.location.href = '/admin/users'\n      }\n\n      function exportUsers() {\n        window.open('/admin/users/export', '_blank')\n      }\n    </script>\n\n    <!-- Confirmation Dialogs -->\n    ${renderConfirmationDialog({\n      id: 'toggle-user-status-confirm',\n      title: 'Toggle User Status',\n      message: 'Are you sure you want to activate/deactivate this user?',\n      confirmText: 'Confirm',\n      cancelText: 'Cancel',\n      iconColor: 'yellow',\n      confirmClass: 'bg-yellow-500 hover:bg-yellow-400',\n      onConfirm: 'performToggleUserStatus()'\n    })}\n\n    ${getConfirmationDialogScript()}\n  `\n\n  const layoutData: AdminLayoutCatalystData = {\n    title: 'Users',\n    pageTitle: 'User Management',\n    currentPath: '/admin/users',\n    user: data.user,\n    version: data.version,\n    content: pageContent\n  }\n\n  return renderAdminLayoutCatalyst(layoutData)\n} ","import { Hono } from 'hono'\nimport { requireAuth, logActivity, AuthManager } from '../middleware'\nimport { sanitizeInput } from '../utils/sanitize'\nimport { renderProfilePage, renderAvatarImage, type UserProfile, type ProfilePageData } from '../templates/pages/admin-profile.template'\nimport { renderAlert } from '../templates/components/alert.template'\nimport { renderActivityLogsPage, type ActivityLogsPageData, type ActivityLog } from '../templates/pages/admin-activity-logs.template'\nimport { renderUserEditPage, type UserEditPageData, type UserEditData, type UserProfileData } from '../templates/pages/admin-user-edit.template'\nimport { renderUserNewPage, type UserNewPageData } from '../templates/pages/admin-user-new.template'\nimport { renderUsersListPage, type UsersListPageData, type User } from '../templates/pages/admin-users-list.template'\nimport type { Bindings, Variables } from '../app'\n\nconst userRoutes = new Hono<{ Bindings: Bindings; Variables: Variables }>()\n\n// Apply authentication middleware to all routes\nuserRoutes.use('*', requireAuth())\n\n// Redirect /admin to /admin/dashboard\nuserRoutes.get('/', (c) => {\n  return c.redirect('/admin/dashboard')\n})\n\n// Timezone options for profile form\nconst TIMEZONES = [\n  { value: 'UTC', label: 'UTC' },\n  { value: 'America/New_York', label: 'Eastern Time' },\n  { value: 'America/Chicago', label: 'Central Time' },\n  { value: 'America/Denver', label: 'Mountain Time' },\n  { value: 'America/Los_Angeles', label: 'Pacific Time' },\n  { value: 'Europe/London', label: 'London' },\n  { value: 'Europe/Paris', label: 'Paris' },\n  { value: 'Europe/Berlin', label: 'Berlin' },\n  { value: 'Asia/Tokyo', label: 'Tokyo' },\n  { value: 'Asia/Shanghai', label: 'Shanghai' },\n  { value: 'Australia/Sydney', label: 'Sydney' }\n]\n\n// Language options for profile form\nconst LANGUAGES = [\n  { value: 'en', label: 'English' },\n  { value: 'es', label: 'Spanish' },\n  { value: 'fr', label: 'French' },\n  { value: 'de', label: 'German' },\n  { value: 'it', label: 'Italian' },\n  { value: 'pt', label: 'Portuguese' },\n  { value: 'ja', label: 'Japanese' },\n  { value: 'ko', label: 'Korean' },\n  { value: 'zh', label: 'Chinese' }\n]\n\n// Role options for user form\nconst ROLES = [\n  { value: 'admin', label: 'Administrator' },\n  { value: 'editor', label: 'Editor' },\n  { value: 'author', label: 'Author' },\n  { value: 'viewer', label: 'Viewer' }\n]\n\n/**\n * GET /admin/profile - Show user profile page\n */\nuserRoutes.get('/profile', async (c) => {\n  const user = c.get('user')\n  const db = c.env.DB\n\n  try {\n    // Get user profile data\n    const userStmt = db.prepare(`\n      SELECT id, email, username, first_name, last_name, phone, bio, avatar_url,\n             timezone, language, theme, email_notifications, two_factor_enabled,\n             role, created_at, last_login_at\n      FROM users \n      WHERE id = ? AND is_active = 1\n    `)\n    \n    const userProfile = await userStmt.bind(user!.userId).first() as any\n\n    if (!userProfile) {\n      return c.json({ error: 'User not found' }, 404)\n    }\n\n    // Convert to UserProfile interface\n    const profile: UserProfile = {\n      id: userProfile.id,\n      email: userProfile.email,\n      username: userProfile.username || '',\n      first_name: userProfile.first_name || '',\n      last_name: userProfile.last_name || '',\n      phone: userProfile.phone,\n      bio: userProfile.bio,\n      avatar_url: userProfile.avatar_url,\n      timezone: userProfile.timezone || 'UTC',\n      language: userProfile.language || 'en',\n      theme: userProfile.theme || 'dark',\n      email_notifications: Boolean(userProfile.email_notifications),\n      two_factor_enabled: Boolean(userProfile.two_factor_enabled),\n      role: userProfile.role,\n      created_at: userProfile.created_at,\n      last_login_at: userProfile.last_login_at\n    }\n\n    const pageData: ProfilePageData = {\n      profile,\n      timezones: TIMEZONES,\n      languages: LANGUAGES,\n      user: {\n        name: `${profile.first_name} ${profile.last_name}`.trim() || profile.username || user!.email,\n        email: user!.email,\n        role: user!.role\n      }\n    }\n\n    return c.html(renderProfilePage(pageData))\n  } catch (error) {\n    console.error('Profile page error:', error)\n    \n    const pageData: ProfilePageData = {\n      profile: {} as UserProfile,\n      timezones: TIMEZONES,\n      languages: LANGUAGES,\n      error: 'Failed to load profile. Please try again.',\n      user: {\n        name: user!.email,\n        email: user!.email,\n        role: user!.role\n      }\n    }\n\n    return c.html(renderProfilePage(pageData))\n  }\n})\n\n/**\n * PUT /admin/profile - Update user profile\n */\nuserRoutes.put('/profile', async (c) => {\n  const user = c.get('user')\n  const db = c.env.DB\n\n  try {\n    const formData = await c.req.formData()\n\n    // Sanitize all user inputs to prevent XSS attacks\n    const firstName = sanitizeInput(formData.get('first_name')?.toString())\n    const lastName = sanitizeInput(formData.get('last_name')?.toString())\n    const username = sanitizeInput(formData.get('username')?.toString())\n    const email = formData.get('email')?.toString()?.trim().toLowerCase() || ''\n    const phone = sanitizeInput(formData.get('phone')?.toString()) || null\n    const bio = sanitizeInput(formData.get('bio')?.toString()) || null\n    const timezone = formData.get('timezone')?.toString() || 'UTC'\n    const language = formData.get('language')?.toString() || 'en'\n    const emailNotifications = formData.get('email_notifications') === '1'\n\n    // Validate required fields\n    if (!firstName || !lastName || !username || !email) {\n      return c.html(renderAlert({\n        type: 'error',\n        message: 'First name, last name, username, and email are required.',\n        dismissible: true\n      }))\n    }\n\n    // Validate email format\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/\n    if (!emailRegex.test(email)) {\n      return c.html(renderAlert({ \n        type: 'error', \n        message: 'Please enter a valid email address.',\n        dismissible: true \n      }))\n    }\n\n    // Check if username/email are taken by another user\n    const checkStmt = db.prepare(`\n      SELECT id FROM users \n      WHERE (username = ? OR email = ?) AND id != ? AND is_active = 1\n    `)\n    const existingUser = await checkStmt.bind(username, email, user!.userId).first()\n\n    if (existingUser) {\n      return c.html(renderAlert({ \n        type: 'error', \n        message: 'Username or email is already taken by another user!.',\n        dismissible: true \n      }))\n    }\n\n    // Update user profile\n    const updateStmt = db.prepare(`\n      UPDATE users SET \n        first_name = ?, last_name = ?, username = ?, email = ?,\n        phone = ?, bio = ?, timezone = ?, language = ?,\n        email_notifications = ?, updated_at = ?\n      WHERE id = ?\n    `)\n\n    await updateStmt.bind(\n      firstName, lastName, username, email,\n      phone, bio, timezone, language,\n      emailNotifications ? 1 : 0, Date.now(),\n      user!.userId\n    ).run()\n\n    // Log the activity\n    await logActivity(\n      db, user!.userId, 'profile.update', 'users', user!.userId,\n      { fields: ['first_name', 'last_name', 'username', 'email', 'phone', 'bio', 'timezone', 'language', 'email_notifications'] },\n      c.req.header('x-forwarded-for') || c.req.header('cf-connecting-ip'),\n      c.req.header('user-agent')\n    )\n\n    return c.html(renderAlert({ \n      type: 'success', \n      message: 'Profile updated successfully!',\n      dismissible: true \n    }))\n\n  } catch (error) {\n    console.error('Profile update error:', error)\n    return c.html(renderAlert({ \n      type: 'error', \n      message: 'Failed to update profile. Please try again.',\n      dismissible: true \n    }))\n  }\n})\n\n/**\n * POST /admin/profile/avatar - Upload user avatar\n */\nuserRoutes.post('/profile/avatar', async (c) => {\n  const user = c.get('user')\n  const db = c.env.DB\n\n  try {\n    const formData = await c.req.formData()\n    const avatarFile = formData.get('avatar') as File | null\n\n    if (!avatarFile || typeof avatarFile === 'string' || !avatarFile.name) {\n      return c.html(renderAlert({\n        type: 'error',\n        message: 'Please select an image file.',\n        dismissible: true\n      }))\n    }\n\n    // Validate file type\n    const allowedTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp']\n    if (!allowedTypes.includes(avatarFile.type)) {\n      return c.html(renderAlert({ \n        type: 'error', \n        message: 'Please upload a valid image file (JPEG, PNG, GIF, or WebP).',\n        dismissible: true \n      }))\n    }\n\n    // Validate file size (5MB max)\n    const maxSize = 5 * 1024 * 1024\n    if (avatarFile.size > maxSize) {\n      return c.html(renderAlert({ \n        type: 'error', \n        message: 'Image file must be smaller than 5MB.',\n        dismissible: true \n      }))\n    }\n\n    // For now, we'll simulate storing the avatar\n    // In a real implementation, you'd upload to cloud storage (R2, S3, etc.)\n    const avatarUrl = `/uploads/avatars/${user!.userId}-${Date.now()}.${avatarFile.type.split('/')[1]}`\n\n    // Update user avatar URL in database\n    const updateStmt = db.prepare(`\n      UPDATE users SET avatar_url = ?, updated_at = ?\n      WHERE id = ?\n    `)\n\n    await updateStmt.bind(avatarUrl, Date.now(), user!.userId).run()\n\n    // Get updated user data to render the avatar\n    const userStmt = db.prepare(`\n      SELECT first_name, last_name FROM users WHERE id = ?\n    `)\n    const userData = await userStmt.bind(user!.userId).first() as any\n\n    // Log the activity\n    await logActivity(\n      db, user!.userId, 'profile.avatar_update', 'users', user!.userId,\n      { avatar_url: avatarUrl },\n      c.req.header('x-forwarded-for') || c.req.header('cf-connecting-ip'),\n      c.req.header('user-agent')\n    )\n\n    // Return both the alert message and the updated avatar image using HTMX out-of-band swap\n    const alertHtml = renderAlert({\n      type: 'success',\n      message: 'Profile picture updated successfully!',\n      dismissible: true\n    })\n\n    // Add timestamp to avatar URL to bust cache\n    const avatarUrlWithCache = `${avatarUrl}?t=${Date.now()}`\n    const avatarImageHtml = renderAvatarImage(avatarUrlWithCache, userData.first_name, userData.last_name)\n\n    // Use hx-swap-oob to update the avatar image container\n    const avatarImageWithOob = avatarImageHtml.replace(\n      'id=\"avatar-image-container\"',\n      'id=\"avatar-image-container\" hx-swap-oob=\"true\"'\n    )\n\n    return c.html(alertHtml + avatarImageWithOob)\n\n  } catch (error) {\n    console.error('Avatar upload error:', error)\n    return c.html(renderAlert({ \n      type: 'error', \n      message: 'Failed to upload profile picture. Please try again.',\n      dismissible: true \n    }))\n  }\n})\n\n/**\n * POST /admin/profile/password - Change user password\n */\nuserRoutes.post('/profile/password', async (c) => {\n  const user = c.get('user')\n  const db = c.env.DB\n\n  try {\n    const formData = await c.req.formData()\n    \n    const currentPassword = formData.get('current_password')?.toString() || ''\n    const newPassword = formData.get('new_password')?.toString() || ''\n    const confirmPassword = formData.get('confirm_password')?.toString() || ''\n\n    // Validate input\n    if (!currentPassword || !newPassword || !confirmPassword) {\n      return c.html(renderAlert({ \n        type: 'error', \n        message: 'All password fields are required.',\n        dismissible: true \n      }))\n    }\n\n    if (newPassword !== confirmPassword) {\n      return c.html(renderAlert({ \n        type: 'error', \n        message: 'New passwords do not match.',\n        dismissible: true \n      }))\n    }\n\n    if (newPassword.length < 8) {\n      return c.html(renderAlert({ \n        type: 'error', \n        message: 'New password must be at least 8 characters long.',\n        dismissible: true \n      }))\n    }\n\n    // Get current user data\n    const userStmt = db.prepare(`\n      SELECT password_hash FROM users WHERE id = ? AND is_active = 1\n    `)\n    const userData = await userStmt.bind(user!.userId).first() as any\n\n    if (!userData) {\n      return c.html(renderAlert({ \n        type: 'error', \n        message: 'User not found.',\n        dismissible: true \n      }))\n    }\n\n    // Verify current password\n    const validPassword = await AuthManager.verifyPassword(currentPassword, userData.password_hash)\n    if (!validPassword) {\n      return c.html(renderAlert({ \n        type: 'error', \n        message: 'Current password is incorrect.',\n        dismissible: true \n      }))\n    }\n\n    // Hash new password\n    const newPasswordHash = await AuthManager.hashPassword(newPassword)\n\n    // Store old password in history\n    const historyStmt = db.prepare(`\n      INSERT INTO password_history (id, user_id, password_hash, created_at)\n      VALUES (?, ?, ?, ?)\n    `)\n    await historyStmt.bind(\n      crypto.randomUUID(),\n      user!.userId,\n      userData.password_hash,\n      Date.now()\n    ).run()\n\n    // Update user password\n    const updateStmt = db.prepare(`\n      UPDATE users SET password_hash = ?, updated_at = ?\n      WHERE id = ?\n    `)\n    await updateStmt.bind(newPasswordHash, Date.now(), user!.userId).run()\n\n    // Log the activity\n    await logActivity(\n      db, user!.userId, 'profile.password_change', 'users', user!.userId,\n      null,\n      c.req.header('x-forwarded-for') || c.req.header('cf-connecting-ip'),\n      c.req.header('user-agent')\n    )\n\n    return c.html(renderAlert({ \n      type: 'success', \n      message: 'Password updated successfully!',\n      dismissible: true \n    }))\n\n  } catch (error) {\n    console.error('Password change error:', error)\n    return c.html(renderAlert({ \n      type: 'error', \n      message: 'Failed to update password. Please try again.',\n      dismissible: true \n    }))\n  }\n})\n\n/**\n * GET /admin/users - List all users\n * Returns HTML for browser requests and JSON for API requests\n * Note: Already protected by requireAuth() and requireRole(['admin', 'editor'])\n */\nuserRoutes.get('/users', async (c) => {\n  const db = c.env.DB\n  const user = c.get('user')\n\n  try {\n    // Get pagination parameters\n    const page = parseInt(c.req.query('page') || '1')\n    const limit = parseInt(c.req.query('limit') || '20')\n    const search = c.req.query('search') || ''\n    const roleFilter = c.req.query('role') || ''\n    const statusFilter = c.req.query('status') || 'active'\n    const offset = (page - 1) * limit\n\n    // Build search query\n    let whereClause = ''\n    let params: any[] = []\n\n    // Handle status filter\n    if (statusFilter === 'active') {\n      whereClause = 'WHERE u.is_active = 1'\n    } else if (statusFilter === 'inactive') {\n      whereClause = 'WHERE u.is_active = 0'\n    } else {\n      // 'all' - no filter\n      whereClause = 'WHERE 1=1'\n    }\n\n    if (search) {\n      whereClause += ' AND (u.first_name LIKE ? OR u.last_name LIKE ? OR u.email LIKE ? OR u.username LIKE ?)'\n      const searchParam = `%${search}%`\n      params.push(searchParam, searchParam, searchParam, searchParam)\n    }\n\n    if (roleFilter) {\n      whereClause += ' AND u.role = ?'\n      params.push(roleFilter)\n    }\n\n    // Get users\n    const usersStmt = db.prepare(`\n      SELECT u.id, u.email, u.username, u.first_name, u.last_name,\n             u.role, u.avatar_url, u.created_at, u.last_login_at, u.updated_at,\n             u.email_verified, u.two_factor_enabled, u.is_active\n      FROM users u\n      ${whereClause}\n      ORDER BY u.created_at DESC\n      LIMIT ? OFFSET ?\n    `)\n\n    const { results: usersData } = await usersStmt.bind(...params, limit, offset).all()\n\n    // Get total count\n    const countStmt = db.prepare(`\n      SELECT COUNT(*) as total FROM users u ${whereClause}\n    `)\n    const countResult = await countStmt.bind(...params).first() as any\n    const totalUsers = countResult?.total || 0\n\n    // Log the activity\n    await logActivity(\n      db, user!.userId, 'users.list_view', 'users', undefined,\n      { search, page, limit },\n      c.req.header('x-forwarded-for') || c.req.header('cf-connecting-ip'),\n      c.req.header('user-agent')\n    )\n\n    // Check if this is an API request (accept header contains 'application/json')\n    const acceptHeader = c.req.header('accept') || ''\n    const isApiRequest = acceptHeader.includes('application/json')\n\n    if (isApiRequest) {\n      // Return JSON for API requests\n      return c.json({\n        users: usersData || [],\n        pagination: {\n          page,\n          limit,\n          total: totalUsers,\n          pages: Math.ceil(totalUsers / limit)\n        }\n      })\n    }\n\n    // Return HTML for browser requests\n    const users: User[] = (usersData || []).map((u: any) => ({\n      id: u.id,\n      email: u.email,\n      username: u.username || '',\n      firstName: u.first_name || '',\n      lastName: u.last_name || '',\n      role: u.role,\n      avatar: u.avatar_url,\n      isActive: Boolean(u.is_active),\n      lastLoginAt: u.last_login_at,\n      createdAt: u.created_at,\n      updatedAt: u.updated_at,\n      formattedLastLogin: u.last_login_at ? new Date(u.last_login_at).toLocaleDateString() : undefined,\n      formattedCreatedAt: new Date(u.created_at).toLocaleDateString()\n    }))\n\n    const pageData: UsersListPageData = {\n      users,\n      currentPage: page,\n      totalPages: Math.ceil(totalUsers / limit),\n      totalUsers,\n      searchFilter: search,\n      roleFilter,\n      statusFilter,\n      pagination: {\n        currentPage: page,\n        totalPages: Math.ceil(totalUsers / limit),\n        totalItems: totalUsers,\n        itemsPerPage: limit,\n        startItem: offset + 1,\n        endItem: Math.min(offset + limit, totalUsers),\n        baseUrl: '/admin/users'\n      },\n      user: {\n        name: user!.email.split('@')[0] || user!.email,\n        email: user!.email,\n        role: user!.role\n      }\n    }\n\n    return c.html(renderUsersListPage(pageData))\n\n  } catch (error) {\n    console.error('Users list error:', error)\n\n    const acceptHeader = c.req.header('accept') || ''\n    const isApiRequest = acceptHeader.includes('application/json')\n\n    if (isApiRequest) {\n      return c.json({ error: 'Failed to load users' }, 500)\n    }\n\n    return c.html(renderAlert({\n      type: 'error',\n      message: 'Failed to load users. Please try again.',\n      dismissible: true\n    }), 500)\n  }\n})\n\n/**\n * GET /admin/users/new - Show new user creation page\n */\nuserRoutes.get('/users/new', async (c) => {\n  const user = c.get('user')\n\n  try {\n    const pageData: UserNewPageData = {\n      roles: ROLES,\n      user: {\n        name: user!.email.split('@')[0] || user!.email,\n        email: user!.email,\n        role: user!.role\n      }\n    }\n\n    return c.html(renderUserNewPage(pageData))\n  } catch (error) {\n    console.error('User new page error:', error)\n\n    return c.html(renderAlert({\n      type: 'error',\n      message: 'Failed to load user creation page. Please try again.',\n      dismissible: true\n    }), 500)\n  }\n})\n\n/**\n * POST /admin/users/new - Create new user\n */\nuserRoutes.post('/users/new', async (c) => {\n  const db = c.env.DB\n  const user = c.get('user')\n\n  try {\n    const formData = await c.req.formData()\n\n    // Sanitize all user inputs to prevent XSS attacks\n    const firstName = sanitizeInput(formData.get('first_name')?.toString())\n    const lastName = sanitizeInput(formData.get('last_name')?.toString())\n    const username = sanitizeInput(formData.get('username')?.toString())\n    const email = formData.get('email')?.toString()?.trim().toLowerCase() || ''\n    const phone = sanitizeInput(formData.get('phone')?.toString()) || null\n    const bio = sanitizeInput(formData.get('bio')?.toString()) || null\n    const role = formData.get('role')?.toString() || 'viewer'\n    const password = formData.get('password')?.toString() || ''\n    const confirmPassword = formData.get('confirm_password')?.toString() || ''\n    const isActive = formData.get('is_active') === '1'\n    const emailVerified = formData.get('email_verified') === '1'\n\n    // Validate required fields\n    if (!firstName || !lastName || !username || !email || !password) {\n      return c.html(renderAlert({\n        type: 'error',\n        message: 'First name, last name, username, email, and password are required.',\n        dismissible: true\n      }))\n    }\n\n    // Validate email format\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/\n    if (!emailRegex.test(email)) {\n      return c.html(renderAlert({\n        type: 'error',\n        message: 'Please enter a valid email address.',\n        dismissible: true\n      }))\n    }\n\n    // Validate password\n    if (password.length < 8) {\n      return c.html(renderAlert({\n        type: 'error',\n        message: 'Password must be at least 8 characters long.',\n        dismissible: true\n      }))\n    }\n\n    if (password !== confirmPassword) {\n      return c.html(renderAlert({\n        type: 'error',\n        message: 'Passwords do not match.',\n        dismissible: true\n      }))\n    }\n\n    // Check if username/email are already taken\n    const checkStmt = db.prepare(`\n      SELECT id FROM users\n      WHERE username = ? OR email = ?\n    `)\n    const existingUser = await checkStmt.bind(username, email).first()\n\n    if (existingUser) {\n      return c.html(renderAlert({\n        type: 'error',\n        message: 'Username or email is already taken.',\n        dismissible: true\n      }))\n    }\n\n    // Hash password\n    const passwordHash = await AuthManager.hashPassword(password)\n\n    // Create user\n    const userId = crypto.randomUUID()\n    const createStmt = db.prepare(`\n      INSERT INTO users (\n        id, email, username, first_name, last_name, phone, bio,\n        password_hash, role, is_active, email_verified, created_at, updated_at\n      ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n    `)\n\n    await createStmt.bind(\n      userId, email, username, firstName, lastName, phone, bio,\n      passwordHash, role, isActive ? 1 : 0, emailVerified ? 1 : 0,\n      Date.now(), Date.now()\n    ).run()\n\n    // Log the activity\n    await logActivity(\n      db, user!.userId, 'user!.create', 'users', userId,\n      { email, username, role },\n      c.req.header('x-forwarded-for') || c.req.header('cf-connecting-ip'),\n      c.req.header('user-agent')\n    )\n\n    // Redirect to user edit page\n    return c.redirect(`/admin/users/${userId}/edit?success=User created successfully`)\n\n  } catch (error) {\n    console.error('User creation error:', error)\n    return c.html(renderAlert({\n      type: 'error',\n      message: 'Failed to create user!. Please try again.',\n      dismissible: true\n    }))\n  }\n})\n\n/**\n * GET /admin/users/:id - Get user by ID\n * Note: This endpoint returns users regardless of is_active status for admin purposes\n */\nuserRoutes.get('/users/:id', async (c) => {\n  // Check if this is actually the edit route\n  if (c.req.path.endsWith('/edit')) {\n    return c.notFound()\n  }\n\n  const db = c.env.DB\n  const user = c.get('user')\n  const userId = c.req.param('id')\n\n  try {\n    // Get user data (including inactive users for admin access)\n    const userStmt = db.prepare(`\n      SELECT id, email, username, first_name, last_name, phone, bio, avatar_url,\n             role, is_active, email_verified, two_factor_enabled, created_at, last_login_at\n      FROM users\n      WHERE id = ?\n    `)\n\n    const userRecord = await userStmt.bind(userId).first() as any\n\n    if (!userRecord) {\n      return c.json({ error: 'User not found' }, 404)\n    }\n\n    // Log the activity\n    await logActivity(\n      db, user!.userId, 'user!.view', 'users', userId,\n      null,\n      c.req.header('x-forwarded-for') || c.req.header('cf-connecting-ip'),\n      c.req.header('user-agent')\n    )\n\n    return c.json({\n      user: {\n        id: userRecord.id,\n        email: userRecord.email,\n        username: userRecord.username,\n        first_name: userRecord.first_name,\n        last_name: userRecord.last_name,\n        phone: userRecord.phone,\n        bio: userRecord.bio,\n        avatar_url: userRecord.avatar_url,\n        role: userRecord.role,\n        is_active: userRecord.is_active,\n        email_verified: userRecord.email_verified,\n        two_factor_enabled: userRecord.two_factor_enabled,\n        created_at: userRecord.created_at,\n        last_login_at: userRecord.last_login_at\n      }\n    })\n\n  } catch (error) {\n    console.error('User fetch error:', error)\n    return c.json({ error: 'Failed to fetch user' }, 500)\n  }\n})\n\n/**\n * GET /admin/users/:id/edit - Show user edit page\n */\nuserRoutes.get('/users/:id/edit', async (c) => {\n  const db = c.env.DB\n  const user = c.get('user')\n  const userId = c.req.param('id')\n\n  try {\n    // Get user data (removed bio - now in profile)\n    const userStmt = db.prepare(`\n      SELECT id, email, username, first_name, last_name, phone, avatar_url,\n             role, is_active, email_verified, two_factor_enabled, created_at, last_login_at\n      FROM users\n      WHERE id = ?\n    `)\n\n    const userToEdit = await userStmt.bind(userId).first() as any\n\n    if (!userToEdit) {\n      return c.html(renderAlert({\n        type: 'error',\n        message: 'User not found',\n        dismissible: true\n      }), 404)\n    }\n\n    // Get user profile data\n    const profileStmt = db.prepare(`\n      SELECT display_name, bio, company, job_title, website, location, date_of_birth\n      FROM user_profiles\n      WHERE user_id = ?\n    `)\n    const profileData = await profileStmt.bind(userId).first() as any\n\n    // Convert profile to UserProfileData interface\n    const profile: UserProfileData | undefined = profileData ? {\n      displayName: profileData.display_name,\n      bio: profileData.bio,\n      company: profileData.company,\n      jobTitle: profileData.job_title,\n      website: profileData.website,\n      location: profileData.location,\n      dateOfBirth: profileData.date_of_birth\n    } : undefined\n\n    // Convert to UserEditData interface\n    const editData: UserEditData = {\n      id: userToEdit.id,\n      email: userToEdit.email,\n      username: userToEdit.username || '',\n      firstName: userToEdit.first_name || '',\n      lastName: userToEdit.last_name || '',\n      phone: userToEdit.phone,\n      avatarUrl: userToEdit.avatar_url,\n      role: userToEdit.role,\n      isActive: Boolean(userToEdit.is_active),\n      emailVerified: Boolean(userToEdit.email_verified),\n      twoFactorEnabled: Boolean(userToEdit.two_factor_enabled),\n      createdAt: userToEdit.created_at,\n      lastLoginAt: userToEdit.last_login_at,\n      profile\n    }\n\n    const pageData: UserEditPageData = {\n      userToEdit: editData,\n      roles: ROLES,\n      user: {\n        name: user!.email.split('@')[0] || user!.email,\n        email: user!.email,\n        role: user!.role\n      }\n    }\n\n    return c.html(renderUserEditPage(pageData))\n  } catch (error) {\n    console.error('User edit page error:', error)\n\n    return c.html(renderAlert({\n      type: 'error',\n      message: 'Failed to load user. Please try again.',\n      dismissible: true\n    }), 500)\n  }\n})\n\n/**\n * PUT /admin/users/:id - Update user\n */\nuserRoutes.put('/users/:id', async (c) => {\n  const db = c.env.DB\n  const user = c.get('user')\n  const userId = c.req.param('id')\n\n  try {\n    const formData = await c.req.formData()\n\n    // Sanitize all user inputs to prevent XSS attacks\n    const firstName = sanitizeInput(formData.get('first_name')?.toString())\n    const lastName = sanitizeInput(formData.get('last_name')?.toString())\n    const username = sanitizeInput(formData.get('username')?.toString())\n    const email = formData.get('email')?.toString()?.trim().toLowerCase() || ''\n    const phone = sanitizeInput(formData.get('phone')?.toString()) || null\n    const role = formData.get('role')?.toString() || 'viewer'\n    const isActive = formData.get('is_active') === '1'\n    const emailVerified = formData.get('email_verified') === '1'\n\n    // Extract profile fields\n    const profileDisplayName = sanitizeInput(formData.get('profile_display_name')?.toString()) || null\n    const profileBio = sanitizeInput(formData.get('profile_bio')?.toString()) || null\n    const profileCompany = sanitizeInput(formData.get('profile_company')?.toString()) || null\n    const profileJobTitle = sanitizeInput(formData.get('profile_job_title')?.toString()) || null\n    const profileWebsite = formData.get('profile_website')?.toString()?.trim() || null\n    const profileLocation = sanitizeInput(formData.get('profile_location')?.toString()) || null\n    const profileDateOfBirthStr = formData.get('profile_date_of_birth')?.toString()?.trim() || null\n    const profileDateOfBirth = profileDateOfBirthStr ? new Date(profileDateOfBirthStr).getTime() : null\n\n    // Validate required fields\n    if (!firstName || !lastName || !username || !email) {\n      return c.html(renderAlert({\n        type: 'error',\n        message: 'First name, last name, username, and email are required.',\n        dismissible: true\n      }))\n    }\n\n    // Validate email format\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/\n    if (!emailRegex.test(email)) {\n      return c.html(renderAlert({\n        type: 'error',\n        message: 'Please enter a valid email address.',\n        dismissible: true\n      }))\n    }\n\n    // Validate website URL if provided\n    if (profileWebsite) {\n      try {\n        new URL(profileWebsite)\n      } catch {\n        return c.html(renderAlert({\n          type: 'error',\n          message: 'Please enter a valid website URL.',\n          dismissible: true\n        }))\n      }\n    }\n\n    // Check if username/email are taken by another user\n    const checkStmt = db.prepare(`\n      SELECT id FROM users\n      WHERE (username = ? OR email = ?) AND id != ?\n    `)\n    const existingUser = await checkStmt.bind(username, email, userId).first()\n\n    if (existingUser) {\n      return c.html(renderAlert({\n        type: 'error',\n        message: 'Username or email is already taken by another user.',\n        dismissible: true\n      }))\n    }\n\n    // Update user (removed bio - now in profile)\n    const updateStmt = db.prepare(`\n      UPDATE users SET\n        first_name = ?, last_name = ?, username = ?, email = ?,\n        phone = ?, role = ?, is_active = ?, email_verified = ?,\n        updated_at = ?\n      WHERE id = ?\n    `)\n\n    await updateStmt.bind(\n      firstName, lastName, username, email,\n      phone, role, isActive ? 1 : 0, emailVerified ? 1 : 0,\n      Date.now(), userId\n    ).run()\n\n    // Check if any profile field has data\n    const hasProfileData = profileDisplayName || profileBio || profileCompany ||\n      profileJobTitle || profileWebsite || profileLocation || profileDateOfBirth\n\n    if (hasProfileData) {\n      const now = Date.now()\n\n      // Check if profile exists\n      const profileCheckStmt = db.prepare(`SELECT id FROM user_profiles WHERE user_id = ?`)\n      const existingProfile = await profileCheckStmt.bind(userId).first() as any\n\n      if (existingProfile) {\n        // Update existing profile\n        const updateProfileStmt = db.prepare(`\n          UPDATE user_profiles SET\n            display_name = ?, bio = ?, company = ?, job_title = ?,\n            website = ?, location = ?, date_of_birth = ?, updated_at = ?\n          WHERE user_id = ?\n        `)\n        await updateProfileStmt.bind(\n          profileDisplayName, profileBio, profileCompany, profileJobTitle,\n          profileWebsite, profileLocation, profileDateOfBirth, now, userId\n        ).run()\n      } else {\n        // Create new profile\n        const profileId = `profile_${Date.now()}_${Math.random().toString(36).substring(2, 9)}`\n        const insertProfileStmt = db.prepare(`\n          INSERT INTO user_profiles (id, user_id, display_name, bio, company, job_title, website, location, date_of_birth, created_at, updated_at)\n          VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n        `)\n        await insertProfileStmt.bind(\n          profileId, userId, profileDisplayName, profileBio, profileCompany, profileJobTitle,\n          profileWebsite, profileLocation, profileDateOfBirth, now, now\n        ).run()\n      }\n    }\n\n    // Log the activity\n    await logActivity(\n      db, user!.userId, 'user.update', 'users', userId,\n      { fields: ['first_name', 'last_name', 'username', 'email', 'phone', 'role', 'is_active', 'email_verified', 'profile'] },\n      c.req.header('x-forwarded-for') || c.req.header('cf-connecting-ip'),\n      c.req.header('user-agent')\n    )\n\n    return c.html(renderAlert({\n      type: 'success',\n      message: 'User updated successfully!',\n      dismissible: true\n    }))\n\n  } catch (error) {\n    console.error('User update error:', error)\n    return c.html(renderAlert({\n      type: 'error',\n      message: 'Failed to update user. Please try again.',\n      dismissible: true\n    }))\n  }\n})\n\n/**\n * POST /admin/users/:id/toggle - Toggle user active status\n */\nuserRoutes.post('/users/:id/toggle', async (c) => {\n  const db = c.env.DB\n  const user = c.get('user')\n  const userId = c.req.param('id')\n\n  try {\n    const body = await c.req.json().catch(() => ({ active: true }))\n    const active = body.active === true\n\n    // Prevent self-deactivation\n    if (userId === user!.userId && !active) {\n      return c.json({ error: 'You cannot deactivate your own account' }, 400)\n    }\n\n    // Check if user exists\n    const userStmt = db.prepare(`\n      SELECT id, email FROM users WHERE id = ?\n    `)\n    const userToToggle = await userStmt.bind(userId).first() as any\n\n    if (!userToToggle) {\n      return c.json({ error: 'User not found' }, 404)\n    }\n\n    // Toggle user status\n    const toggleStmt = db.prepare(`\n      UPDATE users SET is_active = ?, updated_at = ? WHERE id = ?\n    `)\n    await toggleStmt.bind(active ? 1 : 0, Date.now(), userId).run()\n\n    // Log the activity\n    await logActivity(\n      db, user!.userId, active ? 'user.activate' : 'user.deactivate', 'users', userId,\n      { email: userToToggle.email },\n      c.req.header('x-forwarded-for') || c.req.header('cf-connecting-ip'),\n      c.req.header('user-agent')\n    )\n\n    return c.json({\n      success: true,\n      message: active ? 'User activated successfully' : 'User deactivated successfully'\n    })\n\n  } catch (error) {\n    console.error('User toggle error:', error)\n    return c.json({ error: 'Failed to toggle user status' }, 500)\n  }\n})\n\n/**\n * DELETE /admin/users/:id - Delete user\n */\nuserRoutes.delete('/users/:id', async (c) => {\n  const db = c.env.DB\n  const user = c.get('user')\n  const userId = c.req.param('id')\n\n  try {\n    // Get request body to check for hard delete option\n    const body = await c.req.json().catch(() => ({ hardDelete: false }))\n    const hardDelete = body.hardDelete === true\n\n    // Prevent self-deletion\n    if (userId === user!.userId) {\n      return c.json({ error: 'You cannot delete your own account' }, 400)\n    }\n\n    // Check if user exists\n    const userStmt = db.prepare(`\n      SELECT id, email FROM users WHERE id = ?\n    `)\n    const userToDelete = await userStmt.bind(userId).first() as any\n\n    if (!userToDelete) {\n      return c.json({ error: 'User not found' }, 404)\n    }\n\n    if (hardDelete) {\n      // Hard delete - permanently remove from database\n      const deleteStmt = db.prepare(`\n        DELETE FROM users WHERE id = ?\n      `)\n      await deleteStmt.bind(userId).run()\n\n      // Log the activity\n      await logActivity(\n        db, user!.userId, 'user!.hard_delete', 'users', userId,\n        { email: userToDelete.email, permanent: true },\n        c.req.header('x-forwarded-for') || c.req.header('cf-connecting-ip'),\n        c.req.header('user-agent')\n      )\n\n      return c.json({\n        success: true,\n        message: 'User permanently deleted'\n      })\n    } else {\n      // Soft delete - deactivate by setting is_active = 0\n      const deleteStmt = db.prepare(`\n        UPDATE users SET is_active = 0, updated_at = ? WHERE id = ?\n      `)\n      await deleteStmt.bind(Date.now(), userId).run()\n\n      // Log the activity\n      await logActivity(\n        db, user!.userId, 'user!.soft_delete', 'users', userId,\n        { email: userToDelete.email },\n        c.req.header('x-forwarded-for') || c.req.header('cf-connecting-ip'),\n        c.req.header('user-agent')\n      )\n\n      return c.json({\n        success: true,\n        message: 'User deactivated successfully'\n      })\n    }\n\n  } catch (error) {\n    console.error('User deletion error:', error)\n    return c.json({ error: 'Failed to delete user' }, 500)\n  }\n})\n\n/**\n * POST /admin/invite-user - Invite a new user\n */\nuserRoutes.post('/invite-user', async (c) => {\n  const db = c.env.DB\n  const user = c.get('user')\n\n  try {\n    const formData = await c.req.formData()\n\n    // Sanitize all user inputs to prevent XSS attacks\n    const email = formData.get('email')?.toString()?.trim().toLowerCase() || ''\n    const role = formData.get('role')?.toString()?.trim() || 'viewer'\n    const firstName = sanitizeInput(formData.get('first_name')?.toString())\n    const lastName = sanitizeInput(formData.get('last_name')?.toString())\n\n    // Validate input\n    if (!email || !firstName || !lastName) {\n      return c.json({ error: 'Email, first name, and last name are required' }, 400)\n    }\n\n    // Validate email format\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/\n    if (!emailRegex.test(email)) {\n      return c.json({ error: 'Please enter a valid email address' }, 400)\n    }\n\n    // Check if user already exists\n    const existingUserStmt = db.prepare(`\n      SELECT id FROM users WHERE email = ?\n    `)\n    const existingUser = await existingUserStmt.bind(email).first()\n\n    if (existingUser) {\n      return c.json({ error: 'A user with this email already exists' }, 400)\n    }\n\n    // Generate invitation token\n    const invitationToken = crypto.randomUUID()\n    // const invitationExpires = Date.now() + (7 * 24 * 60 * 60 * 1000) // 7 days\n\n    // Create user record with invitation\n    const userId = crypto.randomUUID()\n    const createUserStmt = db.prepare(`\n      INSERT INTO users (\n        id, email, first_name, last_name, role, \n        invitation_token, invited_by, invited_at,\n        is_active, email_verified, created_at, updated_at\n      ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n    `)\n\n    await createUserStmt.bind(\n      userId, email, firstName, lastName, role,\n      invitationToken, user!.userId, Date.now(),\n      0, 0, Date.now(), Date.now()\n    ).run()\n\n    // Log the activity\n    await logActivity(\n      db, user!.userId, 'user!.invite_sent', 'users', userId,\n      { email, role, invited_user_id: userId },\n      c.req.header('x-forwarded-for') || c.req.header('cf-connecting-ip'),\n      c.req.header('user-agent')\n    )\n\n    // In a real implementation, you would send an email here\n    // For now, we'll return the invitation link\n    const invitationLink = `${c.req.header('origin') || 'http://localhost:8787'}/auth/accept-invitation?token=${invitationToken}`\n\n    return c.json({\n      success: true,\n      message: 'User invitation sent successfully',\n      user: {\n        id: userId,\n        email,\n        first_name: firstName,\n        last_name: lastName,\n        role\n      },\n      invitation_link: invitationLink // In production, this would be sent via email\n    })\n\n  } catch (error) {\n    console.error('User invitation error:', error)\n    return c.json({ error: 'Failed to send user invitation' }, 500)\n  }\n})\n\n/**\n * POST /admin/resend-invitation/:id - Resend invitation\n */\nuserRoutes.post('/resend-invitation/:id', async (c) => {\n  const db = c.env.DB\n  const user = c.get('user')\n  const userId = c.req.param('id')\n\n  try {\n    // Check if user exists and is invited but not active\n    const userStmt = db.prepare(`\n      SELECT id, email, first_name, last_name, role, invitation_token\n      FROM users \n      WHERE id = ? AND is_active = 0 AND invitation_token IS NOT NULL\n    `)\n    const invitedUser = await userStmt.bind(userId).first() as any\n\n    if (!invitedUser) {\n      return c.json({ error: 'User not found or invitation not valid' }, 404)\n    }\n\n    // Generate new invitation token\n    const newInvitationToken = crypto.randomUUID()\n\n    // Update invitation token and date\n    const updateStmt = db.prepare(`\n      UPDATE users SET \n        invitation_token = ?, \n        invited_at = ?, \n        updated_at = ?\n      WHERE id = ?\n    `)\n\n    await updateStmt.bind(\n      newInvitationToken,\n      Date.now(),\n      Date.now(),\n      userId\n    ).run()\n\n    // Log the activity\n    await logActivity(\n      db, user!.userId, 'user!.invitation_resent', 'users', userId,\n      { email: invitedUser.email },\n      c.req.header('x-forwarded-for') || c.req.header('cf-connecting-ip'),\n      c.req.header('user-agent')\n    )\n\n    // Generate new invitation link\n    const invitationLink = `${c.req.header('origin') || 'http://localhost:8787'}/auth/accept-invitation?token=${newInvitationToken}`\n\n    return c.json({\n      success: true,\n      message: 'Invitation resent successfully',\n      invitation_link: invitationLink\n    })\n\n  } catch (error) {\n    console.error('Resend invitation error:', error)\n    return c.json({ error: 'Failed to resend invitation' }, 500)\n  }\n})\n\n/**\n * DELETE /admin/cancel-invitation/:id - Cancel invitation\n */\nuserRoutes.delete('/cancel-invitation/:id', async (c) => {\n  const db = c.env.DB\n  const user = c.get('user')\n  const userId = c.req.param('id')\n\n  try {\n    // Check if user exists and is invited but not active\n    const userStmt = db.prepare(`\n      SELECT id, email FROM users \n      WHERE id = ? AND is_active = 0 AND invitation_token IS NOT NULL\n    `)\n    const invitedUser = await userStmt.bind(userId).first() as any\n\n    if (!invitedUser) {\n      return c.json({ error: 'User not found or invitation not valid' }, 404)\n    }\n\n    // Delete the user record (since they haven't activated yet)\n    const deleteStmt = db.prepare(`DELETE FROM users WHERE id = ?`)\n    await deleteStmt.bind(userId).run()\n\n    // Log the activity\n    await logActivity(\n      db, user!.userId, 'user!.invitation_cancelled', 'users', userId,\n      { email: invitedUser.email },\n      c.req.header('x-forwarded-for') || c.req.header('cf-connecting-ip'),\n      c.req.header('user-agent')\n    )\n\n    return c.json({\n      success: true,\n      message: 'Invitation cancelled successfully'\n    })\n\n  } catch (error) {\n    console.error('Cancel invitation error:', error)\n    return c.json({ error: 'Failed to cancel invitation' }, 500)\n  }\n})\n\n/**\n * GET /admin/activity-logs - View activity logs\n */\nuserRoutes.get('/activity-logs', async (c) => {\n  const db = c.env.DB\n  const user = c.get('user')\n\n  try {\n    // Get pagination and filter parameters\n    const page = parseInt(c.req.query('page') || '1')\n    const limit = parseInt(c.req.query('limit') || '50')\n    const offset = (page - 1) * limit\n\n    const filters = {\n      action: c.req.query('action') || '',\n      resource_type: c.req.query('resource_type') || '',\n      date_from: c.req.query('date_from') || '',\n      date_to: c.req.query('date_to') || '',\n      user_id: c.req.query('user_id') || ''\n    }\n\n    // Build where clause\n    let whereConditions: string[] = []\n    let params: any[] = []\n\n    if (filters.action) {\n      whereConditions.push('al.action = ?')\n      params.push(filters.action)\n    }\n\n    if (filters.resource_type) {\n      whereConditions.push('al.resource_type = ?')\n      params.push(filters.resource_type)\n    }\n\n    if (filters.user_id) {\n      whereConditions.push('al.user_id = ?')\n      params.push(filters.user_id)\n    }\n\n    if (filters.date_from) {\n      const fromTimestamp = new Date(filters.date_from).getTime()\n      whereConditions.push('al.created_at >= ?')\n      params.push(fromTimestamp)\n    }\n\n    if (filters.date_to) {\n      const toTimestamp = new Date(filters.date_to + ' 23:59:59').getTime()\n      whereConditions.push('al.created_at <= ?')\n      params.push(toTimestamp)\n    }\n\n    const whereClause = whereConditions.length > 0 ? `WHERE ${whereConditions.join(' AND ')}` : ''\n\n    // Get activity logs with user information\n    const logsStmt = db.prepare(`\n      SELECT \n        al.id, al.user_id, al.action, al.resource_type, al.resource_id,\n        al.details, al.ip_address, al.user_agent, al.created_at,\n        u.email as user_email,\n        COALESCE(u.first_name || ' ' || u.last_name, u.username, u.email) as user_name\n      FROM activity_logs al\n      LEFT JOIN users u ON al.user_id = u.id\n      ${whereClause}\n      ORDER BY al.created_at DESC\n      LIMIT ? OFFSET ?\n    `)\n\n    const { results: logs } = await logsStmt.bind(...params, limit, offset).all()\n\n    // Get total count for pagination\n    const countStmt = db.prepare(`\n      SELECT COUNT(*) as total \n      FROM activity_logs al\n      LEFT JOIN users u ON al.user_id = u.id\n      ${whereClause}\n    `)\n    const countResult = await countStmt.bind(...params).first() as any\n    const totalLogs = countResult?.total || 0\n\n    // Parse details JSON for each log\n    const formattedLogs: ActivityLog[] = (logs || []).map((log: any) => ({\n      ...log,\n      details: log.details ? JSON.parse(log.details) : null\n    }))\n\n    // Log the activity\n    await logActivity(\n      db, user!.userId, 'activity.logs_viewed', undefined, undefined,\n      { filters, page, limit },\n      c.req.header('x-forwarded-for') || c.req.header('cf-connecting-ip'),\n      c.req.header('user-agent')\n    )\n\n    const pageData: ActivityLogsPageData = {\n      logs: formattedLogs,\n      pagination: {\n        page,\n        limit,\n        total: totalLogs,\n        pages: Math.ceil(totalLogs / limit)\n      },\n      filters,\n      user: {\n        name: user!.email.split('@')[0] || user!.email, // Use email username as fallback\n        email: user!.email,\n        role: user!.role\n      }\n    }\n\n    return c.html(renderActivityLogsPage(pageData))\n\n  } catch (error) {\n    console.error('Activity logs error:', error)\n    \n    const pageData: ActivityLogsPageData = {\n      logs: [],\n      pagination: { page: 1, limit: 50, total: 0, pages: 0 },\n      filters: {},\n      user: {\n        name: user!.email,\n        email: user!.email,\n        role: user!.role\n      }\n    }\n\n    return c.html(renderActivityLogsPage(pageData))\n  }\n})\n\n/**\n * GET /admin/activity-logs/export - Export activity logs to CSV\n */\nuserRoutes.get('/activity-logs/export', async (c) => {\n  const db = c.env.DB\n  const user = c.get('user')\n\n  try {\n    // Get filter parameters (same as list view)\n    const filters = {\n      action: c.req.query('action') || '',\n      resource_type: c.req.query('resource_type') || '',\n      date_from: c.req.query('date_from') || '',\n      date_to: c.req.query('date_to') || '',\n      user_id: c.req.query('user_id') || ''\n    }\n\n    // Build where clause\n    let whereConditions: string[] = []\n    let params: any[] = []\n\n    if (filters.action) {\n      whereConditions.push('al.action = ?')\n      params.push(filters.action)\n    }\n\n    if (filters.resource_type) {\n      whereConditions.push('al.resource_type = ?')\n      params.push(filters.resource_type)\n    }\n\n    if (filters.user_id) {\n      whereConditions.push('al.user_id = ?')\n      params.push(filters.user_id)\n    }\n\n    if (filters.date_from) {\n      const fromTimestamp = new Date(filters.date_from).getTime()\n      whereConditions.push('al.created_at >= ?')\n      params.push(fromTimestamp)\n    }\n\n    if (filters.date_to) {\n      const toTimestamp = new Date(filters.date_to + ' 23:59:59').getTime()\n      whereConditions.push('al.created_at <= ?')\n      params.push(toTimestamp)\n    }\n\n    const whereClause = whereConditions.length > 0 ? `WHERE ${whereConditions.join(' AND ')}` : ''\n\n    // Get all matching activity logs (limit to 10,000 for performance)\n    const logsStmt = db.prepare(`\n      SELECT \n        al.id, al.user_id, al.action, al.resource_type, al.resource_id,\n        al.details, al.ip_address, al.user_agent, al.created_at,\n        u.email as user_email,\n        COALESCE(u.first_name || ' ' || u.last_name, u.username, u.email) as user_name\n      FROM activity_logs al\n      LEFT JOIN users u ON al.user_id = u.id\n      ${whereClause}\n      ORDER BY al.created_at DESC\n      LIMIT 10000\n    `)\n\n    const { results: logs } = await logsStmt.bind(...params).all()\n\n    // Generate CSV content\n    const csvHeaders = ['Timestamp', 'User', 'Email', 'Action', 'Resource Type', 'Resource ID', 'IP Address', 'Details']\n    const csvRows = [csvHeaders.join(',')]\n\n    for (const log of (logs || [])) {\n      const row = [\n        `\"${new Date((log as any).created_at).toISOString()}\"`,\n        `\"${(log as any).user_name || 'Unknown'}\"`,\n        `\"${(log as any).user_email || 'N/A'}\"`,\n        `\"${(log as any).action}\"`,\n        `\"${(log as any).resource_type || 'N/A'}\"`,\n        `\"${(log as any).resource_id || 'N/A'}\"`,\n        `\"${(log as any).ip_address || 'N/A'}\"`,\n        `\"${(log as any).details ? JSON.stringify(JSON.parse((log as any).details)) : 'N/A'}\"`\n      ]\n      csvRows.push(row.join(','))\n    }\n\n    const csvContent = csvRows.join('\\n')\n\n    // Log the export activity\n    await logActivity(\n      db, user!.userId, 'activity.logs_exported', undefined, undefined,\n      { filters, count: logs?.length || 0 },\n      c.req.header('x-forwarded-for') || c.req.header('cf-connecting-ip'),\n      c.req.header('user-agent')\n    )\n\n    // Return CSV file\n    const filename = `activity-logs-${new Date().toISOString().split('T')[0]}.csv`\n    \n    return new Response(csvContent, {\n      headers: {\n        'Content-Type': 'text/csv',\n        'Content-Disposition': `attachment; filename=\"${filename}\"`\n      }\n    })\n\n  } catch (error) {\n    console.error('Activity logs export error:', error)\n    return c.json({ error: 'Failed to export activity logs' }, 500)\n  }\n})\n\nexport { userRoutes }","import { renderAdminLayoutCatalyst, AdminLayoutCatalystData } from '../layouts/admin-layout-catalyst.template'\n\ninterface BaseUser {\n  name: string\n  email: string\n  role: string\n}\n\nexport interface LogEntry {\n  id: string\n  level: string\n  category: string\n  message: string\n  data?: any\n  userId?: string\n  sessionId?: string\n  requestId?: string\n  ipAddress?: string\n  userAgent?: string\n  method?: string\n  url?: string\n  statusCode?: number\n  duration?: number\n  stackTrace?: string\n  tags: string[]\n  source?: string\n  createdAt: Date\n  formattedDate: string\n  formattedDuration?: string\n  levelClass: string\n  categoryClass: string\n}\n\nexport interface LogsListPageData {\n  logs: LogEntry[]\n  pagination: {\n    currentPage: number\n    totalPages: number\n    totalItems: number\n    itemsPerPage: number\n    startItem: number\n    endItem: number\n    baseUrl: string\n  }\n  filters: {\n    level: string\n    category: string\n    search: string\n    startDate: string\n    endDate: string\n    source: string\n  }\n  user?: BaseUser\n}\n\nexport function renderLogsListPage(data: LogsListPageData) {\n  const { logs, pagination, filters, user } = data\n\n  const content = `\n    <div>\n      <div class=\"sm:flex sm:items-center sm:justify-between mb-6\">\n        <div class=\"sm:flex-auto\">\n          <h1 class=\"text-2xl/8 font-semibold text-zinc-950 dark:text-white sm:text-xl/8\">System Logs</h1>\n          <p class=\"mt-2 text-sm/6 text-zinc-500 dark:text-zinc-400\">\n            Monitor and analyze system activity, errors, and performance metrics.\n          </p>\n        </div>\n        <div class=\"mt-4 sm:mt-0 sm:ml-16 flex gap-x-2\">\n          <a\n            href=\"/admin/logs/config\"\n            class=\"inline-flex items-center justify-center rounded-lg bg-white dark:bg-zinc-800 px-3.5 py-2.5 text-sm font-semibold text-zinc-950 dark:text-white hover:bg-zinc-50 dark:hover:bg-zinc-700 ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 transition-colors shadow-sm\"\n          >\n            Configure\n          </a>\n          <a\n            href=\"/admin/logs/export?${new URLSearchParams(filters).toString()}\"\n            class=\"inline-flex items-center justify-center rounded-lg bg-zinc-950 dark:bg-white px-3.5 py-2.5 text-sm font-semibold text-white dark:text-zinc-950 hover:bg-zinc-800 dark:hover:bg-zinc-100 transition-colors shadow-sm\"\n          >\n            Export\n          </a>\n        </div>\n      </div>\n\n      <!-- Filters -->\n      <div class=\"relative rounded-xl overflow-hidden mb-6\">\n        <!-- Gradient Background -->\n        <div class=\"absolute inset-0 bg-gradient-to-r from-cyan-500/10 via-blue-500/10 to-purple-500/10 dark:from-cyan-400/20 dark:via-blue-400/20 dark:to-purple-400/20\"></div>\n\n        <div class=\"relative bg-white/80 dark:bg-zinc-900/80 backdrop-blur-xl shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10\">\n          <div class=\"px-6 py-5\">\n            <form method=\"GET\" action=\"/admin/logs\" class=\"space-y-4\">\n              <div class=\"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4\">\n                <div class=\"relative group\">\n                  <label for=\"search\" class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Search</label>\n                  <div class=\"relative\">\n                    <div class=\"absolute left-3.5 top-2.5 flex items-center justify-center w-5 h-5 rounded-full bg-gradient-to-br from-cyan-400 to-blue-500 dark:from-cyan-300 dark:to-blue-400 opacity-90 group-focus-within:opacity-100 transition-opacity\">\n                      <svg class=\"h-3 w-3 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" stroke-width=\"2.5\">\n                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"/>\n                      </svg>\n                    </div>\n                    <input\n                      type=\"text\"\n                      name=\"search\"\n                      id=\"search\"\n                      value=\"${filters.search}\"\n                      placeholder=\"Search messages...\"\n                      class=\"w-full rounded-full bg-transparent pl-11 pr-4 py-2 text-sm text-zinc-950 dark:text-white placeholder-zinc-500 dark:placeholder-zinc-400 border-2 border-cyan-200/50 dark:border-cyan-700/50 focus:outline-none focus:border-cyan-500 dark:focus:border-cyan-400 focus:shadow-lg focus:shadow-cyan-500/20 dark:focus:shadow-cyan-400/20 transition-all duration-300\"\n                    />\n                  </div>\n                </div>\n\n                <div>\n                  <label for=\"level\" class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Level</label>\n                  <select\n                    name=\"level\"\n                    id=\"level\"\n                    class=\"w-full rounded-lg bg-white/90 dark:bg-zinc-800/90 backdrop-blur-sm px-4 py-2 text-sm text-zinc-950 dark:text-white border-2 border-cyan-200/50 dark:border-cyan-700/50 focus:outline-none focus:border-cyan-500 dark:focus:border-cyan-400 focus:shadow-lg focus:shadow-cyan-500/20 dark:focus:shadow-cyan-400/20 transition-all duration-300\"\n                  >\n                    <option value=\"\">All Levels</option>\n                    <option value=\"debug\" ${filters.level === 'debug' ? 'selected' : ''}>Debug</option>\n                    <option value=\"info\" ${filters.level === 'info' ? 'selected' : ''}>Info</option>\n                    <option value=\"warn\" ${filters.level === 'warn' ? 'selected' : ''}>Warning</option>\n                    <option value=\"error\" ${filters.level === 'error' ? 'selected' : ''}>Error</option>\n                    <option value=\"fatal\" ${filters.level === 'fatal' ? 'selected' : ''}>Fatal</option>\n                  </select>\n                </div>\n\n                <div>\n                  <label for=\"category\" class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Category</label>\n                  <select\n                    name=\"category\"\n                    id=\"category\"\n                    class=\"w-full rounded-lg bg-white/90 dark:bg-zinc-800/90 backdrop-blur-sm px-4 py-2 text-sm text-zinc-950 dark:text-white border-2 border-cyan-200/50 dark:border-cyan-700/50 focus:outline-none focus:border-cyan-500 dark:focus:border-cyan-400 focus:shadow-lg focus:shadow-cyan-500/20 dark:focus:shadow-cyan-400/20 transition-all duration-300\"\n                  >\n                    <option value=\"\">All Categories</option>\n                    <option value=\"auth\" ${filters.category === 'auth' ? 'selected' : ''}>Authentication</option>\n                    <option value=\"api\" ${filters.category === 'api' ? 'selected' : ''}>API</option>\n                    <option value=\"workflow\" ${filters.category === 'workflow' ? 'selected' : ''}>Workflow</option>\n                    <option value=\"plugin\" ${filters.category === 'plugin' ? 'selected' : ''}>Plugin</option>\n                    <option value=\"media\" ${filters.category === 'media' ? 'selected' : ''}>Media</option>\n                    <option value=\"system\" ${filters.category === 'system' ? 'selected' : ''}>System</option>\n                    <option value=\"security\" ${filters.category === 'security' ? 'selected' : ''}>Security</option>\n                    <option value=\"error\" ${filters.category === 'error' ? 'selected' : ''}>Error</option>\n                  </select>\n                </div>\n\n                <div>\n                  <label for=\"source\" class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Source</label>\n                  <input\n                    type=\"text\"\n                    name=\"source\"\n                    id=\"source\"\n                    value=\"${filters.source}\"\n                    placeholder=\"e.g., http-middleware\"\n                    class=\"w-full rounded-lg bg-white/90 dark:bg-zinc-800/90 backdrop-blur-sm px-4 py-2 text-sm text-zinc-950 dark:text-white placeholder-zinc-500 dark:placeholder-zinc-400 border-2 border-cyan-200/50 dark:border-cyan-700/50 focus:outline-none focus:border-cyan-500 dark:focus:border-cyan-400 focus:shadow-lg focus:shadow-cyan-500/20 dark:focus:shadow-cyan-400/20 transition-all duration-300\"\n                  />\n                </div>\n\n                <div>\n                  <label for=\"start_date\" class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">Start Date</label>\n                  <input\n                    type=\"datetime-local\"\n                    name=\"start_date\"\n                    id=\"start_date\"\n                    value=\"${filters.startDate}\"\n                    class=\"w-full rounded-lg bg-white/90 dark:bg-zinc-800/90 backdrop-blur-sm px-4 py-2 text-sm text-zinc-950 dark:text-white border-2 border-cyan-200/50 dark:border-cyan-700/50 focus:outline-none focus:border-cyan-500 dark:focus:border-cyan-400 focus:shadow-lg focus:shadow-cyan-500/20 dark:focus:shadow-cyan-400/20 transition-all duration-300\"\n                  />\n                </div>\n\n                <div>\n                  <label for=\"end_date\" class=\"block text-sm font-medium text-zinc-950 dark:text-white mb-2\">End Date</label>\n                  <input\n                    type=\"datetime-local\"\n                    name=\"end_date\"\n                    id=\"end_date\"\n                    value=\"${filters.endDate}\"\n                    class=\"w-full rounded-lg bg-white/90 dark:bg-zinc-800/90 backdrop-blur-sm px-4 py-2 text-sm text-zinc-950 dark:text-white border-2 border-cyan-200/50 dark:border-cyan-700/50 focus:outline-none focus:border-cyan-500 dark:focus:border-cyan-400 focus:shadow-lg focus:shadow-cyan-500/20 dark:focus:shadow-cyan-400/20 transition-all duration-300\"\n                  />\n                </div>\n\n                <div class=\"sm:col-span-2 flex items-end gap-x-2\">\n                  <button\n                    type=\"submit\"\n                    class=\"inline-flex items-center justify-center rounded-lg bg-zinc-950 dark:bg-white px-3.5 py-2.5 text-sm font-semibold text-white dark:text-zinc-950 hover:bg-zinc-800 dark:hover:bg-zinc-100 transition-colors shadow-sm\"\n                  >\n                    Apply Filters\n                  </button>\n                  <a\n                    href=\"/admin/logs\"\n                    class=\"inline-flex items-center justify-center rounded-lg bg-white dark:bg-zinc-800 px-3.5 py-2.5 text-sm font-semibold text-zinc-950 dark:text-white hover:bg-zinc-50 dark:hover:bg-zinc-700 ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 transition-colors shadow-sm\"\n                  >\n                    Clear\n                  </a>\n                </div>\n              </div>\n\n              <div class=\"flex items-center justify-end pt-2\">\n                <span class=\"text-sm/6 font-medium text-zinc-700 dark:text-zinc-300 px-3 py-1.5 rounded-full bg-white/60 dark:bg-zinc-800/60 backdrop-blur-sm\">${pagination.totalItems} ${pagination.totalItems === 1 ? 'entry' : 'entries'}</span>\n              </div>\n            </form>\n          </div>\n        </div>\n      </div>\n\n      <!-- Logs Table -->\n      <div class=\"rounded-xl bg-white dark:bg-zinc-900 shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10 overflow-hidden\">\n        <div class=\"overflow-x-auto\">\n          <table class=\"min-w-full\">\n            <thead>\n              <tr class=\"border-b border-zinc-950/5 dark:border-white/5\">\n                <th scope=\"col\" class=\"px-4 py-3.5 text-left text-sm font-semibold text-zinc-950 dark:text-white sm:pl-6\">\n                  Level\n                </th>\n                <th scope=\"col\" class=\"px-4 py-3.5 text-left text-sm font-semibold text-zinc-950 dark:text-white\">\n                  Category\n                </th>\n                <th scope=\"col\" class=\"px-4 py-3.5 text-left text-sm font-semibold text-zinc-950 dark:text-white\">\n                  Message\n                </th>\n                <th scope=\"col\" class=\"px-4 py-3.5 text-left text-sm font-semibold text-zinc-950 dark:text-white\">\n                  Source\n                </th>\n                <th scope=\"col\" class=\"px-4 py-3.5 text-left text-sm font-semibold text-zinc-950 dark:text-white\">\n                  Time\n                </th>\n                <th scope=\"col\" class=\"relative px-4 py-3.5 sm:pr-6\">\n                  <span class=\"sr-only\">Actions</span>\n                </th>\n              </tr>\n            </thead>\n            <tbody>\n              ${logs.map(log => `\n                <tr class=\"border-t border-zinc-950/5 dark:border-white/5 hover:bg-gradient-to-r hover:from-cyan-50/50 hover:via-blue-50/30 hover:to-purple-50/50 dark:hover:from-cyan-900/20 dark:hover:via-blue-900/10 dark:hover:to-purple-900/20 hover:shadow-sm hover:shadow-cyan-500/5 dark:hover:shadow-cyan-400/5 transition-all duration-300\">\n                  <td class=\"px-4 py-4 whitespace-nowrap sm:pl-6\">\n                    <span class=\"inline-flex items-center rounded-md px-2.5 py-1 text-sm font-medium ring-1 ring-inset ${log.levelClass}\">\n                      ${log.level}\n                    </span>\n                  </td>\n                  <td class=\"px-4 py-4 whitespace-nowrap\">\n                    <span class=\"inline-flex items-center rounded-md px-2.5 py-1 text-sm font-medium ring-1 ring-inset ${log.categoryClass}\">\n                      ${log.category}\n                    </span>\n                  </td>\n                  <td class=\"px-4 py-4\">\n                    <div class=\"text-sm max-w-md\">\n                      <div class=\"truncate text-zinc-950 dark:text-white\" title=\"${log.message}\">${log.message}</div>\n                      ${log.url ? `<div class=\"text-xs text-zinc-500 dark:text-zinc-400 truncate mt-1\">${log.method} ${log.url}</div>` : ''}\n                      ${log.duration ? `<div class=\"text-xs text-zinc-500 dark:text-zinc-400 mt-1\">${log.formattedDuration}</div>` : ''}\n                    </div>\n                  </td>\n                  <td class=\"px-4 py-4 whitespace-nowrap text-sm text-zinc-500 dark:text-zinc-400\">\n                    ${log.source || '-'}\n                  </td>\n                  <td class=\"px-4 py-4 whitespace-nowrap text-sm text-zinc-500 dark:text-zinc-400\">\n                    ${log.formattedDate}\n                  </td>\n                  <td class=\"px-4 py-4 whitespace-nowrap text-right text-sm font-medium sm:pr-6\">\n                    <a href=\"/admin/logs/${log.id}\" class=\"text-cyan-600 dark:text-cyan-400 hover:text-cyan-700 dark:hover:text-cyan-300 transition-colors\">\n                      View Details\n                    </a>\n                  </td>\n                </tr>\n              `).join('')}\n            </tbody>\n          </table>\n        </div>\n\n        ${logs.length === 0 ? `\n          <div class=\"text-center py-12\">\n            <svg class=\"mx-auto h-12 w-12 text-zinc-400 dark:text-zinc-500\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n            </svg>\n            <h3 class=\"mt-2 text-sm font-medium text-zinc-950 dark:text-white\">No log entries</h3>\n            <p class=\"mt-1 text-sm text-zinc-500 dark:text-zinc-400\">No log entries found matching your criteria.</p>\n          </div>\n        ` : ''}\n      </div>\n\n      <!-- Pagination -->\n      ${pagination.totalPages > 1 ? `\n        <div class=\"mt-6 flex items-center justify-between\">\n          <div class=\"flex-1 flex justify-between sm:hidden\">\n            ${pagination.currentPage > 1 ? `\n              <a\n                href=\"${pagination.baseUrl}?${new URLSearchParams({...filters, page: (pagination.currentPage - 1).toString()}).toString()}\"\n                class=\"relative inline-flex items-center px-4 py-2 rounded-lg bg-white dark:bg-zinc-800 text-sm font-medium text-zinc-950 dark:text-white hover:bg-zinc-50 dark:hover:bg-zinc-700 ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 transition-colors\"\n              >\n                Previous\n              </a>\n            ` : `\n              <span class=\"relative inline-flex items-center px-4 py-2 rounded-lg text-sm font-medium text-zinc-400 dark:text-zinc-600 bg-zinc-100 dark:bg-zinc-800 cursor-not-allowed\">\n                Previous\n              </span>\n            `}\n            ${pagination.currentPage < pagination.totalPages ? `\n              <a\n                href=\"${pagination.baseUrl}?${new URLSearchParams({...filters, page: (pagination.currentPage + 1).toString()}).toString()}\"\n                class=\"ml-3 relative inline-flex items-center px-4 py-2 rounded-lg bg-white dark:bg-zinc-800 text-sm font-medium text-zinc-950 dark:text-white hover:bg-zinc-50 dark:hover:bg-zinc-700 ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 transition-colors\"\n              >\n                Next\n              </a>\n            ` : `\n              <span class=\"ml-3 relative inline-flex items-center px-4 py-2 rounded-lg text-sm font-medium text-zinc-400 dark:text-zinc-600 bg-zinc-100 dark:bg-zinc-800 cursor-not-allowed\">\n                Next\n              </span>\n            `}\n          </div>\n          <div class=\"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between\">\n            <div>\n              <p class=\"text-sm text-zinc-700 dark:text-zinc-300\">\n                Showing <span class=\"font-medium\">${pagination.startItem}</span> to <span class=\"font-medium\">${pagination.endItem}</span> of{' '}\n                <span class=\"font-medium\">${pagination.totalItems}</span> results\n              </p>\n            </div>\n            <div>\n              <nav class=\"relative z-0 inline-flex rounded-lg shadow-sm -space-x-px\" aria-label=\"Pagination\">\n                ${pagination.currentPage > 1 ? `\n                  <a\n                    href=\"${pagination.baseUrl}?${new URLSearchParams({...filters, page: (pagination.currentPage - 1).toString()}).toString()}\"\n                    class=\"relative inline-flex items-center px-2 py-2 rounded-l-lg bg-white dark:bg-zinc-800 text-sm font-medium text-zinc-500 dark:text-zinc-400 hover:bg-zinc-50 dark:hover:bg-zinc-700 ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 transition-colors\"\n                  >\n                    <span class=\"sr-only\">Previous</span>\n                    <svg class=\"h-5 w-5\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\">\n                      <path fill-rule=\"evenodd\" d=\"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z\" clip-rule=\"evenodd\" />\n                    </svg>\n                  </a>\n                ` : ''}\n\n                ${Array.from({ length: Math.min(10, pagination.totalPages) }, (_, i) => {\n                  const page = Math.max(1, Math.min(pagination.totalPages - 9, pagination.currentPage - 5)) + i\n                  if (page > pagination.totalPages) return ''\n\n                  return `\n                    <a\n                      href=\"${pagination.baseUrl}?${new URLSearchParams({...filters, page: page.toString()}).toString()}\"\n                      class=\"relative inline-flex items-center px-4 py-2 text-sm font-medium ring-1 ring-inset transition-colors ${\n                        page === pagination.currentPage\n                          ? 'z-10 bg-cyan-50 dark:bg-cyan-900/20 ring-cyan-600 dark:ring-cyan-400 text-cyan-600 dark:text-cyan-400'\n                          : 'bg-white dark:bg-zinc-800 ring-zinc-950/10 dark:ring-white/10 text-zinc-500 dark:text-zinc-400 hover:bg-zinc-50 dark:hover:bg-zinc-700'\n                      }\"\n                    >\n                      ${page}\n                    </a>\n                  `\n                }).join('')}\n\n                ${pagination.currentPage < pagination.totalPages ? `\n                  <a\n                    href=\"${pagination.baseUrl}?${new URLSearchParams({...filters, page: (pagination.currentPage + 1).toString()}).toString()}\"\n                    class=\"relative inline-flex items-center px-2 py-2 rounded-r-lg bg-white dark:bg-zinc-800 text-sm font-medium text-zinc-500 dark:text-zinc-400 hover:bg-zinc-50 dark:hover:bg-zinc-700 ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 transition-colors\"\n                  >\n                    <span class=\"sr-only\">Next</span>\n                    <svg class=\"h-5 w-5\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\" aria-hidden=\"true\">\n                      <path fill-rule=\"evenodd\" d=\"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z\" clip-rule=\"evenodd\" />\n                    </svg>\n                  </a>\n                ` : ''}\n              </nav>\n            </div>\n          </div>\n        </div>\n      ` : ''}\n    </div>\n  `\n\n  const layoutData: AdminLayoutCatalystData = {\n    title: 'System Logs',\n    pageTitle: 'System Logs',\n    currentPath: '/admin/logs',\n    user,\n    content\n  }\n\n  return renderAdminLayoutCatalyst(layoutData)\n}","import { html } from 'hono/html'\nimport { adminLayoutV2 } from '../layouts/admin-layout-v2.template'\nimport { LogEntry } from './admin-logs-list.template'\n\ninterface BaseUser {\n  name: string\n  email: string\n  role: string\n}\n\nexport interface LogDetailsPageData {\n  log: LogEntry\n  user?: BaseUser\n}\n\nexport function renderLogDetailsPage(data: LogDetailsPageData) {\n  const { log, user } = data\n\n  const content = html`\n    <div class=\"px-4 sm:px-6 lg:px-8\">\n      <div class=\"sm:flex sm:items-center\">\n        <div class=\"sm:flex-auto\">\n          <nav class=\"mb-4\">\n            <a href=\"/admin/logs\" class=\"text-indigo-600 hover:text-indigo-900\">\n               Back to Logs\n            </a>\n          </nav>\n          <h1 class=\"text-2xl font-semibold text-gray-900\">Log Details</h1>\n          <p class=\"mt-2 text-sm text-gray-700\">\n            Detailed information for log entry ${log.id}\n          </p>\n        </div>\n      </div>\n\n      <div class=\"mt-6 bg-white shadow rounded-lg overflow-hidden\">\n        <div class=\"px-6 py-4 border-b border-gray-200\">\n          <div class=\"flex items-center justify-between\">\n            <h2 class=\"text-lg font-medium text-gray-900\">Log Entry Information</h2>\n            <div class=\"flex items-center space-x-2\">\n              <span class=\"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${log.levelClass}\">\n                ${log.level}\n              </span>\n              <span class=\"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${log.categoryClass}\">\n                ${log.category}\n              </span>\n            </div>\n          </div>\n        </div>\n        \n        <div class=\"px-6 py-4\">\n          <dl class=\"grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2\">\n            <div>\n              <dt class=\"text-sm font-medium text-gray-500\">ID</dt>\n              <dd class=\"mt-1 text-sm text-gray-900 font-mono\">${log.id}</dd>\n            </div>\n            \n            <div>\n              <dt class=\"text-sm font-medium text-gray-500\">Timestamp</dt>\n              <dd class=\"mt-1 text-sm text-gray-900\">${log.formattedDate}</dd>\n            </div>\n            \n            <div>\n              <dt class=\"text-sm font-medium text-gray-500\">Level</dt>\n              <dd class=\"mt-1\">\n                <span class=\"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${log.levelClass}\">\n                  ${log.level}\n                </span>\n              </dd>\n            </div>\n            \n            <div>\n              <dt class=\"text-sm font-medium text-gray-500\">Category</dt>\n              <dd class=\"mt-1\">\n                <span class=\"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${log.categoryClass}\">\n                  ${log.category}\n                </span>\n              </dd>\n            </div>\n            \n            ${log.source ? html`\n              <div>\n                <dt class=\"text-sm font-medium text-gray-500\">Source</dt>\n                <dd class=\"mt-1 text-sm text-gray-900\">${log.source}</dd>\n              </div>\n            ` : ''}\n            \n            ${log.userId ? html`\n              <div>\n                <dt class=\"text-sm font-medium text-gray-500\">User ID</dt>\n                <dd class=\"mt-1 text-sm text-gray-900 font-mono\">${log.userId}</dd>\n              </div>\n            ` : ''}\n            \n            ${log.sessionId ? html`\n              <div>\n                <dt class=\"text-sm font-medium text-gray-500\">Session ID</dt>\n                <dd class=\"mt-1 text-sm text-gray-900 font-mono\">${log.sessionId}</dd>\n              </div>\n            ` : ''}\n            \n            ${log.requestId ? html`\n              <div>\n                <dt class=\"text-sm font-medium text-gray-500\">Request ID</dt>\n                <dd class=\"mt-1 text-sm text-gray-900 font-mono\">${log.requestId}</dd>\n              </div>\n            ` : ''}\n            \n            ${log.ipAddress ? html`\n              <div>\n                <dt class=\"text-sm font-medium text-gray-500\">IP Address</dt>\n                <dd class=\"mt-1 text-sm text-gray-900\">${log.ipAddress}</dd>\n              </div>\n            ` : ''}\n            \n            ${log.method && log.url ? html`\n              <div class=\"sm:col-span-2\">\n                <dt class=\"text-sm font-medium text-gray-500\">HTTP Request</dt>\n                <dd class=\"mt-1 text-sm text-gray-900\">\n                  <span class=\"font-medium\">${log.method}</span> ${log.url}\n                  ${log.statusCode ? html`<span class=\"ml-2 text-gray-500\">(${log.statusCode})</span>` : ''}\n                </dd>\n              </div>\n            ` : ''}\n            \n            ${log.duration ? html`\n              <div>\n                <dt class=\"text-sm font-medium text-gray-500\">Duration</dt>\n                <dd class=\"mt-1 text-sm text-gray-900\">${log.formattedDuration}</dd>\n              </div>\n            ` : ''}\n            \n            ${log.userAgent ? html`\n              <div class=\"sm:col-span-2\">\n                <dt class=\"text-sm font-medium text-gray-500\">User Agent</dt>\n                <dd class=\"mt-1 text-sm text-gray-900 break-all\">${log.userAgent}</dd>\n              </div>\n            ` : ''}\n          </dl>\n        </div>\n      </div>\n\n      <!-- Message -->\n      <div class=\"mt-6 bg-white shadow rounded-lg overflow-hidden\">\n        <div class=\"px-6 py-4 border-b border-gray-200\">\n          <h3 class=\"text-lg font-medium text-gray-900\">Message</h3>\n        </div>\n        <div class=\"px-6 py-4\">\n          <div class=\"text-sm text-gray-900 whitespace-pre-wrap break-words\">\n            ${log.message}\n          </div>\n        </div>\n      </div>\n\n      <!-- Tags -->\n      ${log.tags && log.tags.length > 0 ? html`\n        <div class=\"mt-6 bg-white shadow rounded-lg overflow-hidden\">\n          <div class=\"px-6 py-4 border-b border-gray-200\">\n            <h3 class=\"text-lg font-medium text-gray-900\">Tags</h3>\n          </div>\n          <div class=\"px-6 py-4\">\n            <div class=\"flex flex-wrap gap-2\">\n              ${log.tags.map(tag => html`\n                <span class=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800\">\n                  ${tag}\n                </span>\n              `).join('')}\n            </div>\n          </div>\n        </div>\n      ` : ''}\n\n      <!-- Additional Data -->\n      ${log.data ? html`\n        <div class=\"mt-6 bg-white shadow rounded-lg overflow-hidden\">\n          <div class=\"px-6 py-4 border-b border-gray-200\">\n            <h3 class=\"text-lg font-medium text-gray-900\">Additional Data</h3>\n          </div>\n          <div class=\"px-6 py-4\">\n            <pre class=\"text-sm text-gray-900 bg-gray-50 rounded-md p-4 overflow-x-auto\"><code>${JSON.stringify(log.data, null, 2)}</code></pre>\n          </div>\n        </div>\n      ` : ''}\n\n      <!-- Stack Trace -->\n      ${log.stackTrace ? html`\n        <div class=\"mt-6 bg-white shadow rounded-lg overflow-hidden\">\n          <div class=\"px-6 py-4 border-b border-gray-200\">\n            <h3 class=\"text-lg font-medium text-gray-900\">Stack Trace</h3>\n          </div>\n          <div class=\"px-6 py-4\">\n            <pre class=\"text-sm text-gray-900 bg-gray-50 rounded-md p-4 overflow-x-auto whitespace-pre-wrap\"><code>${log.stackTrace}</code></pre>\n          </div>\n        </div>\n      ` : ''}\n\n      <!-- Actions -->\n      <div class=\"mt-6 flex justify-between\">\n        <a\n          href=\"/admin/logs\"\n          class=\"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\"\n        >\n           Back to Logs\n        </a>\n        \n        <div class=\"flex space-x-3\">\n          ${log.level === 'error' || log.level === 'fatal' ? html`\n            <button\n              type=\"button\"\n              class=\"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\"\n              onclick=\"alert('Error reporting functionality would be implemented here')\"\n            >\n              Report Issue\n            </button>\n          ` : ''}\n          \n          <button\n            type=\"button\"\n            class=\"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\"\n            onclick=\"navigator.clipboard.writeText(JSON.stringify(${JSON.stringify(log)}, null, 2)).then(() => alert('Log details copied to clipboard'))\"\n          >\n            Copy Details\n          </button>\n        </div>\n      </div>\n    </div>\n  `\n\n  return adminLayoutV2({\n    title: `Log Details - ${log.id}`,\n    user,\n    content: content as string\n  })\n}","import { html } from 'hono/html'\nimport { adminLayoutV2 } from '../layouts/admin-layout-v2.template'\nimport type { LogConfig } from '../../db/schema'\n\ninterface BaseUser {\n  name: string\n  email: string\n  role: string\n}\n\nexport interface LogConfigPageData {\n  configs: LogConfig[]\n  user?: BaseUser\n}\n\nexport function renderLogConfigPage(data: LogConfigPageData) {\n  const { configs, user } = data\n\n  const content = html`\n    <div class=\"px-4 sm:px-6 lg:px-8\">\n      <div class=\"sm:flex sm:items-center\">\n        <div class=\"sm:flex-auto\">\n          <nav class=\"mb-4\">\n            <a href=\"/admin/logs\" class=\"text-indigo-600 hover:text-indigo-900\">\n               Back to Logs\n            </a>\n          </nav>\n          <h1 class=\"text-2xl font-semibold text-gray-900\">Log Configuration</h1>\n          <p class=\"mt-2 text-sm text-gray-700\">\n            Configure logging settings for different categories and manage log retention policies.\n          </p>\n        </div>\n        <div class=\"mt-4 sm:mt-0 sm:ml-16 sm:flex-none\">\n          <button\n            type=\"button\"\n            hx-post=\"/admin/logs/cleanup\"\n            hx-confirm=\"Are you sure you want to run log cleanup? This will permanently delete old logs based on retention policies.\"\n            hx-target=\"#cleanup-result\"\n            class=\"inline-flex items-center justify-center rounded-md border border-transparent bg-red-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2\"\n          >\n            Run Cleanup\n          </button>\n        </div>\n      </div>\n\n      <div id=\"cleanup-result\" class=\"mt-4\"></div>\n\n      <!-- Log Levels Reference -->\n      <div class=\"mt-6 bg-white shadow rounded-lg\">\n        <div class=\"px-6 py-4 border-b border-gray-200\">\n          <h2 class=\"text-lg font-medium text-gray-900\">Log Levels Reference</h2>\n        </div>\n        <div class=\"px-6 py-4\">\n          <div class=\"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-5\">\n            <div class=\"text-center\">\n              <span class=\"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800\">\n                debug\n              </span>\n              <p class=\"mt-2 text-xs text-gray-500\">Detailed diagnostic information</p>\n            </div>\n            <div class=\"text-center\">\n              <span class=\"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800\">\n                info\n              </span>\n              <p class=\"mt-2 text-xs text-gray-500\">General information messages</p>\n            </div>\n            <div class=\"text-center\">\n              <span class=\"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800\">\n                warn\n              </span>\n              <p class=\"mt-2 text-xs text-gray-500\">Warning conditions</p>\n            </div>\n            <div class=\"text-center\">\n              <span class=\"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800\">\n                error\n              </span>\n              <p class=\"mt-2 text-xs text-gray-500\">Error conditions</p>\n            </div>\n            <div class=\"text-center\">\n              <span class=\"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-purple-100 text-purple-800\">\n                fatal\n              </span>\n              <p class=\"mt-2 text-xs text-gray-500\">Critical system errors</p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Configuration Cards -->\n      <div class=\"mt-8 grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3\">\n        ${configs.map(config => html`\n          <div class=\"bg-white shadow rounded-lg overflow-hidden\">\n            <div class=\"px-6 py-4 border-b border-gray-200\">\n              <div class=\"flex items-center justify-between\">\n                <h3 class=\"text-lg font-medium text-gray-900 capitalize\">${config.category}</h3>\n                <div class=\"flex items-center\">\n                  ${config.enabled ? html`\n                    <span class=\"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800\">\n                      Enabled\n                    </span>\n                  ` : html`\n                    <span class=\"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800\">\n                      Disabled\n                    </span>\n                  `}\n                </div>\n              </div>\n            </div>\n            \n            <form hx-post=\"/admin/logs/config/${config.category}\" hx-target=\"#config-result-${config.category}\">\n              <div class=\"px-6 py-4 space-y-4\">\n                <div class=\"flex gap-3\">\n                  <div class=\"flex h-6 shrink-0 items-center\">\n                    <div class=\"group grid size-4 grid-cols-1\">\n                      <input\n                        id=\"enabled-${config.category}\"\n                        name=\"enabled\"\n                        type=\"checkbox\"\n                        ${config.enabled ? 'checked' : ''}\n                        class=\"col-start-1 row-start-1 appearance-none rounded border border-zinc-950/10 dark:border-white/10 bg-white dark:bg-white/5 checked:border-indigo-500 checked:bg-indigo-500 indeterminate:border-indigo-500 indeterminate:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 disabled:border-zinc-950/5 dark:disabled:border-white/5 disabled:bg-zinc-950/10 dark:disabled:bg-white/10 disabled:checked:bg-zinc-950/10 dark:disabled:checked:bg-white/10 forced-colors:appearance-auto\"\n                      />\n                      <svg viewBox=\"0 0 14 14\" fill=\"none\" class=\"pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-[:disabled]:stroke-zinc-950/25 dark:group-has-[:disabled]:stroke-white/25\">\n                        <path d=\"M3 8L6 11L11 3.5\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:checked]:opacity-100\" />\n                        <path d=\"M3 7H11\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:indeterminate]:opacity-100\" />\n                      </svg>\n                    </div>\n                  </div>\n                  <div class=\"text-sm/6\">\n                    <label for=\"enabled-${config.category}\" class=\"font-medium text-zinc-950 dark:text-white\">\n                      Enable logging for this category\n                    </label>\n                  </div>\n                </div>\n                \n                <div>\n                  <label for=\"level-${config.category}\" class=\"block text-sm font-medium text-gray-700\">\n                    Minimum Log Level\n                  </label>\n                  <select\n                    id=\"level-${config.category}\"\n                    name=\"level\"\n                    class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm\"\n                  >\n                    <option value=\"debug\" ${config.level === 'debug' ? 'selected' : ''}>Debug</option>\n                    <option value=\"info\" ${config.level === 'info' ? 'selected' : ''}>Info</option>\n                    <option value=\"warn\" ${config.level === 'warn' ? 'selected' : ''}>Warning</option>\n                    <option value=\"error\" ${config.level === 'error' ? 'selected' : ''}>Error</option>\n                    <option value=\"fatal\" ${config.level === 'fatal' ? 'selected' : ''}>Fatal</option>\n                  </select>\n                  <p class=\"mt-1 text-sm text-gray-500\">Only logs at this level or higher will be stored</p>\n                </div>\n                \n                <div>\n                  <label for=\"retention-${config.category}\" class=\"block text-sm font-medium text-gray-700\">\n                    Retention Period (days)\n                  </label>\n                  <input\n                    type=\"number\"\n                    id=\"retention-${config.category}\"\n                    name=\"retention\"\n                    value=\"${config.retention}\"\n                    min=\"1\"\n                    max=\"365\"\n                    class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm\"\n                  />\n                  <p class=\"mt-1 text-sm text-gray-500\">Logs older than this will be deleted</p>\n                </div>\n                \n                <div>\n                  <label for=\"max_size-${config.category}\" class=\"block text-sm font-medium text-gray-700\">\n                    Maximum Log Count\n                  </label>\n                  <input\n                    type=\"number\"\n                    id=\"max_size-${config.category}\"\n                    name=\"max_size\"\n                    value=\"${config.maxSize || ''}\"\n                    min=\"100\"\n                    max=\"100000\"\n                    class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm\"\n                  />\n                  <p class=\"mt-1 text-sm text-gray-500\">Maximum number of logs to keep for this category</p>\n                </div>\n              </div>\n              \n              <div class=\"px-6 py-4 bg-gray-50 border-t border-gray-200\">\n                <div id=\"config-result-${config.category}\" class=\"mb-4\"></div>\n                <button\n                  type=\"submit\"\n                  class=\"w-full inline-flex justify-center items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\"\n                >\n                  Update Configuration\n                </button>\n              </div>\n            </form>\n            \n            <div class=\"px-6 py-3 bg-gray-50 border-t border-gray-200\">\n              <div class=\"text-xs text-gray-500\">\n                <div>Created: ${new Date(config.createdAt).toLocaleDateString()}</div>\n                <div>Updated: ${new Date(config.updatedAt).toLocaleDateString()}</div>\n              </div>\n            </div>\n          </div>\n        `).join('')}\n      </div>\n\n      <!-- Global Settings -->\n      <div class=\"mt-8 bg-white shadow rounded-lg\">\n        <div class=\"px-6 py-4 border-b border-gray-200\">\n          <h2 class=\"text-lg font-medium text-gray-900\">Global Log Settings</h2>\n        </div>\n        <div class=\"px-6 py-4\">\n          <div class=\"space-y-6\">\n            <div>\n              <h3 class=\"text-base font-medium text-gray-900\">Storage Information</h3>\n              <div class=\"mt-2 grid grid-cols-1 gap-4 sm:grid-cols-3\">\n                <div class=\"bg-gray-50 rounded-lg p-4\">\n                  <div class=\"text-2xl font-bold text-gray-900\">-</div>\n                  <div class=\"text-sm text-gray-500\">Total Log Entries</div>\n                </div>\n                <div class=\"bg-gray-50 rounded-lg p-4\">\n                  <div class=\"text-2xl font-bold text-gray-900\">-</div>\n                  <div class=\"text-sm text-gray-500\">Storage Used</div>\n                </div>\n                <div class=\"bg-gray-50 rounded-lg p-4\">\n                  <div class=\"text-2xl font-bold text-gray-900\">-</div>\n                  <div class=\"text-sm text-gray-500\">Oldest Log</div>\n                </div>\n              </div>\n            </div>\n            \n            <div>\n              <h3 class=\"text-base font-medium text-gray-900\">Log Categories</h3>\n              <div class=\"mt-2 text-sm text-gray-600\">\n                <ul class=\"list-disc list-inside space-y-1\">\n                  <li><strong>auth</strong> - Authentication and authorization events</li>\n                  <li><strong>api</strong> - API requests and responses</li>\n                  <li><strong>workflow</strong> - Content workflow state changes</li>\n                  <li><strong>plugin</strong> - Plugin-related activities</li>\n                  <li><strong>media</strong> - File upload and media operations</li>\n                  <li><strong>system</strong> - General system events</li>\n                  <li><strong>security</strong> - Security-related events and alerts</li>\n                  <li><strong>error</strong> - General error conditions</li>\n                </ul>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <script src=\"https://unpkg.com/htmx.org@1.9.6\"></script>\n  `\n\n  return adminLayoutV2({\n    title: 'Log Configuration',\n    user,\n    content: content as string\n  })\n}","import { Hono } from 'hono'\nimport { html } from 'hono/html'\nimport type { D1Database, KVNamespace } from '@cloudflare/workers-types'\nimport { requireAuth } from '../middleware'\nimport { getLogger, type LogLevel, type LogCategory, type LogFilter } from '../services'\nimport { renderLogsListPage, type LogsListPageData } from '../templates/pages/admin-logs-list.template'\nimport { renderLogDetailsPage, type LogDetailsPageData } from '../templates/pages/admin-log-details.template'\nimport { renderLogConfigPage, type LogConfigPageData } from '../templates/pages/admin-log-config.template'\nimport type { Bindings, Variables } from '../app'\n\nconst adminLogsRoutes = new Hono<{ Bindings: Bindings; Variables: Variables }>()\n\n// Apply authentication middleware\nadminLogsRoutes.use('*', requireAuth())\n\n// Main logs listing page\nadminLogsRoutes.get('/', async (c) => {\n  try {\n    const user = c.get('user')\n    const logger = getLogger(c.env.DB)\n    \n    // Use Hono's built-in query method instead of parsing URL\n    const query = c.req.query()\n    \n    // Parse query parameters\n    const page = parseInt(query.page || '1')\n    const limit = parseInt(query.limit || '50')\n    const level = query.level\n    const category = query.category\n    const search = query.search\n    const startDate = query.start_date\n    const endDate = query.end_date\n    const source = query.source\n    \n    // Build filter\n    const filter: LogFilter = {\n      limit,\n      offset: (page - 1) * limit,\n      sortBy: 'created_at',\n      sortOrder: 'desc'\n    }\n    \n    if (level) {\n      filter.level = level.split(',') as LogLevel[]\n    }\n    \n    if (category) {\n      filter.category = category.split(',') as LogCategory[]\n    }\n    \n    if (search) {\n      filter.search = search\n    }\n    \n    if (startDate) {\n      filter.startDate = new Date(startDate)\n    }\n    \n    if (endDate) {\n      filter.endDate = new Date(endDate)\n    }\n    \n    if (source) {\n      filter.source = source\n    }\n    \n    // Get logs and total count\n    const { logs, total } = await logger.getLogs(filter)\n    \n    // Format logs for display\n    const formattedLogs = logs.map(log => ({\n      ...log,\n      data: log.data ? JSON.parse(log.data) : null,\n      tags: log.tags ? JSON.parse(log.tags) : [],\n      formattedDate: new Date(log.createdAt).toLocaleString(),\n      formattedDuration: log.duration ? `${log.duration}ms` : null,\n      levelClass: getLevelClass(log.level),\n      categoryClass: getCategoryClass(log.category)\n    }))\n    \n    const totalPages = Math.ceil(total / limit)\n    \n    const pageData: LogsListPageData = {\n      logs: formattedLogs,\n      pagination: {\n        currentPage: page,\n        totalPages,\n        totalItems: total,\n        itemsPerPage: limit,\n        startItem: (page - 1) * limit + 1,\n        endItem: Math.min(page * limit, total),\n        baseUrl: '/admin/logs'\n      },\n      filters: {\n        level: level || '',\n        category: category || '',\n        search: search || '',\n        startDate: startDate || '',\n        endDate: endDate || '',\n        source: source || ''\n      },\n      user: user ? {\n        name: user.email,\n        email: user.email,\n        role: user.role\n      } : undefined\n    }\n    \n    return c.html(renderLogsListPage(pageData))\n  } catch (error) {\n    console.error('Error fetching logs:', error)\n    return c.html(html`<p>Error loading logs: ${error}</p>`)\n  }\n})\n\n// Log details page\nadminLogsRoutes.get('/:id', async (c) => {\n  try {\n    const id = c.req.param('id')\n    const user = c.get('user')\n    const logger = getLogger(c.env.DB)\n    \n    // Get single log by ID\n    const { logs } = await logger.getLogs({ \n      limit: 1, \n      offset: 0,\n      search: id // Using search to find by ID - this is a simplification\n    })\n    \n    const log = logs.find(l => l.id === id)\n    \n    if (!log) {\n      return c.html(html`<p>Log entry not found</p>`)\n    }\n    \n    const formattedLog = {\n      ...log,\n      data: log.data ? JSON.parse(log.data) : null,\n      tags: log.tags ? JSON.parse(log.tags) : [],\n      formattedDate: new Date(log.createdAt).toLocaleString(),\n      formattedDuration: log.duration ? `${log.duration}ms` : null,\n      levelClass: getLevelClass(log.level),\n      categoryClass: getCategoryClass(log.category)\n    }\n    \n    const pageData: LogDetailsPageData = {\n      log: formattedLog,\n      user: user ? {\n        name: user.email,\n        email: user.email,\n        role: user.role\n      } : undefined\n    }\n    \n    return c.html(renderLogDetailsPage(pageData))\n  } catch (error) {\n    console.error('Error fetching log details:', error)\n    return c.html(html`<p>Error loading log details: ${error}</p>`)\n  }\n})\n\n// Log configuration page\nadminLogsRoutes.get('/config', async (c) => {\n  try {\n    const user = c.get('user')\n    const logger = getLogger(c.env.DB)\n    \n    // Get all log configurations\n    const configs = await logger.getAllConfigs()\n    \n    const pageData: LogConfigPageData = {\n      configs,\n      user: user ? {\n        name: user.email,\n        email: user.email,\n        role: user.role\n      } : undefined\n    }\n    \n    return c.html(renderLogConfigPage(pageData))\n  } catch (error) {\n    console.error('Error fetching log config:', error)\n    return c.html(html`<p>Error loading log configuration: ${error}</p>`)\n  }\n})\n\n// Update log configuration\nadminLogsRoutes.post('/config/:category', async (c) => {\n  try {\n    const category = c.req.param('category') as LogCategory\n    const formData = await c.req.formData()\n    \n    const enabled = formData.get('enabled') === 'on'\n    const level = formData.get('level') as string\n    const retention = parseInt(formData.get('retention') as string)\n    const maxSize = parseInt(formData.get('max_size') as string)\n    \n    const logger = getLogger(c.env.DB)\n    await logger.updateConfig(category, {\n      enabled,\n      level,\n      retention,\n      maxSize\n    })\n    \n    return c.html(html`\n      <div class=\"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded\">\n        Configuration updated successfully!\n      </div>\n    `)\n  } catch (error) {\n    console.error('Error updating log config:', error)\n    return c.html(html`\n      <div class=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\">\n        Failed to update configuration. Please try again.\n      </div>\n    `)\n  }\n})\n\n// Export logs\nadminLogsRoutes.get('/export', async (c) => {\n  try {\n    const query = c.req.query()\n    const format = query.format || 'csv'\n    const level = query.level\n    const category = query.category\n    const startDate = query.start_date\n    const endDate = query.end_date\n    \n    const logger = getLogger(c.env.DB)\n    \n    // Build filter for export\n    const filter: LogFilter = {\n      limit: 10000, // Export up to 10k logs\n      offset: 0,\n      sortBy: 'created_at',\n      sortOrder: 'desc'\n    }\n    \n    if (level) {\n      filter.level = level.split(',') as LogLevel[]\n    }\n    \n    if (category) {\n      filter.category = category.split(',') as LogCategory[]\n    }\n    \n    if (startDate) {\n      filter.startDate = new Date(startDate)\n    }\n    \n    if (endDate) {\n      filter.endDate = new Date(endDate)\n    }\n    \n    const { logs } = await logger.getLogs(filter)\n    \n    if (format === 'json') {\n      return c.json(logs, 200, {\n        'Content-Disposition': 'attachment; filename=\"logs-export.json\"'\n      })\n    } else {\n      // Default to CSV\n      const headers = [\n        'ID', 'Level', 'Category', 'Message', 'Source', 'User ID', \n        'IP Address', 'Method', 'URL', 'Status Code', 'Duration', \n        'Created At'\n      ]\n      const csvRows = [headers.join(',')]\n      \n      logs.forEach(log => {\n        const row = [\n          log.id,\n          log.level,\n          log.category,\n          `\"${log.message.replace(/\"/g, '\"\"')}\"`, // Escape quotes\n          log.source || '',\n          log.userId || '',\n          log.ipAddress || '',\n          log.method || '',\n          log.url || '',\n          log.statusCode || '',\n          log.duration || '',\n          new Date(log.createdAt).toISOString()\n        ]\n        csvRows.push(row.join(','))\n      })\n      \n      const csv = csvRows.join('\\n')\n      \n      return new Response(csv, {\n        headers: {\n          'Content-Type': 'text/csv',\n          'Content-Disposition': 'attachment; filename=\"logs-export.csv\"'\n        }\n      })\n    }\n  } catch (error) {\n    console.error('Error exporting logs:', error)\n    return c.json({ error: 'Failed to export logs' }, 500)\n  }\n})\n\n// Clean up old logs\nadminLogsRoutes.post('/cleanup', async (c) => {\n  try {\n    const user = c.get('user')\n    \n    // Only allow admin users to run cleanup\n    if (!user || user.role !== 'admin') {\n      return c.json({ \n        success: false, \n        error: 'Unauthorized. Admin access required.' \n      }, 403)\n    }\n    \n    const logger = getLogger(c.env.DB)\n    await logger.cleanupByRetention()\n    \n    return c.html(html`\n      <div class=\"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded\">\n        Log cleanup completed successfully!\n      </div>\n    `)\n  } catch (error) {\n    console.error('Error cleaning up logs:', error)\n    return c.html(html`\n      <div class=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\">\n        Failed to clean up logs. Please try again.\n      </div>\n    `)\n  }\n})\n\n// Search logs (HTMX endpoint)\nadminLogsRoutes.post('/search', async (c) => {\n  try {\n    const formData = await c.req.formData()\n    const search = formData.get('search') as string\n    const level = formData.get('level') as string\n    const category = formData.get('category') as string\n    \n    const logger = getLogger(c.env.DB)\n    \n    const filter: LogFilter = {\n      limit: 20,\n      offset: 0,\n      sortBy: 'created_at',\n      sortOrder: 'desc'\n    }\n    \n    if (search) filter.search = search\n    if (level) filter.level = [level] as LogLevel[]\n    if (category) filter.category = [category] as LogCategory[]\n    \n    const { logs } = await logger.getLogs(filter)\n    \n    // Return just the logs table rows for HTMX\n    const rows = logs.map(log => {\n      const formattedLog = {\n        ...log,\n        formattedDate: new Date(log.createdAt).toLocaleString(),\n        levelClass: getLevelClass(log.level),\n        categoryClass: getCategoryClass(log.category)\n      }\n\n      return `\n        <tr class=\"hover:bg-gray-50\">\n          <td class=\"px-6 py-4 whitespace-nowrap\">\n            <span class=\"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${formattedLog.levelClass}\">\n              ${formattedLog.level}\n            </span>\n          </td>\n          <td class=\"px-6 py-4 whitespace-nowrap\">\n            <span class=\"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${formattedLog.categoryClass}\">\n              ${formattedLog.category}\n            </span>\n          </td>\n          <td class=\"px-6 py-4\">\n            <div class=\"text-sm text-gray-900 max-w-md truncate\">${formattedLog.message}</div>\n          </td>\n          <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">${formattedLog.source || '-'}</td>\n          <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">${formattedLog.formattedDate}</td>\n          <td class=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n            <a href=\"/admin/logs/${formattedLog.id}\" class=\"text-indigo-600 hover:text-indigo-900\">View</a>\n          </td>\n        </tr>\n      `\n    }).join('')\n\n    return c.html(rows)\n  } catch (error) {\n    console.error('Error searching logs:', error)\n    return c.html(html`<tr><td colspan=\"6\" class=\"px-6 py-4 text-center text-red-500\">Error searching logs</td></tr>`)\n  }\n})\n\n// Helper functions\nfunction getLevelClass(level: string): string {\n  switch (level) {\n    case 'debug': return 'bg-gray-100 text-gray-800'\n    case 'info': return 'bg-blue-100 text-blue-800'\n    case 'warn': return 'bg-yellow-100 text-yellow-800'\n    case 'error': return 'bg-red-100 text-red-800'\n    case 'fatal': return 'bg-purple-100 text-purple-800'\n    default: return 'bg-gray-100 text-gray-800'\n  }\n}\n\nfunction getCategoryClass(category: string): string {\n  switch (category) {\n    case 'auth': return 'bg-green-100 text-green-800'\n    case 'api': return 'bg-blue-100 text-blue-800'\n    case 'workflow': return 'bg-purple-100 text-purple-800'\n    case 'plugin': return 'bg-indigo-100 text-indigo-800'\n    case 'media': return 'bg-pink-100 text-pink-800'\n    case 'system': return 'bg-gray-100 text-gray-800'\n    case 'security': return 'bg-red-100 text-red-800'\n    case 'error': return 'bg-red-100 text-red-800'\n    default: return 'bg-gray-100 text-gray-800'\n  }\n}\n\nexport { adminLogsRoutes }","import {\n  AdminLayoutData,\n  renderAdminLayout,\n} from \"../layouts/admin-layout-v2.template\";\n\nexport interface DashboardStats {\n  contentItems: number;\n  mediaFiles: number;\n  users: number;\n  databaseSize?: number; // Size in bytes\n  mediaSize?: number; // Total size of all media files in bytes\n  recentActivity?: ActivityItem[];\n  analytics?: AnalyticsData;\n}\n\nexport interface ActivityItem {\n  id: string;\n  type: \"content\" | \"media\" | \"user\";\n  action: string;\n  description: string;\n  timestamp: string;\n  user: string;\n}\n\nexport interface AnalyticsData {\n  pageViews: number;\n  uniqueVisitors: number;\n  contentPublished: number;\n  mediaUploaded: number;\n  weeklyGrowth: {\n    pageViews: number;\n    visitors: number;\n    content: number;\n    media: number;\n  };\n}\n\nexport interface DashboardPageData {\n  user?: {\n    name: string;\n    email: string;\n    role: string;\n  };\n  stats?: DashboardStats;\n  version?: string;\n  enableExperimentalFeatures?: boolean;\n}\n\nexport function renderDashboardPage(data: DashboardPageData): string {\n  const pageContent = `\n    <div class=\"mb-8 flex flex-col sm:flex-row sm:items-center sm:justify-between\">\n      <div>\n        <h1 class=\"text-2xl/8 font-semibold text-zinc-950 dark:text-white sm:text-xl/8\">Dashboard</h1>\n        <p class=\"mt-2 text-sm/6 text-zinc-500 dark:text-zinc-400\">Welcome to your WarpCMS AI admin dashboard</p>\n      </div>\n      <div class=\"mt-4 sm:mt-0 flex items-center gap-x-3\">\n        <a href=\"/admin/content/new\" class=\"inline-flex items-center justify-center gap-x-1.5 rounded-lg bg-lime-600 dark:bg-lime-700 px-3.5 py-2.5 text-sm font-semibold text-white hover:bg-lime-700 dark:hover:bg-lime-600 transition-colors shadow-sm\">\n          <svg class=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M12 4v16m8-8H4\"/>\n          </svg>\n          New Content\n        </a>\n        <a href=\"/api\" target=\"_blank\" class=\"inline-flex items-center justify-center gap-x-1.5 rounded-lg bg-zinc-950 dark:bg-white px-3.5 py-2.5 text-sm font-semibold text-white dark:text-zinc-950 hover:bg-zinc-800 dark:hover:bg-zinc-100 transition-colors shadow-sm\">\n          <svg class=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M17.25 6.75L22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3l-4.5 16.5\"/>\n          </svg>\n          OpenAPI\n        </a>\n      </div>\n    </div>\n\n    <!-- Stats Cards -->\n    <div\n      id=\"stats-container\"\n      class=\"mb-8\"\n      hx-get=\"/admin/dashboard/stats\"\n      hx-trigger=\"load\"\n      hx-swap=\"innerHTML\"\n    >\n      ${renderStatsCardsSkeleton()}\n    </div>\n\n    <!-- Dashboard Grid -->\n    <div class=\"grid grid-cols-1 gap-6 xl:grid-cols-3 mb-8\">\n      <!-- Analytics Chart -->\n      <div class=\"xl:col-span-2\">\n        ${renderAnalyticsChart()}\n      </div>\n\n      <!-- Recent Activity -->\n      <div\n        class=\"xl:col-span-1\"\n        id=\"recent-activity-container\"\n        hx-get=\"/admin/dashboard/recent-activity\"\n        hx-trigger=\"load\"\n        hx-swap=\"innerHTML\"\n      >\n        ${renderRecentActivitySkeleton()}\n      </div>\n    </div>\n\n    <!-- Secondary Grid -->\n    <div class=\"grid grid-cols-1 gap-6 lg:grid-cols-3\">\n      <!-- Quick Actions -->\n      ${renderQuickActions()}\n\n      <!-- System Status -->\n      ${renderSystemStatus()}\n\n      <!-- Storage Usage -->\n      <div id=\"storage-usage-container\" hx-get=\"/admin/dashboard/storage\" hx-trigger=\"load\" hx-swap=\"innerHTML\">\n        ${renderStorageUsage()}\n      </div>\n    </div>\n\n    <script>\n      function refreshDashboard() {\n        htmx.trigger('#stats-container', 'htmx:load');\n        showNotification('Dashboard refreshed', 'success');\n      }\n    </script>\n  `;\n\n  const layoutData: AdminLayoutData = {\n    title: \"Dashboard\",\n    pageTitle: \"Dashboard\",\n    currentPath: \"/admin\",\n    user: data.user,\n    version: data.version,\n    content: pageContent,\n  };\n\n  return renderAdminLayout(layoutData);\n}\n\nexport function renderDashboardPageWithDynamicMenu(\n  data: DashboardPageData,\n  dynamicMenuItems: Array<{ label: string; path: string; icon: string }>\n): string {\n  const pageContent = `\n    <div class=\"mb-8 flex flex-col sm:flex-row sm:items-center sm:justify-between\">\n      <div>\n        <h1 class=\"text-2xl/8 font-semibold text-zinc-950 dark:text-white sm:text-xl/8\">Dashboard</h1>\n        <p class=\"mt-2 text-sm/6 text-zinc-500 dark:text-zinc-400\">Welcome to your WarpCMS AI admin dashboard</p>\n      </div>\n      <div class=\"mt-4 sm:mt-0 flex items-center gap-x-3\">\n        <a href=\"/admin/content/new\" class=\"inline-flex items-center justify-center gap-x-1.5 rounded-lg bg-lime-600 dark:bg-lime-700 px-3.5 py-2.5 text-sm font-semibold text-white hover:bg-lime-700 dark:hover:bg-lime-600 transition-colors shadow-sm\">\n          <svg class=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M12 4v16m8-8H4\"/>\n          </svg>\n          New Content\n        </a>\n        <a href=\"/api\" target=\"_blank\" class=\"inline-flex items-center justify-center gap-x-1.5 rounded-lg bg-zinc-950 dark:bg-white px-3.5 py-2.5 text-sm font-semibold text-white dark:text-zinc-950 hover:bg-zinc-800 dark:hover:bg-zinc-100 transition-colors shadow-sm\">\n          <svg class=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M17.25 6.75L22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3l-4.5 16.5\"/>\n          </svg>\n          OpenAPI\n        </a>\n      </div>\n    </div>\n\n    <div id=\"stats-container\" class=\"mb-8\" hx-get=\"/admin/dashboard/stats\" hx-trigger=\"load\">\n      ${renderStatsCards({\n        contentItems: 0,\n        mediaFiles: 0,\n        users: 0,\n      })}\n    </div>\n\n    <div class=\"grid grid-cols-1 gap-6 xl:grid-cols-3 mb-8\">\n      <!-- Analytics Chart -->\n      <div class=\"xl:col-span-2\">\n        ${renderAnalyticsChart()}\n      </div>\n\n      <!-- Recent Activity -->\n      <div\n        class=\"xl:col-span-1\"\n        id=\"recent-activity-container\"\n        hx-get=\"/admin/dashboard/recent-activity\"\n        hx-trigger=\"load\"\n        hx-swap=\"innerHTML\"\n      >\n        ${renderRecentActivitySkeleton()}\n      </div>\n    </div>\n\n    <div class=\"grid grid-cols-1 gap-6 lg:grid-cols-3\">\n      <!-- Quick Actions -->\n      ${renderQuickActions()}\n\n      <!-- System Status -->\n      ${renderSystemStatus()}\n\n      <!-- Storage Usage -->\n      <div id=\"storage-usage-container\" hx-get=\"/admin/dashboard/storage\" hx-trigger=\"load\" hx-swap=\"innerHTML\">\n        ${renderStorageUsage()}\n      </div>\n    </div>\n\n    <script>\n      function refreshDashboard() {\n        htmx.trigger('#stats-container', 'htmx:load');\n        showNotification('Dashboard refreshed', 'success');\n      }\n    </script>\n  `;\n\n  const layoutData: AdminLayoutData = {\n    title: \"Dashboard\",\n    pageTitle: \"Dashboard\",\n    currentPath: \"/admin\",\n    user: data.user,\n    version: data.version,\n    enableExperimentalFeatures: data.enableExperimentalFeatures,\n    content: pageContent,\n    dynamicMenuItems,\n  };\n\n  return renderAdminLayout(layoutData);\n}\n\nexport function renderStatsCards(stats: DashboardStats): string {\n  const cards = [\n    {\n      title: \"Content Items\",\n      value: stats.contentItems.toString(),\n      change: \"8.2\",\n      isPositive: true,\n    },\n    {\n      title: \"Media Files\",\n      value: stats.mediaFiles.toString(),\n      change: \"15.3\",\n      isPositive: true,\n    },\n    {\n      title: \"Active Users\",\n      value: stats.users.toString(),\n      change: \"2.4\",\n      isPositive: false,\n    },\n  ];\n\n  const cardColors = ['text-cyan-400', 'text-lime-400', 'text-purple-400'];\n\n  return `\n    <div>\n      <h3 class=\"text-base font-semibold text-zinc-950 dark:text-white\">Last 30 days</h3>\n      <dl class=\"mt-5 grid grid-cols-1 divide-zinc-950/5 dark:divide-white/10 overflow-hidden rounded-lg bg-zinc-800/75 dark:bg-zinc-800/75 ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 md:grid-cols-3 md:divide-x md:divide-y-0\">\n        ${cards.map((card, index) => `\n          <div class=\"px-4 py-5 sm:p-6\">\n            <dt class=\"text-base font-normal text-zinc-700 dark:text-zinc-100\">${card.title}</dt>\n            <dd class=\"mt-1 flex items-baseline justify-between md:block lg:flex\">\n              <div class=\"flex items-baseline text-2xl font-semibold ${cardColors[index]}\">\n                ${card.value}\n              </div>\n              <div class=\"inline-flex items-baseline rounded-full ${card.isPositive ? 'bg-lime-400/10 text-lime-600 dark:text-lime-400' : 'bg-pink-400/10 text-pink-600 dark:text-pink-400'} px-2.5 py-0.5 text-sm font-medium md:mt-2 lg:mt-0\">\n                <svg viewBox=\"0 0 20 20\" fill=\"currentColor\" class=\"-ml-1 mr-0.5 size-5 shrink-0 self-center\">\n                  ${card.isPositive\n                    ? '<path d=\"M10 17a.75.75 0 0 1-.75-.75V5.612L5.29 9.77a.75.75 0 0 1-1.08-1.04l5.25-5.5a.75.75 0 0 1 1.08 0l5.25 5.5a.75.75 0 1 1-1.08 1.04l-3.96-4.158V16.25A.75.75 0 0 1 10 17Z\" clip-rule=\"evenodd\" fill-rule=\"evenodd\" />'\n                    : '<path d=\"M10 3a.75.75 0 0 1 .75.75v10.638l3.96-4.158a.75.75 0 1 1 1.08 1.04l-5.25 5.5a.75.75 0 0 1-1.08 0l-5.25-5.5a.75.75 0 1 1 1.08-1.04l3.96 4.158V3.75A.75.75 0 0 1 10 3Z\" clip-rule=\"evenodd\" fill-rule=\"evenodd\" />'\n                  }\n                </svg>\n                <span class=\"sr-only\">${card.isPositive ? 'Increased' : 'Decreased'} by</span>\n                ${card.change}%\n              </div>\n            </dd>\n          </div>\n        `).join('')}\n      </dl>\n    </div>\n  `;\n}\n\nfunction renderStatsCardsSkeleton(): string {\n  return `\n    <div>\n      <div class=\"h-6 w-32 bg-zinc-200 dark:bg-zinc-700 rounded animate-pulse mb-5\"></div>\n      <div class=\"grid grid-cols-1 divide-zinc-950/5 dark:divide-white/10 overflow-hidden rounded-lg bg-zinc-800/75 dark:bg-zinc-800/75 ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 md:grid-cols-3 md:divide-x md:divide-y-0\">\n        ${Array(3)\n          .fill(0)\n          .map(\n            () => `\n            <div class=\"px-4 py-5 sm:p-6 animate-pulse\">\n              <div class=\"h-4 w-24 bg-zinc-200 dark:bg-zinc-700 rounded mb-3\"></div>\n              <div class=\"h-8 w-16 bg-zinc-200 dark:bg-zinc-700 rounded\"></div>\n            </div>\n          `\n          )\n          .join(\"\")}\n      </div>\n    </div>\n  `;\n}\n\nfunction renderAnalyticsChart(): string {\n  return `\n    <div class=\"rounded-lg bg-white dark:bg-zinc-900 shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10\">\n      <div class=\"border-b border-zinc-950/5 dark:border-white/10 px-6 py-6\">\n        <div class=\"flex flex-wrap items-start justify-between gap-3 sm:flex-nowrap\">\n          <div>\n            <h3 class=\"text-base/7 font-semibold text-zinc-950 dark:text-white\">Real-Time Analytics</h3>\n            <p class=\"mt-1 text-sm/6 text-zinc-500 dark:text-zinc-400\">Requests per second (live)</p>\n          </div>\n          <div class=\"flex items-center gap-2\">\n            <div class=\"h-2 w-2 rounded-full bg-lime-500 animate-pulse\"></div>\n            <span class=\"text-xs text-zinc-500 dark:text-zinc-400\">Live</span>\n          </div>\n        </div>\n        <div class=\"mt-4 flex items-baseline gap-2\">\n          <span id=\"current-rps\" class=\"text-4xl font-bold text-cyan-500 dark:text-cyan-400\">0</span>\n          <span class=\"text-sm text-zinc-500 dark:text-zinc-400\">req/s</span>\n        </div>\n      </div>\n\n      <div class=\"px-6 py-6\">\n        <canvas id=\"requestsChart\" class=\"w-full\" style=\"height: 300px;\"></canvas>\n      </div>\n\n      <!-- Hidden div to trigger HTMX polling -->\n      <div\n        hx-get=\"/admin/dashboard/api/metrics\"\n        hx-trigger=\"every 1s\"\n        hx-swap=\"none\"\n        style=\"display: none;\"\n      ></div>\n    </div>\n\n    <script>\n      // Initialize Chart.js for Real-time Requests\n      (function() {\n        const ctx = document.getElementById('requestsChart');\n        if (!ctx) return;\n\n        // Initialize with last 60 seconds of data (1 data point per second)\n        const maxDataPoints = 60;\n        const labels = [];\n        const data = [];\n\n        for (let i = maxDataPoints - 1; i >= 0; i--) {\n          labels.push(\\`-\\${i}s\\`);\n          data.push(0);\n        }\n\n        const isDark = document.documentElement.classList.contains('dark');\n\n        const chart = new Chart(ctx, {\n          type: 'line',\n          data: {\n            labels: labels,\n            datasets: [{\n              label: 'Requests/sec',\n              data: data,\n              borderColor: isDark ? 'rgb(34, 211, 238)' : 'rgb(6, 182, 212)',\n              backgroundColor: isDark ? 'rgba(34, 211, 238, 0.1)' : 'rgba(6, 182, 212, 0.1)',\n              borderWidth: 2,\n              fill: true,\n              tension: 0.4,\n              pointRadius: 0,\n              pointHoverRadius: 4,\n              pointBackgroundColor: isDark ? 'rgb(34, 211, 238)' : 'rgb(6, 182, 212)',\n              pointBorderColor: isDark ? 'rgb(17, 24, 39)' : 'rgb(255, 255, 255)',\n              pointBorderWidth: 2\n            }]\n          },\n          options: {\n            responsive: true,\n            maintainAspectRatio: false,\n            plugins: {\n              legend: {\n                display: false\n              },\n              tooltip: {\n                backgroundColor: isDark ? 'rgb(39, 39, 42)' : 'rgb(255, 255, 255)',\n                titleColor: isDark ? 'rgb(255, 255, 255)' : 'rgb(9, 9, 11)',\n                bodyColor: isDark ? 'rgb(161, 161, 170)' : 'rgb(113, 113, 122)',\n                borderColor: isDark ? 'rgba(255, 255, 255, 0.1)' : 'rgba(9, 9, 11, 0.05)',\n                borderWidth: 1,\n                padding: 12,\n                displayColors: false,\n                callbacks: {\n                  label: function(context) {\n                    return 'Requests/sec: ' + context.parsed.y.toFixed(2);\n                  }\n                }\n              }\n            },\n            scales: {\n              y: {\n                beginAtZero: true,\n                border: {\n                  display: false\n                },\n                grid: {\n                  color: isDark ? 'rgba(255, 255, 255, 0.05)' : 'rgba(0, 0, 0, 0.05)',\n                  drawBorder: false\n                },\n                ticks: {\n                  color: isDark ? 'rgb(161, 161, 170)' : 'rgb(113, 113, 122)',\n                  padding: 8,\n                  callback: function(value) {\n                    return value.toFixed(1);\n                  }\n                }\n              },\n              x: {\n                border: {\n                  display: false\n                },\n                grid: {\n                  display: false\n                },\n                ticks: {\n                  color: isDark ? 'rgb(161, 161, 170)' : 'rgb(113, 113, 122)',\n                  padding: 8,\n                  maxTicksLimit: 6\n                }\n              }\n            }\n          }\n        });\n\n        // Listen for metrics updates from HTMX\n        window.addEventListener('htmx:afterRequest', function(event) {\n          console.log('[Dashboard] HTMX request completed:', event.detail.pathInfo.requestPath);\n\n          if (event.detail.pathInfo.requestPath === '/admin/dashboard/api/metrics') {\n            try {\n              const metrics = JSON.parse(event.detail.xhr.responseText);\n              console.log('[Dashboard] Metrics received:', metrics);\n\n              // Update current RPS display\n              const rpsElement = document.getElementById('current-rps');\n              if (rpsElement) {\n                rpsElement.textContent = metrics.requestsPerSecond.toFixed(2);\n              }\n\n              // Add new data point to chart\n              chart.data.datasets[0].data.shift();\n              chart.data.datasets[0].data.push(metrics.requestsPerSecond);\n\n              // Regenerate labels to maintain -60s to now format\n              const newLabels = [];\n              for (let i = maxDataPoints - 1; i >= 1; i--) {\n                newLabels.push(\\`-\\${i}s\\`);\n              }\n              newLabels.push('now');\n              chart.data.labels = newLabels;\n\n              chart.update('none'); // Update without animation for smoother real-time updates\n              console.log('[Dashboard] Chart updated with RPS:', metrics.requestsPerSecond);\n            } catch (e) {\n              console.error('[Dashboard] Error updating metrics:', e);\n            }\n          }\n        });\n      })();\n    </script>\n  `;\n}\n\nexport function renderRecentActivitySkeleton(): string {\n  return `\n    <div class=\"rounded-lg bg-white dark:bg-zinc-900 shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10 animate-pulse\">\n      <div class=\"border-b border-zinc-950/5 dark:border-white/10 px-6 py-6\">\n        <div class=\"h-5 w-32 bg-zinc-200 dark:bg-zinc-700 rounded\"></div>\n      </div>\n      <div class=\"px-6 py-6\">\n        <div class=\"space-y-6\">\n          ${Array(3).fill(0).map(() => `\n            <div class=\"flex gap-x-4\">\n              <div class=\"h-10 w-10 rounded-full bg-zinc-200 dark:bg-zinc-700\"></div>\n              <div class=\"flex-auto space-y-2\">\n                <div class=\"h-4 w-48 bg-zinc-200 dark:bg-zinc-700 rounded\"></div>\n                <div class=\"h-3 w-32 bg-zinc-200 dark:bg-zinc-700 rounded\"></div>\n              </div>\n            </div>\n          `).join('')}\n        </div>\n      </div>\n    </div>\n  `\n}\n\nexport function renderRecentActivity(activities?: ActivityItem[]): string {\n  // Helper to get user initials\n  const getInitials = (user: string): string => {\n    const parts = user.split(' ').filter(p => p.length > 0)\n    if (parts.length >= 2) {\n      const first = parts[0]?.[0] || ''\n      const second = parts[1]?.[0] || ''\n      return (first + second).toUpperCase()\n    }\n    return user.substring(0, 2).toUpperCase()\n  }\n\n  // Helper to get relative time\n  const getRelativeTime = (timestamp: string): string => {\n    const date = new Date(timestamp)\n    const now = new Date()\n    const diffMs = now.getTime() - date.getTime()\n    const diffMins = Math.floor(diffMs / 60000)\n    const diffHours = Math.floor(diffMins / 60)\n    const diffDays = Math.floor(diffHours / 24)\n\n    if (diffMins < 1) return 'just now'\n    if (diffMins < 60) return `${diffMins} minute${diffMins > 1 ? 's' : ''} ago`\n    if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`\n    return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`\n  }\n\n  // Helper to get color classes based on activity type\n  const getColorClasses = (type: string): { bgColor: string; textColor: string } => {\n    switch (type) {\n      case 'content':\n        return {\n          bgColor: 'bg-lime-500/10 dark:bg-lime-400/10',\n          textColor: 'text-lime-700 dark:text-lime-300'\n        }\n      case 'media':\n        return {\n          bgColor: 'bg-cyan-500/10 dark:bg-cyan-400/10',\n          textColor: 'text-cyan-700 dark:text-cyan-300'\n        }\n      case 'user':\n        return {\n          bgColor: 'bg-pink-500/10 dark:bg-pink-400/10',\n          textColor: 'text-pink-700 dark:text-pink-300'\n        }\n      default:\n        return {\n          bgColor: 'bg-gray-500/10 dark:bg-gray-400/10',\n          textColor: 'text-gray-700 dark:text-gray-300'\n        }\n    }\n  }\n\n  // Format activities with colors and times\n  const formattedActivities = (activities || []).map(activity => {\n    const colors = getColorClasses(activity.type)\n    return {\n      ...activity,\n      initials: getInitials(activity.user),\n      time: getRelativeTime(activity.timestamp),\n      ...colors\n    }\n  })\n\n  // If no activities, show empty state\n  if (formattedActivities.length === 0) {\n    formattedActivities.push({\n      type: 'content' as const,\n      description: 'No recent activity',\n      user: 'System',\n      time: '',\n      initials: 'SY',\n      bgColor: 'bg-gray-500/10 dark:bg-gray-400/10',\n      textColor: 'text-gray-700 dark:text-gray-300',\n      id: '0',\n      action: '',\n      timestamp: new Date().toISOString()\n    })\n  }\n\n  return `\n    <div class=\"rounded-lg bg-white dark:bg-zinc-900 shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10\">\n      <div class=\"border-b border-zinc-950/5 dark:border-white/10 px-6 py-6\">\n        <div class=\"flex items-center justify-between\">\n          <h3 class=\"text-base/7 font-semibold text-zinc-950 dark:text-white\">Recent Activity</h3>\n          <button class=\"text-xs/5 font-medium text-zinc-500 hover:text-zinc-700 dark:text-zinc-400 dark:hover:text-zinc-300 transition-colors\">\n            View all\n          </button>\n        </div>\n      </div>\n\n      <div class=\"px-6 py-6\">\n        <ul role=\"list\" class=\"space-y-6\">\n          ${formattedActivities\n            .map(\n              (activity) => `\n            <li class=\"relative flex gap-x-4\">\n              <div class=\"flex h-10 w-10 flex-none items-center justify-center rounded-full ${activity.bgColor}\">\n                <span class=\"text-xs font-semibold ${activity.textColor}\">${activity.initials}</span>\n              </div>\n              <div class=\"flex-auto\">\n                <p class=\"text-sm/6 font-medium text-zinc-950 dark:text-white\">${activity.description}</p>\n                <p class=\"mt-1 text-xs/5 text-zinc-500 dark:text-zinc-400\">\n                  <span class=\"font-medium text-zinc-950 dark:text-white\">${activity.user}</span>\n                  <span class=\"text-zinc-400 dark:text-zinc-500\">  </span>\n                  ${activity.time}\n                </p>\n              </div>\n            </li>\n          `\n            )\n            .join(\"\")}\n        </ul>\n      </div>\n    </div>\n  `;\n}\n\nfunction renderQuickActions(): string {\n  const actions = [\n    {\n      title: \"New Image\",\n      description: \"Upload and manage images\",\n      href: \"/admin/content/new?type=image\",\n      icon: `<svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\"/>\n      </svg>`,\n    },\n    {\n      title: \"New Text\",\n      description: \"Create plain text content\",\n      href: \"/admin/content/new?type=text\",\n      icon: `<svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 6h16M4 12h16M4 18h7\"/>\n      </svg>`,\n    },\n    {\n      title: \"New HTML\",\n      description: \"Create rich HTML content\",\n      href: \"/admin/content/new?type=html\",\n      icon: `<svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4\"/>\n      </svg>`,\n    },\n    {\n      title: \"Manage Users\",\n      description: \"Add or edit user accounts\",\n      href: \"/admin/users\",\n      icon: `<svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z\"/>\n      </svg>`,\n    },\n  ];\n\n  return `\n    <div class=\"rounded-lg bg-white dark:bg-zinc-900 shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10\">\n      <div class=\"border-b border-zinc-950/5 dark:border-white/10 px-6 py-6\">\n        <h3 class=\"text-base/7 font-semibold text-zinc-950 dark:text-white\">Quick Actions</h3>\n      </div>\n\n      <div class=\"p-6\">\n        <div class=\"space-y-2\">\n          ${actions\n            .map(\n              (action) => `\n            <a href=\"${action.href}\" class=\"group flex items-center gap-x-3 rounded-lg px-3 py-2 hover:bg-zinc-50 dark:hover:bg-zinc-800/50 transition-colors\">\n              <div class=\"flex h-10 w-10 flex-none items-center justify-center text-zinc-400 dark:text-zinc-500 group-hover:text-zinc-600 dark:group-hover:text-zinc-400\">\n                ${action.icon}\n              </div>\n              <div class=\"flex-auto\">\n                <p class=\"text-sm/6 font-medium text-zinc-950 dark:text-white\">${action.title}</p>\n                <p class=\"text-xs/5 text-zinc-500 dark:text-zinc-400\">${action.description}</p>\n              </div>\n              <svg class=\"h-5 w-5 flex-none text-zinc-400 dark:text-zinc-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.5\" d=\"M8.25 4.5l7.5 7.5-7.5 7.5\"/>\n              </svg>\n            </a>\n          `\n            )\n            .join(\"\")}\n        </div>\n      </div>\n    </div>\n  `;\n}\n\nfunction renderSystemStatus(): string {\n  return `\n    <div class=\"rounded-lg bg-white dark:bg-zinc-900 shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10 overflow-hidden\">\n      <div class=\"border-b border-zinc-950/5 dark:border-white/10 px-6 py-6\">\n        <div class=\"flex items-center justify-between\">\n          <h3 class=\"text-base/7 font-semibold text-zinc-950 dark:text-white\">System Status</h3>\n          <div class=\"flex items-center gap-2\">\n            <div class=\"h-2 w-2 rounded-full bg-lime-500 animate-pulse\"></div>\n            <span class=\"text-xs text-zinc-500 dark:text-zinc-400\">Live</span>\n          </div>\n        </div>\n      </div>\n\n      <div\n        id=\"system-status-container\"\n        class=\"p-6\"\n        hx-get=\"/admin/dashboard/system-status\"\n        hx-trigger=\"load, every 30s\"\n        hx-swap=\"innerHTML\"\n      >\n        <!-- Loading skeleton with gradient -->\n        <div class=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n          ${[\n            { color: 'from-blue-500/20 to-cyan-500/20', darkColor: 'dark:from-blue-500/10 dark:to-cyan-500/10' },\n            { color: 'from-purple-500/20 to-pink-500/20', darkColor: 'dark:from-purple-500/10 dark:to-pink-500/10' },\n            { color: 'from-amber-500/20 to-orange-500/20', darkColor: 'dark:from-amber-500/10 dark:to-orange-500/10' },\n            { color: 'from-lime-500/20 to-emerald-500/20', darkColor: 'dark:from-lime-500/10 dark:to-emerald-500/10' }\n          ].map((gradient, i) => `\n            <div class=\"relative group\">\n              <div class=\"absolute inset-0 bg-gradient-to-br ${gradient.color} ${gradient.darkColor} rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300\"></div>\n              <div class=\"relative bg-zinc-50 dark:bg-zinc-800/50 rounded-xl p-5 border border-zinc-200/50 dark:border-zinc-700/50 animate-pulse\">\n                <div class=\"flex items-center justify-between mb-3\">\n                  <div class=\"h-4 w-24 bg-zinc-200 dark:bg-zinc-700 rounded\"></div>\n                  <div class=\"h-6 w-6 bg-zinc-200 dark:bg-zinc-700 rounded-full\"></div>\n                </div>\n                <div class=\"h-3 w-20 bg-zinc-200 dark:bg-zinc-700 rounded\"></div>\n              </div>\n            </div>\n          `).join('')}\n        </div>\n      </div>\n    </div>\n\n    <style>\n      @keyframes ping-slow {\n        0%, 100% { opacity: 1; }\n        50% { opacity: 0.5; }\n      }\n      .animate-ping-slow {\n        animation: ping-slow 3s cubic-bezier(0.4, 0, 0.6, 1) infinite;\n      }\n    </style>\n  `;\n}\n\nexport function renderStorageUsage(databaseSizeBytes?: number, mediaSizeBytes?: number): string {\n  // Helper to format bytes to human readable\n  const formatBytes = (bytes: number): string => {\n    if (bytes === 0) return '0 B'\n    const k = 1024\n    const sizes = ['B', 'KB', 'MB', 'GB']\n    const i = Math.floor(Math.log(bytes) / Math.log(k))\n    return `${(bytes / Math.pow(k, i)).toFixed(2)} ${sizes[i]}`\n  }\n\n  const dbSizeGB = databaseSizeBytes ? databaseSizeBytes / (1024 ** 3) : 0\n  const dbMaxGB = 10\n  const dbPercentageRaw = (dbSizeGB / dbMaxGB) * 100\n  // Ensure minimum 0.5% visibility for progress bar, max 100%\n  const dbPercentage = Math.min(Math.max(dbPercentageRaw, 0.5), 100)\n  const dbUsedFormatted = databaseSizeBytes ? formatBytes(databaseSizeBytes) : 'Unknown'\n\n  const mediaUsedFormatted = mediaSizeBytes ? formatBytes(mediaSizeBytes) : '0 B'\n\n  const storageItems = [\n    {\n      label: \"Database\",\n      used: dbUsedFormatted,\n      total: \"10 GB\",\n      percentage: dbPercentage,\n      color: dbPercentage > 80 ? \"bg-red-500 dark:bg-red-400\" : dbPercentage > 60 ? \"bg-amber-500 dark:bg-amber-400\" : \"bg-cyan-500 dark:bg-cyan-400\",\n    },\n    {\n      label: \"Media Files\",\n      used: mediaUsedFormatted,\n      total: \"\",\n      percentage: 0,\n      color: \"bg-lime-500 dark:bg-lime-400\",\n      note: \"Stored in R2\"\n    },\n    {\n      label: \"Cache (KV)\",\n      used: \"N/A\",\n      total: \"\",\n      percentage: 0,\n      color: \"bg-purple-500 dark:bg-purple-400\",\n      note: \"Unlimited\"\n    },\n  ];\n\n  return `\n    <div class=\"rounded-lg bg-white dark:bg-zinc-900 shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10\">\n      <div class=\"border-b border-zinc-950/5 dark:border-white/10 px-6 py-6\">\n        <h3 class=\"text-base/7 font-semibold text-zinc-950 dark:text-white\">Storage Usage</h3>\n      </div>\n\n      <div class=\"px-6 py-6\">\n        <dl class=\"space-y-6\">\n          ${storageItems\n            .map(\n              (item: any) => `\n            <div>\n              <div class=\"flex items-center justify-between mb-2\">\n                <dt class=\"text-sm/6 text-zinc-500 dark:text-zinc-400\">\n                  ${item.label}\n                  ${item.note ? `<span class=\"ml-2 text-xs text-zinc-400 dark:text-zinc-500\">(${item.note})</span>` : ''}\n                </dt>\n                <dd class=\"text-sm/6 font-medium text-zinc-950 dark:text-white\">${item.used} / ${item.total}</dd>\n              </div>\n              <div class=\"w-full bg-zinc-100 dark:bg-zinc-800 rounded-full h-1.5 overflow-hidden\">\n                <div class=\"${item.color} h-full rounded-full transition-all duration-300\" style=\"width: ${item.percentage}%\"></div>\n              </div>\n            </div>\n          `\n            )\n            .join(\"\")}\n        </dl>\n      </div>\n    </div>\n  `;\n}","import { Hono } from 'hono'\nimport type { D1Database, KVNamespace, R2Bucket } from '@cloudflare/workers-types'\nimport { requireAuth } from '../middleware'\nimport {\n  renderDashboardPage,\n  type DashboardPageData,\n  renderStatsCards,\n  renderStorageUsage,\n  renderRecentActivity,\n  type ActivityItem\n} from '../templates/pages/admin-dashboard.template'\nimport { getCoreVersion } from '../utils/version'\nimport { metricsTracker } from '../utils/metrics'\n\nconst VERSION = getCoreVersion()\n\ntype Bindings = {\n  DB: D1Database\n  CACHE_KV: KVNamespace\n  MEDIA_BUCKET: R2Bucket\n}\n\ntype Variables = {\n  user?: {\n    userId: string\n    email: string\n    role: string\n  }\n}\n\nconst router = new Hono<{ Bindings: Bindings; Variables: Variables }>()\n\n// Apply authentication middleware\nrouter.use('*', requireAuth())\n\n/**\n * GET /admin - Admin Dashboard\n */\nrouter.get('/', async (c) => {\n  const user = c.get('user')\n\n  try {\n    const pageData: DashboardPageData = {\n      user: {\n        name: user!.email.split('@')[0] || user!.email,\n        email: user!.email,\n        role: user!.role\n      },\n      version: VERSION\n    }\n\n    return c.html(renderDashboardPage(pageData))\n  } catch (error) {\n    console.error('Dashboard error:', error)\n\n    // Return dashboard with error state\n    const pageData: DashboardPageData = {\n      user: {\n        name: user!.email,\n        email: user!.email,\n        role: user!.role\n      },\n      version: VERSION\n    }\n\n    return c.html(renderDashboardPage(pageData))\n  }\n})\n\n/**\n * GET /admin/dashboard/stats - Dashboard stats HTML fragment (HTMX endpoint)\n */\nrouter.get('/stats', async (c) => {\n  try {\n    const db = c.env.DB\n\n    // Get content count\n    let contentCount = 0\n    try {\n      const contentStmt = db.prepare('SELECT COUNT(*) as count FROM content')\n      const contentResult = await contentStmt.first()\n      contentCount = (contentResult as any)?.count || 0\n    } catch (error) {\n      console.error('Error fetching content count:', error)\n    }\n\n    // Get media count and total size\n    let mediaCount = 0\n    let mediaSize = 0\n    try {\n      const mediaStmt = db.prepare('SELECT COUNT(*) as count, COALESCE(SUM(size), 0) as total_size FROM media WHERE deleted_at IS NULL')\n      const mediaResult = await mediaStmt.first()\n      mediaCount = (mediaResult as any)?.count || 0\n      mediaSize = (mediaResult as any)?.total_size || 0\n    } catch (error) {\n      console.error('Error fetching media count:', error)\n    }\n\n    // Get users count\n    let usersCount = 0\n    try {\n      const usersStmt = db.prepare('SELECT COUNT(*) as count FROM users WHERE is_active = 1')\n      const usersResult = await usersStmt.first()\n      usersCount = (usersResult as any)?.count || 0\n    } catch (error) {\n      console.error('Error fetching users count:', error)\n    }\n\n    const html = renderStatsCards({\n      contentItems: contentCount,\n      mediaFiles: mediaCount,\n      users: usersCount,\n      mediaSize: mediaSize\n    })\n\n    return c.html(html)\n  } catch (error) {\n    console.error('Error fetching stats:', error)\n    return c.html('<div class=\"text-red-500\">Failed to load statistics</div>')\n  }\n})\n\n/**\n * GET /admin/dashboard/storage - Storage usage HTML fragment (HTMX endpoint)\n */\nrouter.get('/storage', async (c) => {\n  try {\n    const db = c.env.DB\n\n    // Get database size from D1 metadata\n    let databaseSize = 0\n    try {\n      const result = await db.prepare('SELECT 1').run()\n      databaseSize = (result as any)?.meta?.size_after || 0\n    } catch (error) {\n      console.error('Error fetching database size:', error)\n    }\n\n    // Get media total size\n    let mediaSize = 0\n    try {\n      const mediaStmt = db.prepare('SELECT COALESCE(SUM(size), 0) as total_size FROM media WHERE deleted_at IS NULL')\n      const mediaResult = await mediaStmt.first()\n      mediaSize = (mediaResult as any)?.total_size || 0\n    } catch (error) {\n      console.error('Error fetching media size:', error)\n    }\n\n    const html = renderStorageUsage(databaseSize, mediaSize)\n    return c.html(html)\n  } catch (error) {\n    console.error('Error fetching storage usage:', error)\n    return c.html('<div class=\"text-red-500\">Failed to load storage information</div>')\n  }\n})\n\n/**\n * GET /admin/dashboard/recent-activity - Recent activity HTML fragment (HTMX endpoint)\n */\nrouter.get('/recent-activity', async (c) => {\n  try {\n    const db = c.env.DB\n    const limit = parseInt(c.req.query('limit') || '5')\n\n    // Get recent activities from activity_logs table\n    const activityStmt = db.prepare(`\n      SELECT\n        a.id,\n        a.action,\n        a.resource_type,\n        a.resource_id,\n        a.details,\n        a.created_at,\n        u.email,\n        u.first_name,\n        u.last_name\n      FROM activity_logs a\n      LEFT JOIN users u ON a.user_id = u.id\n      WHERE a.resource_type IN ('content', 'users', 'media')\n      ORDER BY a.created_at DESC\n      LIMIT ?\n    `)\n\n    const { results } = await activityStmt.bind(limit).all()\n\n    const activities: ActivityItem[] = (results || []).map((row: any) => {\n      const userName = row.first_name && row.last_name\n        ? `${row.first_name} ${row.last_name}`\n        : row.email || 'System'\n\n      // Format description based on action and resource type\n      let description = ''\n      if (row.action === 'create') {\n        description = `Created new ${row.resource_type}`\n      } else if (row.action === 'update') {\n        description = `Updated ${row.resource_type}`\n      } else if (row.action === 'delete') {\n        description = `Deleted ${row.resource_type}`\n      } else {\n        description = `${row.action} ${row.resource_type}`\n      }\n\n      return {\n        id: row.id,\n        type: row.resource_type,\n        action: row.action,\n        description,\n        timestamp: new Date(Number(row.created_at)).toISOString(),\n        user: userName\n      }\n    })\n\n    const html = renderRecentActivity(activities)\n    return c.html(html)\n  } catch (error) {\n    console.error('Error fetching recent activity:', error)\n    const html = renderRecentActivity([])\n    return c.html(html)\n  }\n})\n\n/**\n * GET /admin/api/metrics - Real-time metrics for analytics chart\n * Returns JSON with current requests per second from the metrics tracker\n */\nrouter.get('/api/metrics', async (c) => {\n  return c.json({\n    requestsPerSecond: metricsTracker.getRequestsPerSecond(),\n    totalRequests: metricsTracker.getTotalRequests(),\n    averageRPS: Number(metricsTracker.getAverageRPS().toFixed(2)),\n    timestamp: new Date().toISOString()\n  })\n})\n\n/**\n * GET /admin/dashboard/system-status - System status HTML fragment (HTMX endpoint)\n */\nrouter.get('/system-status', async (c) => {\n  try {\n    const html = `\n      <div class=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n        <div class=\"relative group\">\n          <div class=\"absolute inset-0 bg-gradient-to-br from-blue-500/20 to-cyan-500/20 dark:from-blue-500/10 dark:to-cyan-500/10 rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300\"></div>\n          <div class=\"relative bg-zinc-50 dark:bg-zinc-800/50 rounded-xl p-5 border border-zinc-200/50 dark:border-zinc-700/50\">\n            <div class=\"flex items-center justify-between mb-3\">\n              <span class=\"text-sm font-medium text-zinc-600 dark:text-zinc-400\">API Status</span>\n              <svg class=\"w-6 h-6 text-lime-500\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clip-rule=\"evenodd\"/>\n              </svg>\n            </div>\n            <p class=\"text-xs text-zinc-500 dark:text-zinc-400\">Operational</p>\n          </div>\n        </div>\n\n        <div class=\"relative group\">\n          <div class=\"absolute inset-0 bg-gradient-to-br from-purple-500/20 to-pink-500/20 dark:from-purple-500/10 dark:to-pink-500/10 rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300\"></div>\n          <div class=\"relative bg-zinc-50 dark:bg-zinc-800/50 rounded-xl p-5 border border-zinc-200/50 dark:border-zinc-700/50\">\n            <div class=\"flex items-center justify-between mb-3\">\n              <span class=\"text-sm font-medium text-zinc-600 dark:text-zinc-400\">Database</span>\n              <svg class=\"w-6 h-6 text-lime-500\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clip-rule=\"evenodd\"/>\n              </svg>\n            </div>\n            <p class=\"text-xs text-zinc-500 dark:text-zinc-400\">Connected</p>\n          </div>\n        </div>\n\n        <div class=\"relative group\">\n          <div class=\"absolute inset-0 bg-gradient-to-br from-amber-500/20 to-orange-500/20 dark:from-amber-500/10 dark:to-orange-500/10 rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300\"></div>\n          <div class=\"relative bg-zinc-50 dark:bg-zinc-800/50 rounded-xl p-5 border border-zinc-200/50 dark:border-zinc-700/50\">\n            <div class=\"flex items-center justify-between mb-3\">\n              <span class=\"text-sm font-medium text-zinc-600 dark:text-zinc-400\">R2 Storage</span>\n              <svg class=\"w-6 h-6 text-lime-500\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clip-rule=\"evenodd\"/>\n              </svg>\n            </div>\n            <p class=\"text-xs text-zinc-500 dark:text-zinc-400\">Available</p>\n          </div>\n        </div>\n\n        <div class=\"relative group\">\n          <div class=\"absolute inset-0 bg-gradient-to-br from-lime-500/20 to-emerald-500/20 dark:from-lime-500/10 dark:to-emerald-500/10 rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300\"></div>\n          <div class=\"relative bg-zinc-50 dark:bg-zinc-800/50 rounded-xl p-5 border border-zinc-200/50 dark:border-zinc-700/50\">\n            <div class=\"flex items-center justify-between mb-3\">\n              <span class=\"text-sm font-medium text-zinc-600 dark:text-zinc-400\">KV Cache</span>\n              <svg class=\"w-6 h-6 text-lime-500\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clip-rule=\"evenodd\"/>\n              </svg>\n            </div>\n            <p class=\"text-xs text-zinc-500 dark:text-zinc-400\">Ready</p>\n          </div>\n        </div>\n      </div>\n    `\n    return c.html(html)\n  } catch (error) {\n    console.error('Error fetching system status:', error)\n    return c.html('<div class=\"text-red-500\">Failed to load system status</div>')\n  }\n})\n\nexport { router as adminDashboardRoutes }\n","import { renderAdminLayoutCatalyst, AdminLayoutCatalystData } from '../layouts/admin-layout-catalyst.template'\nimport { renderConfirmationDialog, getConfirmationDialogScript } from '../components/confirmation-dialog.template'\n\nexport interface SettingsPageData {\n  user?: {\n    name: string\n    email: string\n    role: string\n  }\n  settings?: {\n    general?: GeneralSettings\n    appearance?: AppearanceSettings\n    security?: SecuritySettings\n    notifications?: NotificationSettings\n    storage?: StorageSettings\n    migrations?: MigrationSettings\n    databaseTools?: DatabaseToolsSettings\n  }\n  activeTab?: string\n  version?: string\n}\n\nexport interface GeneralSettings {\n  siteName: string\n  siteDescription: string\n  adminEmail: string\n  timezone: string\n  language: string\n  maintenanceMode: boolean\n}\n\nexport interface AppearanceSettings {\n  theme: 'light' | 'dark' | 'auto'\n  primaryColor: string\n  logoUrl: string\n  favicon: string\n  customCSS: string\n}\n\nexport interface SecuritySettings {\n  twoFactorEnabled: boolean\n  sessionTimeout: number\n  passwordRequirements: {\n    minLength: number\n    requireUppercase: boolean\n    requireNumbers: boolean\n    requireSymbols: boolean\n  }\n  ipWhitelist: string[]\n}\n\nexport interface NotificationSettings {\n  emailNotifications: boolean\n  contentUpdates: boolean\n  systemAlerts: boolean\n  userRegistrations: boolean\n  emailFrequency: 'immediate' | 'daily' | 'weekly'\n}\n\nexport interface StorageSettings {\n  maxFileSize: number\n  allowedFileTypes: string[]\n  storageProvider: 'local' | 'cloudflare' | 's3'\n  backupFrequency: 'daily' | 'weekly' | 'monthly'\n  retentionPeriod: number\n}\n\nexport interface MigrationSettings {\n  totalMigrations: number\n  appliedMigrations: number\n  pendingMigrations: number\n  lastApplied?: string\n  migrations: Array<{\n    id: string\n    name: string\n    filename: string\n    description?: string\n    applied: boolean\n    appliedAt?: string\n    size?: number\n  }>\n}\n\nexport interface DatabaseToolsSettings {\n  totalTables: number\n  totalRows: number\n  lastBackup?: string\n  databaseSize?: string\n  tables: Array<{\n    name: string\n    rowCount: number\n  }>\n}\n\nexport function renderSettingsPage(data: SettingsPageData): string {\n  const activeTab = data.activeTab || 'general'\n  \n  const pageContent = `\n    <div>\n      <!-- Header -->\n      <div class=\"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6\">\n        <div>\n          <h1 class=\"text-2xl/8 font-semibold text-zinc-950 dark:text-white sm:text-xl/8\">Settings</h1>\n          <p class=\"mt-2 text-sm/6 text-zinc-500 dark:text-zinc-400\">Manage your application settings and preferences</p>\n        </div>\n      </div>\n\n      <!-- Settings Navigation Tabs -->\n      <div class=\"rounded-xl bg-white dark:bg-zinc-900 shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10 mb-6 overflow-hidden\">\n        <div class=\"border-b border-zinc-950/5 dark:border-white/10\">\n          <nav class=\"flex overflow-x-auto\" role=\"tablist\">\n            ${renderTabButton('general', 'General', 'M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z M15 12a3 3 0 11-6 0 3 3 0 016 0z', activeTab)}\n            ${renderTabButton('appearance', 'Appearance', 'M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v12a4 4 0 004 4h4a2 2 0 002-2V5z', activeTab)}\n            ${renderTabButton('security', 'Security', 'M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z', activeTab)}\n            ${renderTabButton('notifications', 'Notifications', 'M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9', activeTab)}\n            ${renderTabButton('storage', 'Storage', 'M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12', activeTab)}\n            ${renderTabButton('migrations', 'Migrations', 'M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4', activeTab)}\n            ${renderTabButton('database-tools', 'Database Tools', 'M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01', activeTab)}\n          </nav>\n        </div>\n      </div>\n\n      <!-- Settings Content -->\n      <div class=\"rounded-xl bg-white dark:bg-zinc-900 shadow-sm ring-1 ring-zinc-950/5 dark:ring-white/10\">\n        <div id=\"settings-content\" class=\"p-8\">\n          ${renderTabContent(activeTab, data.settings)}\n        </div>\n      </div>\n    </div>\n\n    <script>\n      // Initialize tab-specific features on page load\n      const currentTab = '${activeTab}';\n\n      async function saveGeneralSettings() {\n        // Collect all form data from general settings\n        const formData = new FormData();\n\n        // Get all form inputs in the settings content area\n        document.querySelectorAll('#settings-content input, #settings-content select, #settings-content textarea').forEach(input => {\n          if (input.type === 'checkbox') {\n            formData.append(input.name, input.checked ? 'true' : 'false');\n          } else if (input.name) {\n            formData.append(input.name, input.value);\n          }\n        });\n\n        // Show loading state\n        const saveBtn = document.querySelector('button[onclick=\"saveGeneralSettings()\"]');\n        const originalText = saveBtn.innerHTML;\n        saveBtn.innerHTML = '<svg class=\"animate-spin -ml-0.5 mr-1.5 h-5 w-5 inline\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle><path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z\"></path></svg>Saving...';\n        saveBtn.disabled = true;\n\n        try {\n          const response = await fetch('/admin/settings/general', {\n            method: 'POST',\n            body: formData\n          });\n\n          const result = await response.json();\n\n          if (result.success) {\n            showNotification(result.message || 'Settings saved successfully!', 'success');\n          } else {\n            showNotification(result.error || 'Failed to save settings', 'error');\n          }\n        } catch (error) {\n          console.error('Error saving settings:', error);\n          showNotification('Failed to save settings. Please try again.', 'error');\n        } finally {\n          saveBtn.innerHTML = originalText;\n          saveBtn.disabled = false;\n        }\n      }\n\n      // Migration functions\n      window.refreshMigrationStatus = async function() {\n        try {\n          const response = await fetch('/admin/settings/api/migrations/status');\n          const result = await response.json();\n          \n          if (result.success) {\n            updateMigrationUI(result.data);\n          } else {\n            console.error('Failed to refresh migration status');\n          }\n        } catch (error) {\n          console.error('Error loading migration status:', error);\n        }\n      };\n\n      window.runPendingMigrations = async function() {\n        const btn = document.getElementById('run-migrations-btn');\n        if (!btn || btn.disabled) return;\n\n        showConfirmDialog('run-migrations-confirm');\n      };\n\n      window.performRunMigrations = async function() {\n        const btn = document.getElementById('run-migrations-btn');\n        if (!btn) return;\n\n        btn.disabled = true;\n        btn.innerHTML = 'Running...';\n\n        try {\n          const response = await fetch('/admin/settings/api/migrations/run', {\n            method: 'POST'\n          });\n          const result = await response.json();\n\n          if (result.success) {\n            alert(result.message);\n            setTimeout(() => window.refreshMigrationStatus(), 1000);\n          } else {\n            alert(result.error || 'Failed to run migrations');\n          }\n        } catch (error) {\n          alert('Error running migrations');\n        } finally {\n          btn.disabled = false;\n          btn.innerHTML = 'Run Pending';\n        }\n      };\n\n      window.validateSchema = async function() {\n        try {\n          const response = await fetch('/admin/settings/api/migrations/validate');\n          const result = await response.json();\n          \n          if (result.success) {\n            if (result.data.valid) {\n              alert('Database schema is valid');\n            } else {\n              alert(\\`Schema validation failed: \\${result.data.issues.join(', ')}\\`);\n            }\n          } else {\n            alert('Failed to validate schema');\n          }\n        } catch (error) {\n          alert('Error validating schema');\n        }\n      };\n\n      window.updateMigrationUI = function(data) {\n        const totalEl = document.getElementById('total-migrations');\n        const appliedEl = document.getElementById('applied-migrations');\n        const pendingEl = document.getElementById('pending-migrations');\n        \n        if (totalEl) totalEl.textContent = data.totalMigrations;\n        if (appliedEl) appliedEl.textContent = data.appliedMigrations;\n        if (pendingEl) pendingEl.textContent = data.pendingMigrations;\n        \n        const runBtn = document.getElementById('run-migrations-btn');\n        if (runBtn) {\n          runBtn.disabled = data.pendingMigrations === 0;\n        }\n        \n        // Update migrations list\n        const listContainer = document.getElementById('migrations-list');\n        if (listContainer && data.migrations && data.migrations.length > 0) {\n          listContainer.innerHTML = data.migrations.map(migration => \\`\n            <div class=\"px-6 py-4 flex items-center justify-between\">\n              <div class=\"flex-1\">\n                <div class=\"flex items-center space-x-3\">\n                  <div class=\"flex-shrink-0\">\n                    \\${migration.applied \n                      ? '<svg class=\"w-5 h-5 text-green-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"/></svg>'\n                      : '<svg class=\"w-5 h-5 text-orange-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"/></svg>'\n                    }\n                  </div>\n                  <div>\n                    <h5 class=\"text-white font-medium\">\\${migration.name}</h5>\n                    <p class=\"text-sm text-gray-300\">\\${migration.filename}</p>\n                    \\${migration.description ? \\`<p class=\"text-xs text-gray-400 mt-1\">\\${migration.description}</p>\\` : ''}\n                  </div>\n                </div>\n              </div>\n              \n              <div class=\"flex items-center space-x-4 text-sm\">\n                \\${migration.size ? \\`<span class=\"text-gray-400\">\\${(migration.size / 1024).toFixed(1)} KB</span>\\` : ''}\n                <span class=\"px-2 py-1 rounded-full text-xs font-medium \\${\n                  migration.applied \n                    ? 'bg-green-100 text-green-800' \n                    : 'bg-orange-100 text-orange-800'\n                }\">\n                  \\${migration.applied ? 'Applied' : 'Pending'}\n                </span>\n                \\${migration.appliedAt ? \\`<span class=\"text-gray-400\">\\${new Date(migration.appliedAt).toLocaleDateString()}</span>\\` : ''}\n              </div>\n            </div>\n          \\`).join('');\n        }\n      };\n      \n      // Auto-load migrations when switching to that tab\n      function initializeMigrations() {\n        if (currentTab === 'migrations') {\n          setTimeout(window.refreshMigrationStatus, 500);\n        }\n      }\n      \n      // Database Tools functions\n      window.refreshDatabaseStats = async function() {\n        try {\n          const response = await fetch('/admin/settings/api/database-tools/stats');\n          const result = await response.json();\n          \n          if (result.success) {\n            updateDatabaseToolsUI(result.data);\n          } else {\n            console.error('Failed to refresh database stats');\n          }\n        } catch (error) {\n          console.error('Error loading database stats:', error);\n        }\n      };\n\n      window.createDatabaseBackup = async function() {\n        const btn = document.getElementById('create-backup-btn');\n        if (!btn) return;\n        \n        btn.disabled = true;\n        btn.innerHTML = 'Creating Backup...';\n        \n        try {\n          const response = await fetch('/admin/settings/api/database-tools/backup', {\n            method: 'POST'\n          });\n          const result = await response.json();\n          \n          if (result.success) {\n            alert(result.message);\n            setTimeout(() => window.refreshDatabaseStats(), 1000);\n          } else {\n            alert(result.error || 'Failed to create backup');\n          }\n        } catch (error) {\n          alert('Error creating backup');\n        } finally {\n          btn.disabled = false;\n          btn.innerHTML = 'Create Backup';\n        }\n      };\n\n      window.truncateDatabase = async function() {\n        // Show dangerous operation warning\n        const confirmText = prompt(\n          'WARNING: This will delete ALL data except your admin account!\\\\n\\\\n' +\n          'This action CANNOT be undone!\\\\n\\\\n' +\n          'Type \"TRUNCATE ALL DATA\" to confirm:'\n        );\n        \n        if (confirmText !== 'TRUNCATE ALL DATA') {\n          alert('Operation cancelled. Confirmation text did not match.');\n          return;\n        }\n        \n        const btn = document.getElementById('truncate-db-btn');\n        if (!btn) return;\n        \n        btn.disabled = true;\n        btn.innerHTML = 'Truncating...';\n        \n        try {\n          const response = await fetch('/admin/settings/api/database-tools/truncate', {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({\n              confirmText: confirmText\n            })\n          });\n          const result = await response.json();\n          \n          if (result.success) {\n            alert(result.message + '\\\\n\\\\nTables cleared: ' + result.data.tablesCleared.join(', '));\n            setTimeout(() => {\n              window.refreshDatabaseStats();\n              // Optionally reload page to refresh all data\n              window.location.reload();\n            }, 2000);\n          } else {\n            alert(result.error || 'Failed to truncate database');\n          }\n        } catch (error) {\n          alert('Error truncating database');\n        } finally {\n          btn.disabled = false;\n          btn.innerHTML = 'Truncate All Data';\n        }\n      };\n\n      window.validateDatabase = async function() {\n        try {\n          const response = await fetch('/admin/settings/api/database-tools/validate');\n          const result = await response.json();\n          \n          if (result.success) {\n            if (result.data.valid) {\n              alert('Database validation passed. No issues found.');\n            } else {\n              alert('Database validation failed:\\\\n\\\\n' + result.data.issues.join('\\\\n'));\n            }\n          } else {\n            alert('Failed to validate database');\n          }\n        } catch (error) {\n          alert('Error validating database');\n        }\n      };\n\n      window.updateDatabaseToolsUI = function(data) {\n        const totalTablesEl = document.getElementById('total-tables');\n        const totalRowsEl = document.getElementById('total-rows');\n        const tablesListEl = document.getElementById('tables-list');\n\n        if (totalTablesEl) totalTablesEl.textContent = data.tables.length;\n        if (totalRowsEl) totalRowsEl.textContent = data.totalRows.toLocaleString();\n\n        if (tablesListEl && data.tables && data.tables.length > 0) {\n          tablesListEl.innerHTML = data.tables.map(table => \\`\n            <a\n              href=\"/admin/database-tools/tables/\\${table.name}\"\n              class=\"flex items-center justify-between py-3 px-4 rounded-lg bg-white dark:bg-white/5 hover:bg-zinc-50 dark:hover:bg-white/10 cursor-pointer transition-colors ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 no-underline\"\n            >\n              <div class=\"flex items-center space-x-3\">\n                <svg class=\"w-5 h-5 text-zinc-500 dark:text-zinc-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z\"/>\n                </svg>\n                <span class=\"text-zinc-950 dark:text-white font-medium\">\\${table.name}</span>\n              </div>\n              <div class=\"flex items-center space-x-3\">\n                <span class=\"text-zinc-500 dark:text-zinc-400 text-sm\">\\${table.rowCount.toLocaleString()} rows</span>\n                <svg class=\"w-4 h-4 text-zinc-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 5l7 7-7 7\"/>\n                </svg>\n              </div>\n            </a>\n          \\`).join('');\n        }\n      };\n\n      // Auto-load tab-specific data after all functions are defined\n      if (currentTab === 'migrations') {\n        setTimeout(window.refreshMigrationStatus, 500);\n      }\n\n      if (currentTab === 'database-tools') {\n        setTimeout(window.refreshDatabaseStats, 500);\n      }\n    </script>\n\n    <!-- Confirmation Dialogs -->\n    ${renderConfirmationDialog({\n      id: 'run-migrations-confirm',\n      title: 'Run Migrations',\n      message: 'Are you sure you want to run pending migrations? This action cannot be undone.',\n      confirmText: 'Run Migrations',\n      cancelText: 'Cancel',\n      iconColor: 'blue',\n      confirmClass: 'bg-blue-500 hover:bg-blue-400',\n      onConfirm: 'performRunMigrations()'\n    })}\n\n    ${getConfirmationDialogScript()}\n  `\n\n  const layoutData: AdminLayoutCatalystData = {\n    title: 'Settings',\n    pageTitle: 'Settings',\n    currentPath: '/admin/settings',\n    user: data.user,\n    version: data.version,\n    content: pageContent\n  }\n\n  return renderAdminLayoutCatalyst(layoutData)\n}\n\nfunction renderTabButton(tabId: string, label: string, iconPath: string, activeTab: string): string {\n  const isActive = activeTab === tabId\n  const baseClasses = 'flex items-center space-x-2 px-4 py-3 text-sm font-medium transition-colors border-b-2 whitespace-nowrap no-underline'\n  const activeClasses = isActive\n    ? 'border-zinc-950 dark:border-white text-zinc-950 dark:text-white'\n    : 'border-transparent text-zinc-500 dark:text-zinc-400 hover:text-zinc-700 dark:hover:text-zinc-300 hover:border-zinc-300 dark:hover:border-zinc-700'\n\n  return `\n    <a\n      href=\"/admin/settings/${tabId}\"\n      data-tab=\"${tabId}\"\n      class=\"${baseClasses} ${activeClasses}\"\n    >\n      <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"${iconPath}\"/>\n      </svg>\n      <span>${label}</span>\n    </a>\n  `\n}\n\nfunction renderTabContent(activeTab: string, settings?: SettingsPageData['settings']): string {\n  switch (activeTab) {\n    case 'general':\n      return renderGeneralSettings(settings?.general)\n    case 'appearance':\n      return renderAppearanceSettings(settings?.appearance)\n    case 'security':\n      return renderSecuritySettings(settings?.security)\n    case 'notifications':\n      return renderNotificationSettings(settings?.notifications)\n    case 'storage':\n      return renderStorageSettings(settings?.storage)\n    case 'migrations':\n      return renderMigrationSettings(settings?.migrations)\n    case 'database-tools':\n      return renderDatabaseToolsSettings(settings?.databaseTools)\n    default:\n      return renderGeneralSettings(settings?.general)\n  }\n}\n\nfunction renderGeneralSettings(settings?: GeneralSettings): string {\n  return `\n    <div class=\"space-y-6\">\n      <div>\n        <h3 class=\"text-lg/7 font-semibold text-zinc-950 dark:text-white\">General Settings</h3>\n        <p class=\"mt-1 text-sm/6 text-zinc-500 dark:text-zinc-400\">Configure basic application settings and preferences.</p>\n      </div>\n      \n      <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n        <div class=\"space-y-4\">\n          <div>\n            <label class=\"block text-sm/6 font-medium text-zinc-950 dark:text-white mb-2\">Site Name</label>\n            <input\n              type=\"text\"\n              name=\"siteName\"\n              value=\"${settings?.siteName || 'WarpCMS AI'}\"\n              class=\"w-full rounded-lg bg-white dark:bg-white/5 px-3 py-2 text-sm/6 text-zinc-950 dark:text-white ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-500 dark:placeholder:text-zinc-400 focus:ring-2 focus:ring-inset focus:ring-indigo-500 dark:focus:ring-indigo-400\"\n              placeholder=\"Enter site name\"\n            />\n          </div>\n\n          <div>\n            <label class=\"block text-sm/6 font-medium text-zinc-950 dark:text-white mb-2\">Admin Email</label>\n            <input\n              type=\"email\"\n              name=\"adminEmail\"\n              value=\"${settings?.adminEmail || 'admin@example.com'}\"\n              class=\"w-full rounded-lg bg-white dark:bg-white/5 px-3 py-2 text-sm/6 text-zinc-950 dark:text-white ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-500 dark:placeholder:text-zinc-400 focus:ring-2 focus:ring-inset focus:ring-indigo-500 dark:focus:ring-indigo-400\"\n              placeholder=\"admin@example.com\"\n            />\n          </div>\n\n          <div>\n            <label class=\"block text-sm/6 font-medium text-zinc-950 dark:text-white mb-2\">Timezone</label>\n            <select\n              name=\"timezone\"\n              class=\"w-full rounded-lg bg-white dark:bg-white/5 px-3 py-2 text-sm/6 text-zinc-950 dark:text-white ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 focus:ring-2 focus:ring-inset focus:ring-indigo-500 dark:focus:ring-indigo-400\"\n            >\n              <option value=\"UTC\" ${settings?.timezone === 'UTC' ? 'selected' : ''}>UTC</option>\n              <option value=\"America/New_York\" ${settings?.timezone === 'America/New_York' ? 'selected' : ''}>Eastern Time</option>\n              <option value=\"America/Chicago\" ${settings?.timezone === 'America/Chicago' ? 'selected' : ''}>Central Time</option>\n              <option value=\"America/Denver\" ${settings?.timezone === 'America/Denver' ? 'selected' : ''}>Mountain Time</option>\n              <option value=\"America/Los_Angeles\" ${settings?.timezone === 'America/Los_Angeles' ? 'selected' : ''}>Pacific Time</option>\n            </select>\n          </div>\n        </div>\n\n        <div class=\"space-y-4\">\n          <div>\n            <label class=\"block text-sm/6 font-medium text-zinc-950 dark:text-white mb-2\">Site Description</label>\n            <textarea\n              name=\"siteDescription\"\n              rows=\"3\"\n              class=\"w-full rounded-lg bg-white dark:bg-white/5 px-3 py-2 text-sm/6 text-zinc-950 dark:text-white ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 placeholder:text-zinc-500 dark:placeholder:text-zinc-400 focus:ring-2 focus:ring-inset focus:ring-indigo-500 dark:focus:ring-indigo-400\"\n              placeholder=\"Describe your site...\"\n            >${settings?.siteDescription || ''}</textarea>\n          </div>\n\n          <div>\n            <label class=\"block text-sm/6 font-medium text-zinc-950 dark:text-white mb-2\">Language</label>\n            <select\n              name=\"language\"\n              class=\"w-full rounded-lg bg-white dark:bg-white/5 px-3 py-2 text-sm/6 text-zinc-950 dark:text-white ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 focus:ring-2 focus:ring-inset focus:ring-indigo-500 dark:focus:ring-indigo-400\"\n            >\n              <option value=\"en\" ${settings?.language === 'en' ? 'selected' : ''}>English</option>\n              <option value=\"es\" ${settings?.language === 'es' ? 'selected' : ''}>Spanish</option>\n              <option value=\"fr\" ${settings?.language === 'fr' ? 'selected' : ''}>French</option>\n              <option value=\"de\" ${settings?.language === 'de' ? 'selected' : ''}>German</option>\n            </select>\n          </div>\n          \n          <div class=\"flex gap-3\">\n            <div class=\"flex h-6 shrink-0 items-center\">\n              <div class=\"group grid size-4 grid-cols-1\">\n                <input\n                  type=\"checkbox\"\n                  id=\"maintenanceMode\"\n                  name=\"maintenanceMode\"\n                  ${settings?.maintenanceMode ? 'checked' : ''}\n                  class=\"col-start-1 row-start-1 appearance-none rounded border border-zinc-950/10 dark:border-white/10 bg-white dark:bg-white/5 checked:border-indigo-500 checked:bg-indigo-500 indeterminate:border-indigo-500 indeterminate:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 disabled:border-zinc-950/5 dark:disabled:border-white/5 disabled:bg-zinc-950/10 dark:disabled:bg-white/10 disabled:checked:bg-zinc-950/10 dark:disabled:checked:bg-white/10 forced-colors:appearance-auto\"\n                />\n                <svg viewBox=\"0 0 14 14\" fill=\"none\" class=\"pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-[:disabled]:stroke-zinc-950/25 dark:group-has-[:disabled]:stroke-white/25\">\n                  <path d=\"M3 8L6 11L11 3.5\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:checked]:opacity-100\" />\n                  <path d=\"M3 7H11\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:indeterminate]:opacity-100\" />\n                </svg>\n              </div>\n            </div>\n            <div class=\"text-sm/6\">\n              <label for=\"maintenanceMode\" class=\"font-medium text-zinc-950 dark:text-white\">\n                Enable maintenance mode\n              </label>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Save Button -->\n      <div class=\"mt-8 pt-6 border-t border-zinc-950/5 dark:border-white/10 flex justify-end\">\n        <button\n          onclick=\"saveGeneralSettings()\"\n          class=\"inline-flex items-center justify-center rounded-lg bg-zinc-950 dark:bg-white px-3.5 py-2.5 text-sm font-semibold text-white dark:text-zinc-950 hover:bg-zinc-800 dark:hover:bg-zinc-100 transition-colors shadow-sm\"\n        >\n          <svg class=\"-ml-0.5 mr-1.5 h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 13l4 4L19 7\"/>\n          </svg>\n          Save Changes\n        </button>\n      </div>\n    </div>\n  `\n}\n\nfunction renderAppearanceSettings(settings?: AppearanceSettings): string {\n  return `\n    <div class=\"space-y-6\">\n      <!-- WIP Notice -->\n      <div class=\"rounded-lg bg-blue-50 dark:bg-blue-950/20 p-6 ring-1 ring-inset ring-blue-600/20 dark:ring-blue-500/30\">\n        <div class=\"flex items-start space-x-3\">\n          <svg class=\"w-6 h-6 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"/>\n          </svg>\n          <div class=\"flex-1\">\n            <h4 class=\"text-base/7 font-semibold text-blue-900 dark:text-blue-300\">Work in Progress</h4>\n            <p class=\"mt-1 text-sm/6 text-blue-700 dark:text-blue-200\">\n              This settings section is currently under development and provided for reference and design feedback only. Changes made here will not be saved.\n            </p>\n          </div>\n        </div>\n      </div>\n\n      <div>\n        <h3 class=\"text-lg font-semibold text-white mb-4\">Appearance Settings</h3>\n        <p class=\"text-gray-300 mb-6\">Customize the look and feel of your application.</p>\n      </div>\n      \n      <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n        <div class=\"space-y-4\">\n          <div>\n            <label class=\"block text-sm font-medium text-gray-300 mb-2\">Theme</label>\n            <div class=\"grid grid-cols-3 gap-3\">\n              <label class=\"flex items-center space-x-2 p-3 bg-white/10 rounded-lg border border-white/20 cursor-pointer hover:bg-white/20 transition-colors\">\n                <input \n                  type=\"radio\" \n                  name=\"theme\" \n                  value=\"light\"\n                  ${settings?.theme === 'light' ? 'checked' : ''}\n                  class=\"text-blue-600\"\n                />\n                <span class=\"text-sm text-gray-300\">Light</span>\n              </label>\n              <label class=\"flex items-center space-x-2 p-3 bg-white/10 rounded-lg border border-white/20 cursor-pointer hover:bg-white/20 transition-colors\">\n                <input \n                  type=\"radio\" \n                  name=\"theme\" \n                  value=\"dark\"\n                  ${settings?.theme === 'dark' || !settings?.theme ? 'checked' : ''}\n                  class=\"text-blue-600\"\n                />\n                <span class=\"text-sm text-gray-300\">Dark</span>\n              </label>\n              <label class=\"flex items-center space-x-2 p-3 bg-white/10 rounded-lg border border-white/20 cursor-pointer hover:bg-white/20 transition-colors\">\n                <input \n                  type=\"radio\" \n                  name=\"theme\" \n                  value=\"auto\"\n                  ${settings?.theme === 'auto' ? 'checked' : ''}\n                  class=\"text-blue-600\"\n                />\n                <span class=\"text-sm text-gray-300\">Auto</span>\n              </label>\n            </div>\n          </div>\n          \n          <div>\n            <label class=\"block text-sm font-medium text-gray-300 mb-2\">Primary Color</label>\n            <div class=\"flex items-center space-x-3\">\n              <input \n                type=\"color\" \n                name=\"primaryColor\"\n                value=\"${settings?.primaryColor || '#465FFF'}\"\n                class=\"w-12 h-10 bg-white/10 border border-white/20 rounded-lg cursor-pointer\"\n              />\n              <input \n                type=\"text\" \n                value=\"${settings?.primaryColor || '#465FFF'}\"\n                class=\"flex-1 px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                placeholder=\"#465FFF\"\n              />\n            </div>\n          </div>\n          \n          <div>\n            <label class=\"block text-sm font-medium text-gray-300 mb-2\">Logo URL</label>\n            <input \n              type=\"url\" \n              name=\"logoUrl\"\n              value=\"${settings?.logoUrl || ''}\"\n              class=\"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              placeholder=\"https://example.com/logo.png\"\n            />\n          </div>\n        </div>\n        \n        <div class=\"space-y-4\">\n          <div>\n            <label class=\"block text-sm font-medium text-gray-300 mb-2\">Favicon URL</label>\n            <input \n              type=\"url\" \n              name=\"favicon\"\n              value=\"${settings?.favicon || ''}\"\n              class=\"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              placeholder=\"https://example.com/favicon.ico\"\n            />\n          </div>\n          \n          <div>\n            <label class=\"block text-sm font-medium text-gray-300 mb-2\">Custom CSS</label>\n            <textarea \n              name=\"customCSS\"\n              rows=\"6\"\n              class=\"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-sm\"\n              placeholder=\"/* Add your custom CSS here */\"\n            >${settings?.customCSS || ''}</textarea>\n          </div>\n        </div>\n      </div>\n\n      <!-- Save Button (Disabled for WIP) -->\n      <div class=\"mt-8 pt-6 border-t border-zinc-950/5 dark:border-white/10 flex justify-end\">\n        <button\n          disabled\n          class=\"inline-flex items-center justify-center rounded-lg bg-zinc-950/50 dark:bg-white/50 px-3.5 py-2.5 text-sm font-semibold text-white/50 dark:text-zinc-950/50 cursor-not-allowed shadow-sm\"\n        >\n          <svg class=\"-ml-0.5 mr-1.5 h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 13l4 4L19 7\"/>\n          </svg>\n          Save Changes\n        </button>\n      </div>\n    </div>\n  `\n}\n\nfunction renderSecuritySettings(settings?: SecuritySettings): string {\n  return `\n    <div class=\"space-y-6\">\n      <!-- WIP Notice -->\n      <div class=\"rounded-lg bg-blue-50 dark:bg-blue-950/20 p-6 ring-1 ring-inset ring-blue-600/20 dark:ring-blue-500/30\">\n        <div class=\"flex items-start space-x-3\">\n          <svg class=\"w-6 h-6 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"/>\n          </svg>\n          <div class=\"flex-1\">\n            <h4 class=\"text-base/7 font-semibold text-blue-900 dark:text-blue-300\">Work in Progress</h4>\n            <p class=\"mt-1 text-sm/6 text-blue-700 dark:text-blue-200\">\n              This settings section is currently under development and provided for reference and design feedback only. Changes made here will not be saved.\n            </p>\n          </div>\n        </div>\n      </div>\n\n      <div>\n        <h3 class=\"text-lg font-semibold text-white mb-4\">Security Settings</h3>\n        <p class=\"text-gray-300 mb-6\">Configure security and authentication settings.</p>\n      </div>\n      \n      <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n        <div class=\"space-y-5\">\n          <div class=\"flex gap-3\">\n            <div class=\"flex h-6 shrink-0 items-center\">\n              <div class=\"group grid size-4 grid-cols-1\">\n                <input\n                  type=\"checkbox\"\n                  id=\"twoFactorEnabled\"\n                  name=\"twoFactorEnabled\"\n                  ${settings?.twoFactorEnabled ? 'checked' : ''}\n                  class=\"col-start-1 row-start-1 appearance-none rounded border border-zinc-950/10 dark:border-white/10 bg-white dark:bg-white/5 checked:border-indigo-500 checked:bg-indigo-500 indeterminate:border-indigo-500 indeterminate:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 disabled:border-zinc-950/5 dark:disabled:border-white/5 disabled:bg-zinc-950/10 dark:disabled:bg-white/10 disabled:checked:bg-zinc-950/10 dark:disabled:checked:bg-white/10 forced-colors:appearance-auto\"\n                />\n                <svg viewBox=\"0 0 14 14\" fill=\"none\" class=\"pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-[:disabled]:stroke-zinc-950/25 dark:group-has-[:disabled]:stroke-white/25\">\n                  <path d=\"M3 8L6 11L11 3.5\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:checked]:opacity-100\" />\n                  <path d=\"M3 7H11\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:indeterminate]:opacity-100\" />\n                </svg>\n              </div>\n            </div>\n            <div class=\"text-sm/6\">\n              <label for=\"twoFactorEnabled\" class=\"font-medium text-zinc-950 dark:text-white\">\n                Enable Two-Factor Authentication\n              </label>\n            </div>\n          </div>\n          \n          <div>\n            <label class=\"block text-sm font-medium text-gray-300 mb-2\">Session Timeout (minutes)</label>\n            <input \n              type=\"number\" \n              name=\"sessionTimeout\"\n              value=\"${settings?.sessionTimeout || 30}\"\n              min=\"5\"\n              max=\"1440\"\n              class=\"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            />\n          </div>\n          \n          <div>\n            <label class=\"block text-sm font-medium text-gray-300 mb-2\">Password Requirements</label>\n            <div class=\"space-y-3\">\n              <div class=\"flex gap-3\">\n                <div class=\"flex h-6 shrink-0 items-center\">\n                  <div class=\"group grid size-4 grid-cols-1\">\n                    <input\n                      type=\"checkbox\"\n                      id=\"requireUppercase\"\n                      name=\"requireUppercase\"\n                      ${settings?.passwordRequirements?.requireUppercase ? 'checked' : ''}\n                      class=\"col-start-1 row-start-1 appearance-none rounded border border-zinc-950/10 dark:border-white/10 bg-white dark:bg-white/5 checked:border-indigo-500 checked:bg-indigo-500 indeterminate:border-indigo-500 indeterminate:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 disabled:border-zinc-950/5 dark:disabled:border-white/5 disabled:bg-zinc-950/10 dark:disabled:bg-white/10 disabled:checked:bg-zinc-950/10 dark:disabled:checked:bg-white/10 forced-colors:appearance-auto\"\n                    />\n                    <svg viewBox=\"0 0 14 14\" fill=\"none\" class=\"pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-[:disabled]:stroke-zinc-950/25 dark:group-has-[:disabled]:stroke-white/25\">\n                      <path d=\"M3 8L6 11L11 3.5\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:checked]:opacity-100\" />\n                      <path d=\"M3 7H11\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:indeterminate]:opacity-100\" />\n                    </svg>\n                  </div>\n                </div>\n                <div class=\"text-sm/6\">\n                  <label for=\"requireUppercase\" class=\"font-medium text-zinc-950 dark:text-white\">Require uppercase letters</label>\n                </div>\n              </div>\n              <div class=\"flex gap-3\">\n                <div class=\"flex h-6 shrink-0 items-center\">\n                  <div class=\"group grid size-4 grid-cols-1\">\n                    <input\n                      type=\"checkbox\"\n                      id=\"requireNumbers\"\n                      name=\"requireNumbers\"\n                      ${settings?.passwordRequirements?.requireNumbers ? 'checked' : ''}\n                      class=\"col-start-1 row-start-1 appearance-none rounded border border-zinc-950/10 dark:border-white/10 bg-white dark:bg-white/5 checked:border-indigo-500 checked:bg-indigo-500 indeterminate:border-indigo-500 indeterminate:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 disabled:border-zinc-950/5 dark:disabled:border-white/5 disabled:bg-zinc-950/10 dark:disabled:bg-white/10 disabled:checked:bg-zinc-950/10 dark:disabled:checked:bg-white/10 forced-colors:appearance-auto\"\n                    />\n                    <svg viewBox=\"0 0 14 14\" fill=\"none\" class=\"pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-[:disabled]:stroke-zinc-950/25 dark:group-has-[:disabled]:stroke-white/25\">\n                      <path d=\"M3 8L6 11L11 3.5\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:checked]:opacity-100\" />\n                      <path d=\"M3 7H11\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:indeterminate]:opacity-100\" />\n                    </svg>\n                  </div>\n                </div>\n                <div class=\"text-sm/6\">\n                  <label for=\"requireNumbers\" class=\"font-medium text-zinc-950 dark:text-white\">Require numbers</label>\n                </div>\n              </div>\n              <div class=\"flex gap-3\">\n                <div class=\"flex h-6 shrink-0 items-center\">\n                  <div class=\"group grid size-4 grid-cols-1\">\n                    <input\n                      type=\"checkbox\"\n                      id=\"requireSymbols\"\n                      name=\"requireSymbols\"\n                      ${settings?.passwordRequirements?.requireSymbols ? 'checked' : ''}\n                      class=\"col-start-1 row-start-1 appearance-none rounded border border-zinc-950/10 dark:border-white/10 bg-white dark:bg-white/5 checked:border-indigo-500 checked:bg-indigo-500 indeterminate:border-indigo-500 indeterminate:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 disabled:border-zinc-950/5 dark:disabled:border-white/5 disabled:bg-zinc-950/10 dark:disabled:bg-white/10 disabled:checked:bg-zinc-950/10 dark:disabled:checked:bg-white/10 forced-colors:appearance-auto\"\n                    />\n                    <svg viewBox=\"0 0 14 14\" fill=\"none\" class=\"pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-[:disabled]:stroke-zinc-950/25 dark:group-has-[:disabled]:stroke-white/25\">\n                      <path d=\"M3 8L6 11L11 3.5\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:checked]:opacity-100\" />\n                      <path d=\"M3 7H11\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:indeterminate]:opacity-100\" />\n                    </svg>\n                  </div>\n                </div>\n                <div class=\"text-sm/6\">\n                  <label for=\"requireSymbols\" class=\"font-medium text-zinc-950 dark:text-white\">Require symbols</label>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        \n        <div class=\"space-y-4\">\n          <div>\n            <label class=\"block text-sm font-medium text-gray-300 mb-2\">Minimum Password Length</label>\n            <input \n              type=\"number\" \n              name=\"minPasswordLength\"\n              value=\"${settings?.passwordRequirements?.minLength || 8}\"\n              min=\"6\"\n              max=\"128\"\n              class=\"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            />\n          </div>\n          \n          <div>\n            <label class=\"block text-sm font-medium text-gray-300 mb-2\">IP Whitelist</label>\n            <textarea \n              name=\"ipWhitelist\"\n              rows=\"4\"\n              class=\"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              placeholder=\"Enter IP addresses (one per line)&#10;192.168.1.1&#10;10.0.0.1\"\n            >${settings?.ipWhitelist?.join('\\n') || ''}</textarea>\n            <p class=\"text-xs text-gray-400 mt-1\">Leave empty to allow all IPs</p>\n          </div>\n        </div>\n      </div>\n\n      <!-- Save Button (Disabled for WIP) -->\n      <div class=\"mt-8 pt-6 border-t border-zinc-950/5 dark:border-white/10 flex justify-end\">\n        <button\n          disabled\n          class=\"inline-flex items-center justify-center rounded-lg bg-zinc-950/50 dark:bg-white/50 px-3.5 py-2.5 text-sm font-semibold text-white/50 dark:text-zinc-950/50 cursor-not-allowed shadow-sm\"\n        >\n          <svg class=\"-ml-0.5 mr-1.5 h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 13l4 4L19 7\"/>\n          </svg>\n          Save Changes\n        </button>\n      </div>\n    </div>\n  `\n}\n\nfunction renderNotificationSettings(settings?: NotificationSettings): string {\n  return `\n    <div class=\"space-y-6\">\n      <!-- WIP Notice -->\n      <div class=\"rounded-lg bg-blue-50 dark:bg-blue-950/20 p-6 ring-1 ring-inset ring-blue-600/20 dark:ring-blue-500/30\">\n        <div class=\"flex items-start space-x-3\">\n          <svg class=\"w-6 h-6 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"/>\n          </svg>\n          <div class=\"flex-1\">\n            <h4 class=\"text-base/7 font-semibold text-blue-900 dark:text-blue-300\">Work in Progress</h4>\n            <p class=\"mt-1 text-sm/6 text-blue-700 dark:text-blue-200\">\n              This settings section is currently under development and provided for reference and design feedback only. Changes made here will not be saved.\n            </p>\n          </div>\n        </div>\n      </div>\n\n      <div>\n        <h3 class=\"text-lg font-semibold text-white mb-4\">Notification Settings</h3>\n        <p class=\"text-gray-300 mb-6\">Configure how and when you receive notifications.</p>\n      </div>\n      \n      <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n        <div class=\"space-y-4\">\n          <div>\n            <h4 class=\"text-md font-medium text-white mb-3\">Email Notifications</h4>\n            <div class=\"space-y-5\">\n              <div class=\"flex gap-3\">\n                <div class=\"flex h-6 shrink-0 items-center\">\n                  <div class=\"group grid size-4 grid-cols-1\">\n                    <input\n                      type=\"checkbox\"\n                      id=\"emailNotifications\"\n                      name=\"emailNotifications\"\n                      ${settings?.emailNotifications ? 'checked' : ''}\n                      class=\"col-start-1 row-start-1 appearance-none rounded border border-zinc-950/10 dark:border-white/10 bg-white dark:bg-white/5 checked:border-indigo-500 checked:bg-indigo-500 indeterminate:border-indigo-500 indeterminate:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 disabled:border-zinc-950/5 dark:disabled:border-white/5 disabled:bg-zinc-950/10 dark:disabled:bg-white/10 disabled:checked:bg-zinc-950/10 dark:disabled:checked:bg-white/10 forced-colors:appearance-auto\"\n                    />\n                    <svg viewBox=\"0 0 14 14\" fill=\"none\" class=\"pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-[:disabled]:stroke-zinc-950/25 dark:group-has-[:disabled]:stroke-white/25\">\n                      <path d=\"M3 8L6 11L11 3.5\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:checked]:opacity-100\" />\n                      <path d=\"M3 7H11\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:indeterminate]:opacity-100\" />\n                    </svg>\n                  </div>\n                </div>\n                <div class=\"text-sm/6\">\n                  <label for=\"emailNotifications\" class=\"font-medium text-zinc-950 dark:text-white\">Enable email notifications</label>\n                </div>\n              </div>\n\n              <div class=\"flex gap-3\">\n                <div class=\"flex h-6 shrink-0 items-center\">\n                  <div class=\"group grid size-4 grid-cols-1\">\n                    <input\n                      type=\"checkbox\"\n                      id=\"contentUpdates\"\n                      name=\"contentUpdates\"\n                      ${settings?.contentUpdates ? 'checked' : ''}\n                      class=\"col-start-1 row-start-1 appearance-none rounded border border-zinc-950/10 dark:border-white/10 bg-white dark:bg-white/5 checked:border-indigo-500 checked:bg-indigo-500 indeterminate:border-indigo-500 indeterminate:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 disabled:border-zinc-950/5 dark:disabled:border-white/5 disabled:bg-zinc-950/10 dark:disabled:bg-white/10 disabled:checked:bg-zinc-950/10 dark:disabled:checked:bg-white/10 forced-colors:appearance-auto\"\n                    />\n                    <svg viewBox=\"0 0 14 14\" fill=\"none\" class=\"pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-[:disabled]:stroke-zinc-950/25 dark:group-has-[:disabled]:stroke-white/25\">\n                      <path d=\"M3 8L6 11L11 3.5\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:checked]:opacity-100\" />\n                      <path d=\"M3 7H11\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:indeterminate]:opacity-100\" />\n                    </svg>\n                  </div>\n                </div>\n                <div class=\"text-sm/6\">\n                  <label for=\"contentUpdates\" class=\"font-medium text-zinc-950 dark:text-white\">Content updates</label>\n                </div>\n              </div>\n\n              <div class=\"flex gap-3\">\n                <div class=\"flex h-6 shrink-0 items-center\">\n                  <div class=\"group grid size-4 grid-cols-1\">\n                    <input\n                      type=\"checkbox\"\n                      id=\"systemAlerts\"\n                      name=\"systemAlerts\"\n                      ${settings?.systemAlerts ? 'checked' : ''}\n                      class=\"col-start-1 row-start-1 appearance-none rounded border border-zinc-950/10 dark:border-white/10 bg-white dark:bg-white/5 checked:border-indigo-500 checked:bg-indigo-500 indeterminate:border-indigo-500 indeterminate:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 disabled:border-zinc-950/5 dark:disabled:border-white/5 disabled:bg-zinc-950/10 dark:disabled:bg-white/10 disabled:checked:bg-zinc-950/10 dark:disabled:checked:bg-white/10 forced-colors:appearance-auto\"\n                    />\n                    <svg viewBox=\"0 0 14 14\" fill=\"none\" class=\"pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-[:disabled]:stroke-zinc-950/25 dark:group-has-[:disabled]:stroke-white/25\">\n                      <path d=\"M3 8L6 11L11 3.5\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:checked]:opacity-100\" />\n                      <path d=\"M3 7H11\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:indeterminate]:opacity-100\" />\n                    </svg>\n                  </div>\n                </div>\n                <div class=\"text-sm/6\">\n                  <label for=\"systemAlerts\" class=\"font-medium text-zinc-950 dark:text-white\">System alerts</label>\n                </div>\n              </div>\n\n              <div class=\"flex gap-3\">\n                <div class=\"flex h-6 shrink-0 items-center\">\n                  <div class=\"group grid size-4 grid-cols-1\">\n                    <input\n                      type=\"checkbox\"\n                      id=\"userRegistrations\"\n                      name=\"userRegistrations\"\n                      ${settings?.userRegistrations ? 'checked' : ''}\n                      class=\"col-start-1 row-start-1 appearance-none rounded border border-zinc-950/10 dark:border-white/10 bg-white dark:bg-white/5 checked:border-indigo-500 checked:bg-indigo-500 indeterminate:border-indigo-500 indeterminate:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500 disabled:border-zinc-950/5 dark:disabled:border-white/5 disabled:bg-zinc-950/10 dark:disabled:bg-white/10 disabled:checked:bg-zinc-950/10 dark:disabled:checked:bg-white/10 forced-colors:appearance-auto\"\n                    />\n                    <svg viewBox=\"0 0 14 14\" fill=\"none\" class=\"pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-[:disabled]:stroke-zinc-950/25 dark:group-has-[:disabled]:stroke-white/25\">\n                      <path d=\"M3 8L6 11L11 3.5\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:checked]:opacity-100\" />\n                      <path d=\"M3 7H11\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"opacity-0 group-has-[:indeterminate]:opacity-100\" />\n                    </svg>\n                  </div>\n                </div>\n                <div class=\"text-sm/6\">\n                  <label for=\"userRegistrations\" class=\"font-medium text-zinc-950 dark:text-white\">New user registrations</label>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        \n        <div class=\"space-y-4\">\n          <div>\n            <label class=\"block text-sm font-medium text-gray-300 mb-2\">Email Frequency</label>\n            <select \n              name=\"emailFrequency\"\n              class=\"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <option value=\"immediate\" ${settings?.emailFrequency === 'immediate' ? 'selected' : ''}>Immediate</option>\n              <option value=\"daily\" ${settings?.emailFrequency === 'daily' ? 'selected' : ''}>Daily Digest</option>\n              <option value=\"weekly\" ${settings?.emailFrequency === 'weekly' ? 'selected' : ''}>Weekly Digest</option>\n            </select>\n          </div>\n          \n          <div class=\"p-4 bg-blue-500/20 border border-blue-500/30 rounded-lg\">\n            <div class=\"flex items-start space-x-3\">\n              <svg class=\"w-5 h-5 text-blue-400 mt-0.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"/>\n              </svg>\n              <div>\n                <h5 class=\"text-sm font-medium text-blue-300\">Notification Preferences</h5>\n                <p class=\"text-xs text-blue-200 mt-1\">\n                  Critical system alerts will always be sent immediately regardless of your frequency setting.\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Save Button (Disabled for WIP) -->\n      <div class=\"mt-8 pt-6 border-t border-zinc-950/5 dark:border-white/10 flex justify-end\">\n        <button\n          disabled\n          class=\"inline-flex items-center justify-center rounded-lg bg-zinc-950/50 dark:bg-white/50 px-3.5 py-2.5 text-sm font-semibold text-white/50 dark:text-zinc-950/50 cursor-not-allowed shadow-sm\"\n        >\n          <svg class=\"-ml-0.5 mr-1.5 h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 13l4 4L19 7\"/>\n          </svg>\n          Save Changes\n        </button>\n      </div>\n    </div>\n  `\n}\n\nfunction renderStorageSettings(settings?: StorageSettings): string {\n  return `\n    <div class=\"space-y-6\">\n      <!-- WIP Notice -->\n      <div class=\"rounded-lg bg-blue-50 dark:bg-blue-950/20 p-6 ring-1 ring-inset ring-blue-600/20 dark:ring-blue-500/30\">\n        <div class=\"flex items-start space-x-3\">\n          <svg class=\"w-6 h-6 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"/>\n          </svg>\n          <div class=\"flex-1\">\n            <h4 class=\"text-base/7 font-semibold text-blue-900 dark:text-blue-300\">Work in Progress</h4>\n            <p class=\"mt-1 text-sm/6 text-blue-700 dark:text-blue-200\">\n              This settings section is currently under development and provided for reference and design feedback only. Changes made here will not be saved.\n            </p>\n          </div>\n        </div>\n      </div>\n\n      <div>\n        <h3 class=\"text-lg font-semibold text-white mb-4\">Storage Settings</h3>\n        <p class=\"text-gray-300 mb-6\">Configure file storage and backup settings.</p>\n      </div>\n      \n      <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n        <div class=\"space-y-4\">\n          <div>\n            <label class=\"block text-sm font-medium text-gray-300 mb-2\">Max File Size (MB)</label>\n            <input \n              type=\"number\" \n              name=\"maxFileSize\"\n              value=\"${settings?.maxFileSize || 10}\"\n              min=\"1\"\n              max=\"100\"\n              class=\"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            />\n          </div>\n          \n          <div>\n            <label class=\"block text-sm font-medium text-gray-300 mb-2\">Storage Provider</label>\n            <select \n              name=\"storageProvider\"\n              class=\"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <option value=\"local\" ${settings?.storageProvider === 'local' ? 'selected' : ''}>Local Storage</option>\n              <option value=\"cloudflare\" ${settings?.storageProvider === 'cloudflare' ? 'selected' : ''}>Cloudflare R2</option>\n              <option value=\"s3\" ${settings?.storageProvider === 's3' ? 'selected' : ''}>Amazon S3</option>\n            </select>\n          </div>\n          \n          <div>\n            <label class=\"block text-sm font-medium text-gray-300 mb-2\">Backup Frequency</label>\n            <select \n              name=\"backupFrequency\"\n              class=\"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <option value=\"daily\" ${settings?.backupFrequency === 'daily' ? 'selected' : ''}>Daily</option>\n              <option value=\"weekly\" ${settings?.backupFrequency === 'weekly' ? 'selected' : ''}>Weekly</option>\n              <option value=\"monthly\" ${settings?.backupFrequency === 'monthly' ? 'selected' : ''}>Monthly</option>\n            </select>\n          </div>\n        </div>\n        \n        <div class=\"space-y-4\">\n          <div>\n            <label class=\"block text-sm font-medium text-gray-300 mb-2\">Allowed File Types</label>\n            <textarea \n              name=\"allowedFileTypes\"\n              rows=\"3\"\n              class=\"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              placeholder=\"jpg, jpeg, png, gif, pdf, docx\"\n            >${settings?.allowedFileTypes?.join(', ') || 'jpg, jpeg, png, gif, pdf, docx'}</textarea>\n          </div>\n          \n          <div>\n            <label class=\"block text-sm font-medium text-gray-300 mb-2\">Backup Retention (days)</label>\n            <input \n              type=\"number\" \n              name=\"retentionPeriod\"\n              value=\"${settings?.retentionPeriod || 30}\"\n              min=\"7\"\n              max=\"365\"\n              class=\"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            />\n          </div>\n          \n          <div class=\"p-4 bg-green-500/20 border border-green-500/30 rounded-lg\">\n            <div class=\"flex items-start space-x-3\">\n              <svg class=\"w-5 h-5 text-green-400 mt-0.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"/>\n              </svg>\n              <div>\n                <h5 class=\"text-sm font-medium text-green-300\">Storage Status</h5>\n                <p class=\"text-xs text-green-200 mt-1\">\n                  Current usage: 2.4 GB / 10 GB available\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Save Button (Disabled for WIP) -->\n      <div class=\"mt-8 pt-6 border-t border-zinc-950/5 dark:border-white/10 flex justify-end\">\n        <button\n          disabled\n          class=\"inline-flex items-center justify-center rounded-lg bg-zinc-950/50 dark:bg-white/50 px-3.5 py-2.5 text-sm font-semibold text-white/50 dark:text-zinc-950/50 cursor-not-allowed shadow-sm\"\n        >\n          <svg class=\"-ml-0.5 mr-1.5 h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 13l4 4L19 7\"/>\n          </svg>\n          Save Changes\n        </button>\n      </div>\n    </div>\n  `\n}\n\nfunction renderMigrationSettings(settings?: MigrationSettings): string {\n  return `\n    <div class=\"space-y-6\">\n      <div>\n        <h3 class=\"text-lg font-semibold text-white mb-4\">Database Migrations</h3>\n        <p class=\"text-gray-300 mb-6\">View and manage database migrations to keep your schema up to date.</p>\n      </div>\n      \n      <!-- Migration Status Overview -->\n      <div class=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\">\n        <div class=\"backdrop-blur-md bg-blue-500/20 rounded-lg border border-blue-500/30 p-4\">\n          <div class=\"flex items-center justify-between\">\n            <div>\n              <p class=\"text-sm text-blue-300\">Total Migrations</p>\n              <p id=\"total-migrations\" class=\"text-2xl font-bold text-white\">${settings?.totalMigrations || '0'}</p>\n            </div>\n            <svg class=\"w-8 h-8 text-blue-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4\"/>\n            </svg>\n          </div>\n        </div>\n        \n        <div class=\"backdrop-blur-md bg-green-500/20 rounded-lg border border-green-500/30 p-4\">\n          <div class=\"flex items-center justify-between\">\n            <div>\n              <p class=\"text-sm text-green-300\">Applied</p>\n              <p id=\"applied-migrations\" class=\"text-2xl font-bold text-white\">${settings?.appliedMigrations || '0'}</p>\n            </div>\n            <svg class=\"w-8 h-8 text-green-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"/>\n            </svg>\n          </div>\n        </div>\n        \n        <div class=\"backdrop-blur-md bg-orange-500/20 rounded-lg border border-orange-500/30 p-4\">\n          <div class=\"flex items-center justify-between\">\n            <div>\n              <p class=\"text-sm text-orange-300\">Pending</p>\n              <p id=\"pending-migrations\" class=\"text-2xl font-bold text-white\">${settings?.pendingMigrations || '0'}</p>\n            </div>\n            <svg class=\"w-8 h-8 text-orange-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"/>\n            </svg>\n          </div>\n        </div>\n      </div>\n\n      <!-- Migration Actions -->\n      <div class=\"flex items-center space-x-4 mb-6\">\n        <button \n          onclick=\"window.refreshMigrationStatus()\"\n          class=\"inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-colors\"\n        >\n          <svg class=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"/>\n          </svg>\n          Refresh Status\n        </button>\n        \n        <button \n          onclick=\"window.runPendingMigrations()\"\n          id=\"run-migrations-btn\"\n          class=\"inline-flex items-center px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-lg transition-colors\"\n          ${(settings?.pendingMigrations || 0) === 0 ? 'disabled' : ''}\n        >\n          <svg class=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M14.828 14.828a4 4 0 01-5.656 0M9 10h1.586a1 1 0 01.707.293l2.414 2.414a1 1 0 00.707.293H15M9 10v4.586a1 1 0 00.293.707l2.414 2.414a1 1 0 00.707.293H15M9 10V9a2 2 0 012-2h2a2 2 0 012 2v1\"/>\n          </svg>\n          Run Pending\n        </button>\n\n        <button \n          onclick=\"window.validateSchema()\" \n          class=\"inline-flex items-center px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white text-sm font-medium rounded-lg transition-colors\"\n        >\n          <svg class=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"/>\n          </svg>\n          Validate Schema\n        </button>\n      </div>\n\n      <!-- Migrations List -->\n      <div class=\"backdrop-blur-md bg-white/10 rounded-lg border border-white/20 overflow-hidden\">\n        <div class=\"px-6 py-4 border-b border-white/10\">\n          <h4 class=\"text-lg font-medium text-white\">Migration History</h4>\n          <p class=\"text-sm text-gray-300 mt-1\">List of all available database migrations</p>\n        </div>\n        \n        <div id=\"migrations-list\" class=\"divide-y divide-white/10\">\n          <div class=\"px-6 py-8 text-center\">\n            <svg class=\"w-12 h-12 text-gray-400 mx-auto mb-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4\"/>\n            </svg>\n            <p class=\"text-gray-300\">Loading migration status...</p>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <script>\n      // Load migration status when tab becomes active\n      if (typeof refreshMigrationStatus === 'undefined') {\n        window.refreshMigrationStatus = async function() {\n          try {\n            const response = await fetch('/admin/settings/api/migrations/status');\n            const result = await response.json();\n            \n            if (result.success) {\n              updateMigrationUI(result.data);\n            } else {\n              console.error('Failed to refresh migration status');\n            }\n          } catch (error) {\n            console.error('Error loading migration status:', error);\n          }\n        };\n\n        window.runPendingMigrations = async function() {\n          const btn = document.getElementById('run-migrations-btn');\n          if (!btn || btn.disabled) return;\n\n          showConfirmDialog('run-migrations-confirm');\n        };\n\n        window.performRunMigrations = async function() {\n          const btn = document.getElementById('run-migrations-btn');\n          if (!btn) return;\n\n          btn.disabled = true;\n          btn.innerHTML = 'Running...';\n\n          try {\n            const response = await fetch('/admin/settings/api/migrations/run', {\n              method: 'POST'\n            });\n            const result = await response.json();\n\n            if (result.success) {\n              alert(result.message);\n              setTimeout(() => window.refreshMigrationStatus(), 1000);\n            } else {\n              alert(result.error || 'Failed to run migrations');\n            }\n          } catch (error) {\n            alert('Error running migrations');\n          } finally {\n            btn.disabled = false;\n            btn.innerHTML = 'Run Pending';\n          }\n        };\n\n        window.validateSchema = async function() {\n          try {\n            const response = await fetch('/admin/settings/api/migrations/validate');\n            const result = await response.json();\n            \n            if (result.success) {\n              if (result.data.valid) {\n                alert('Database schema is valid');\n              } else {\n                alert(\\`Schema validation failed: \\${result.data.issues.join(', ')}\\`);\n              }\n            } else {\n              alert('Failed to validate schema');\n            }\n          } catch (error) {\n            alert('Error validating schema');\n          }\n        };\n\n        window.updateMigrationUI = function(data) {\n          const totalEl = document.getElementById('total-migrations');\n          const appliedEl = document.getElementById('applied-migrations');\n          const pendingEl = document.getElementById('pending-migrations');\n          \n          if (totalEl) totalEl.textContent = data.totalMigrations;\n          if (appliedEl) appliedEl.textContent = data.appliedMigrations;\n          if (pendingEl) pendingEl.textContent = data.pendingMigrations;\n          \n          const runBtn = document.getElementById('run-migrations-btn');\n          if (runBtn) {\n            runBtn.disabled = data.pendingMigrations === 0;\n          }\n          \n          // Update migrations list\n          const listContainer = document.getElementById('migrations-list');\n          if (listContainer && data.migrations && data.migrations.length > 0) {\n            listContainer.innerHTML = data.migrations.map(migration => \\`\n              <div class=\"px-6 py-4 flex items-center justify-between\">\n                <div class=\"flex-1\">\n                  <div class=\"flex items-center space-x-3\">\n                    <div class=\"flex-shrink-0\">\n                      \\${migration.applied \n                        ? '<svg class=\"w-5 h-5 text-green-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"/></svg>'\n                        : '<svg class=\"w-5 h-5 text-orange-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"/></svg>'\n                      }\n                    </div>\n                    <div>\n                      <h5 class=\"text-white font-medium\">\\${migration.name}</h5>\n                      <p class=\"text-sm text-gray-300\">\\${migration.filename}</p>\n                      \\${migration.description ? \\`<p class=\"text-xs text-gray-400 mt-1\">\\${migration.description}</p>\\` : ''}\n                    </div>\n                  </div>\n                </div>\n                \n                <div class=\"flex items-center space-x-4 text-sm\">\n                  \\${migration.size ? \\`<span class=\"text-gray-400\">\\${(migration.size / 1024).toFixed(1)} KB</span>\\` : ''}\n                  <span class=\"px-2 py-1 rounded-full text-xs font-medium \\${\n                    migration.applied \n                      ? 'bg-green-100 text-green-800' \n                      : 'bg-orange-100 text-orange-800'\n                  }\">\n                    \\${migration.applied ? 'Applied' : 'Pending'}\n                  </span>\n                  \\${migration.appliedAt ? \\`<span class=\"text-gray-400\">\\${new Date(migration.appliedAt).toLocaleDateString()}</span>\\` : ''}\n                </div>\n              </div>\n            \\`).join('');\n          }\n        };\n      }\n      \n      // Auto-load when tab becomes active\n      if (currentTab === 'migrations') {\n        setTimeout(refreshMigrationStatus, 500);\n      }\n    </script>\n  `\n}\n\nfunction renderDatabaseToolsSettings(settings?: DatabaseToolsSettings): string {\n  return `\n    <div class=\"space-y-6\">\n      <div>\n        <h3 class=\"text-lg/7 font-semibold text-zinc-950 dark:text-white\">Database Tools</h3>\n        <p class=\"mt-1 text-sm/6 text-zinc-500 dark:text-zinc-400\">Manage database operations including backup, restore, and maintenance.</p>\n      </div>\n\n      <!-- Database Statistics -->\n      <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6\">\n        <div class=\"rounded-lg bg-white dark:bg-white/5 p-6 ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10\">\n          <div class=\"flex items-center justify-between\">\n            <div>\n              <p class=\"text-sm/6 font-medium text-zinc-500 dark:text-zinc-400\">Total Tables</p>\n              <p id=\"total-tables\" class=\"mt-2 text-3xl/8 font-semibold text-zinc-950 dark:text-white\">${settings?.totalTables || '0'}</p>\n            </div>\n            <div class=\"rounded-lg bg-indigo-500/10 p-3\">\n              <svg class=\"w-8 h-8 text-indigo-600 dark:text-indigo-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10\"/>\n              </svg>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"rounded-lg bg-white dark:bg-white/5 p-6 ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10\">\n          <div class=\"flex items-center justify-between\">\n            <div>\n              <p class=\"text-sm/6 font-medium text-zinc-500 dark:text-zinc-400\">Total Rows</p>\n              <p id=\"total-rows\" class=\"mt-2 text-3xl/8 font-semibold text-zinc-950 dark:text-white\">${settings?.totalRows?.toLocaleString() || '0'}</p>\n            </div>\n            <div class=\"rounded-lg bg-green-500/10 p-3\">\n              <svg class=\"w-8 h-8 text-green-600 dark:text-green-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01\"/>\n              </svg>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Database Operations -->\n      <div class=\"space-y-4\">\n        <!-- Safe Operations -->\n        <div class=\"rounded-lg bg-white dark:bg-white/5 p-6 ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10\">\n          <h4 class=\"text-base/7 font-semibold text-zinc-950 dark:text-white mb-4\">Safe Operations</h4>\n          <div class=\"flex flex-wrap gap-3\">\n            <button\n              onclick=\"window.refreshDatabaseStats()\"\n              class=\"inline-flex items-center justify-center rounded-lg bg-white dark:bg-zinc-800 px-3.5 py-2.5 text-sm font-semibold text-zinc-950 dark:text-white ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 hover:bg-zinc-50 dark:hover:bg-zinc-700 transition-colors shadow-sm\"\n            >\n              <svg class=\"-ml-0.5 mr-1.5 h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"/>\n              </svg>\n              Refresh Stats\n            </button>\n\n            <button\n              onclick=\"window.createDatabaseBackup()\"\n              id=\"create-backup-btn\"\n              class=\"inline-flex items-center justify-center rounded-lg bg-indigo-600 dark:bg-indigo-500 px-3.5 py-2.5 text-sm font-semibold text-white hover:bg-indigo-500 dark:hover:bg-indigo-400 transition-colors shadow-sm\"\n            >\n              <svg class=\"-ml-0.5 mr-1.5 h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"/>\n              </svg>\n              Create Backup\n            </button>\n\n            <button\n              onclick=\"window.validateDatabase()\"\n              class=\"inline-flex items-center justify-center rounded-lg bg-green-600 dark:bg-green-500 px-3.5 py-2.5 text-sm font-semibold text-white hover:bg-green-500 dark:hover:bg-green-400 transition-colors shadow-sm\"\n            >\n              <svg class=\"-ml-0.5 mr-1.5 h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"/>\n              </svg>\n              Validate Database\n            </button>\n          </div>\n        </div>\n      </div>\n\n      <!-- Tables List -->\n      <div class=\"rounded-lg bg-white dark:bg-white/5 ring-1 ring-inset ring-zinc-950/10 dark:ring-white/10 overflow-hidden\">\n        <div class=\"px-6 py-4 border-b border-zinc-950/10 dark:border-white/10\">\n          <h4 class=\"text-base/7 font-semibold text-zinc-950 dark:text-white\">Database Tables</h4>\n          <p class=\"mt-1 text-sm/6 text-zinc-500 dark:text-zinc-400\">Click on a table to view its data</p>\n        </div>\n\n        <div id=\"tables-list\" class=\"p-6 space-y-2\">\n          <div class=\"text-center py-8\">\n            <svg class=\"w-12 h-12 text-zinc-400 dark:text-zinc-500 mx-auto mb-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10\"/>\n            </svg>\n            <p class=\"text-zinc-500 dark:text-zinc-400\">Loading database statistics...</p>\n          </div>\n        </div>\n      </div>\n\n      <!-- Danger Zone -->\n      <div class=\"rounded-lg bg-red-50 dark:bg-red-950/20 p-6 ring-1 ring-inset ring-red-600/20 dark:ring-red-500/30\">\n        <div class=\"flex items-start space-x-3\">\n          <svg class=\"w-6 h-6 text-red-600 dark:text-red-500 mt-0.5 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z\"/>\n          </svg>\n          <div class=\"flex-1\">\n            <h4 class=\"text-base/7 font-semibold text-red-900 dark:text-red-400\">Danger Zone</h4>\n            <p class=\"mt-1 text-sm/6 text-red-700 dark:text-red-300\">\n              These operations are destructive and cannot be undone.\n              <strong>Your admin account will be preserved</strong>, but all other data will be permanently deleted.\n            </p>\n            <div class=\"mt-4\">\n              <button\n                onclick=\"window.truncateDatabase()\"\n                id=\"truncate-db-btn\"\n                class=\"inline-flex items-center justify-center rounded-lg bg-red-600 dark:bg-red-500 px-3.5 py-2.5 text-sm font-semibold text-white hover:bg-red-500 dark:hover:bg-red-400 transition-colors shadow-sm\"\n              >\n                <svg class=\"-ml-0.5 mr-1.5 h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"/>\n                </svg>\n                Truncate All Data\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  `\n}","import { Hono } from 'hono'\n// import { html } from 'hono/html'\nimport { requireAuth } from '../middleware'\nimport { renderSettingsPage, SettingsPageData } from '../templates/pages/admin-settings.template'\nimport { MigrationService } from '../services/migrations'\nimport { SettingsService } from '../services/settings'\n\ntype Bindings = {\n  DB: D1Database\n  CACHE_KV: KVNamespace\n  MEDIA_BUCKET: R2Bucket\n  ASSETS: Fetcher\n  EMAIL_QUEUE?: Queue\n  SENDGRID_API_KEY?: string\n  DEFAULT_FROM_EMAIL?: string\n  IMAGES_ACCOUNT_ID?: string\n  IMAGES_API_TOKEN?: string\n  ENVIRONMENT?: string\n}\n\ntype Variables = {\n  user?: {\n    userId: string\n    email: string\n    role: string\n    exp: number\n    iat: number\n  }\n  requestId?: string\n  startTime?: number\n  appVersion?: string\n}\n\nexport const adminSettingsRoutes = new Hono<{ Bindings: Bindings; Variables: Variables }>()\n\n// Apply authentication middleware\nadminSettingsRoutes.use('*', requireAuth())\n\n// Helper function to get mock settings data\nfunction getMockSettings(user: any) {\n  return {\n    general: {\n      siteName: 'WarpCMS AI',\n      siteDescription: 'A modern headless CMS powered by AI',\n      adminEmail: user?.email || 'admin@example.com',\n      timezone: 'UTC',\n      language: 'en',\n      maintenanceMode: false\n    },\n    appearance: {\n      theme: 'dark' as const,\n      primaryColor: '#465FFF',\n      logoUrl: '',\n      favicon: '',\n      customCSS: ''\n    },\n    security: {\n      twoFactorEnabled: false,\n      sessionTimeout: 30,\n      passwordRequirements: {\n        minLength: 8,\n        requireUppercase: true,\n        requireNumbers: true,\n        requireSymbols: false\n      },\n      ipWhitelist: []\n    },\n    notifications: {\n      emailNotifications: true,\n      contentUpdates: true,\n      systemAlerts: true,\n      userRegistrations: false,\n      emailFrequency: 'immediate' as const\n    },\n    storage: {\n      maxFileSize: 10,\n      allowedFileTypes: ['jpg', 'jpeg', 'png', 'gif', 'pdf', 'docx'],\n      storageProvider: 'cloudflare' as const,\n      backupFrequency: 'daily' as const,\n      retentionPeriod: 30\n    },\n    migrations: {\n      totalMigrations: 0,\n      appliedMigrations: 0,\n      pendingMigrations: 0,\n      lastApplied: undefined,\n      migrations: []\n    },\n    databaseTools: {\n      totalTables: 0,\n      totalRows: 0,\n      lastBackup: undefined,\n      databaseSize: '0 MB',\n      tables: []\n    }\n  }\n}\n\n// Settings page (redirects to general settings)\nadminSettingsRoutes.get('/', (c) => {\n  return c.redirect('/admin/settings/general')\n})\n\n// General settings\nadminSettingsRoutes.get('/general', async (c) => {\n  const user = c.get('user')\n  const db = c.env.DB\n  const settingsService = new SettingsService(db)\n\n  // Get real general settings from database\n  const generalSettings = await settingsService.getGeneralSettings(user?.email)\n\n  const mockSettings = getMockSettings(user)\n  mockSettings.general = generalSettings\n\n  const pageData: SettingsPageData = {\n    user: user ? {\n      name: user.email,\n      email: user.email,\n      role: user.role\n    } : undefined,\n    settings: mockSettings,\n    activeTab: 'general',\n    version: c.get('appVersion')\n  }\n  return c.html(renderSettingsPage(pageData))\n})\n\n// Appearance settings\nadminSettingsRoutes.get('/appearance', (c) => {\n  const user = c.get('user')\n  const pageData: SettingsPageData = {\n    user: user ? {\n      name: user.email,\n      email: user.email,\n      role: user.role\n    } : undefined,\n    settings: getMockSettings(user),\n    activeTab: 'appearance',\n    version: c.get('appVersion')\n  }\n  return c.html(renderSettingsPage(pageData))\n})\n\n// Security settings\nadminSettingsRoutes.get('/security', (c) => {\n  const user = c.get('user')\n  const pageData: SettingsPageData = {\n    user: user ? {\n      name: user.email,\n      email: user.email,\n      role: user.role\n    } : undefined,\n    settings: getMockSettings(user),\n    activeTab: 'security',\n    version: c.get('appVersion')\n  }\n  return c.html(renderSettingsPage(pageData))\n})\n\n// Notifications settings\nadminSettingsRoutes.get('/notifications', (c) => {\n  const user = c.get('user')\n  const pageData: SettingsPageData = {\n    user: user ? {\n      name: user.email,\n      email: user.email,\n      role: user.role\n    } : undefined,\n    settings: getMockSettings(user),\n    activeTab: 'notifications',\n    version: c.get('appVersion')\n  }\n  return c.html(renderSettingsPage(pageData))\n})\n\n// Storage settings\nadminSettingsRoutes.get('/storage', (c) => {\n  const user = c.get('user')\n  const pageData: SettingsPageData = {\n    user: user ? {\n      name: user.email,\n      email: user.email,\n      role: user.role\n    } : undefined,\n    settings: getMockSettings(user),\n    activeTab: 'storage',\n    version: c.get('appVersion')\n  }\n  return c.html(renderSettingsPage(pageData))\n})\n\n// Migrations settings\nadminSettingsRoutes.get('/migrations', (c) => {\n  const user = c.get('user')\n  const pageData: SettingsPageData = {\n    user: user ? {\n      name: user.email,\n      email: user.email,\n      role: user.role\n    } : undefined,\n    settings: getMockSettings(user),\n    activeTab: 'migrations',\n    version: c.get('appVersion')\n  }\n  return c.html(renderSettingsPage(pageData))\n})\n\n// Database tools settings\nadminSettingsRoutes.get('/database-tools', (c) => {\n  const user = c.get('user')\n  const pageData: SettingsPageData = {\n    user: user ? {\n      name: user.email,\n      email: user.email,\n      role: user.role\n    } : undefined,\n    settings: getMockSettings(user),\n    activeTab: 'database-tools',\n    version: c.get('appVersion')\n  }\n  return c.html(renderSettingsPage(pageData))\n})\n\n// Get migration status\nadminSettingsRoutes.get('/api/migrations/status', async (c) => {\n  try {\n    const db = c.env.DB\n    const migrationService = new MigrationService(db)\n    const status = await migrationService.getMigrationStatus()\n\n    return c.json({\n      success: true,\n      data: status\n    })\n  } catch (error) {\n    console.error('Error fetching migration status:', error)\n    return c.json({\n      success: false,\n      error: 'Failed to fetch migration status'\n    }, 500)\n  }\n})\n\n// Run pending migrations\nadminSettingsRoutes.post('/api/migrations/run', async (c) => {\n  try {\n    const user = c.get('user')\n\n    // Only allow admin users to run migrations\n    if (!user || user.role !== 'admin') {\n      return c.json({\n        success: false,\n        error: 'Unauthorized. Admin access required.'\n      }, 403)\n    }\n\n    const db = c.env.DB\n    const migrationService = new MigrationService(db)\n    const result = await migrationService.runPendingMigrations()\n\n    return c.json({\n      success: result.success,\n      message: result.message,\n      applied: result.applied\n    })\n  } catch (error) {\n    console.error('Error running migrations:', error)\n    return c.json({\n      success: false,\n      error: 'Failed to run migrations'\n    }, 500)\n  }\n})\n\n// Validate database schema\nadminSettingsRoutes.get('/api/migrations/validate', async (c) => {\n  try {\n    const db = c.env.DB\n    const migrationService = new MigrationService(db)\n    const validation = await migrationService.validateSchema()\n\n    return c.json({\n      success: true,\n      data: validation\n    })\n  } catch (error) {\n    console.error('Error validating schema:', error)\n    return c.json({\n      success: false,\n      error: 'Failed to validate schema'\n    }, 500)\n  }\n})\n\n// Get database tools stats\nadminSettingsRoutes.get('/api/database-tools/stats', async (c) => {\n  try {\n    const db = c.env.DB\n\n    // Get list of all tables\n    const tablesQuery = await db.prepare(`\n      SELECT name FROM sqlite_master\n      WHERE type='table'\n      AND name NOT LIKE 'sqlite_%'\n      AND name NOT LIKE '_cf_%'\n      ORDER BY name\n    `).all()\n\n    const tables = tablesQuery.results || []\n    let totalRows = 0\n\n    // Get row count for each table\n    const tableStats = await Promise.all(\n      tables.map(async (table: any) => {\n        try {\n          const countResult = await db.prepare(`SELECT COUNT(*) as count FROM ${table.name}`).first()\n          const rowCount = (countResult as any)?.count || 0\n          totalRows += rowCount\n          return {\n            name: table.name,\n            rowCount\n          }\n        } catch (error) {\n          console.error(`Error counting rows in ${table.name}:`, error)\n          return {\n            name: table.name,\n            rowCount: 0\n          }\n        }\n      })\n    )\n\n    // D1 doesn't expose database size directly, so we'll estimate based on row counts\n    // Average row size estimate: 1KB per row (rough approximation)\n    const estimatedSizeBytes = totalRows * 1024\n    const databaseSizeMB = (estimatedSizeBytes / (1024 * 1024)).toFixed(2)\n\n    return c.json({\n      success: true,\n      data: {\n        totalTables: tables.length,\n        totalRows,\n        databaseSize: `${databaseSizeMB} MB (estimated)`,\n        tables: tableStats\n      }\n    })\n  } catch (error) {\n    console.error('Error fetching database stats:', error)\n    return c.json({\n      success: false,\n      error: 'Failed to fetch database statistics'\n    }, 500)\n  }\n})\n\n// Validate database\nadminSettingsRoutes.get('/api/database-tools/validate', async (c) => {\n  try {\n    const db = c.env.DB\n\n    // Run PRAGMA integrity_check\n    const integrityResult = await db.prepare('PRAGMA integrity_check').first()\n    const isValid = (integrityResult as any)?.integrity_check === 'ok'\n\n    return c.json({\n      success: true,\n      data: {\n        valid: isValid,\n        message: isValid ? 'Database integrity check passed' : 'Database integrity check failed'\n      }\n    })\n  } catch (error) {\n    console.error('Error validating database:', error)\n    return c.json({\n      success: false,\n      error: 'Failed to validate database'\n    }, 500)\n  }\n})\n\n// Backup database\nadminSettingsRoutes.post('/api/database-tools/backup', async (c) => {\n  try {\n    const user = c.get('user')\n\n    // Only allow admin users\n    if (!user || user.role !== 'admin') {\n      return c.json({\n        success: false,\n        error: 'Unauthorized. Admin access required.'\n      }, 403)\n    }\n\n    // TODO: Implement actual backup functionality\n    // For now, return success message\n    return c.json({\n      success: true,\n      message: 'Database backup feature coming soon. Use Cloudflare Dashboard for backups.'\n    })\n  } catch (error) {\n    console.error('Error creating backup:', error)\n    return c.json({\n      success: false,\n      error: 'Failed to create backup'\n    }, 500)\n  }\n})\n\n// Truncate tables\nadminSettingsRoutes.post('/api/database-tools/truncate', async (c) => {\n  try {\n    const user = c.get('user')\n\n    // Only allow admin users\n    if (!user || user.role !== 'admin') {\n      return c.json({\n        success: false,\n        error: 'Unauthorized. Admin access required.'\n      }, 403)\n    }\n\n    const body = await c.req.json()\n    const tablesToTruncate = body.tables || []\n\n    if (!Array.isArray(tablesToTruncate) || tablesToTruncate.length === 0) {\n      return c.json({\n        success: false,\n        error: 'No tables specified for truncation'\n      }, 400)\n    }\n\n    const db = c.env.DB\n    const results = []\n\n    for (const tableName of tablesToTruncate) {\n      try {\n        await db.prepare(`DELETE FROM ${tableName}`).run()\n        results.push({ table: tableName, success: true })\n      } catch (error) {\n        console.error(`Error truncating ${tableName}:`, error)\n        results.push({ table: tableName, success: false, error: String(error) })\n      }\n    }\n\n    return c.json({\n      success: true,\n      message: `Truncated ${results.filter(r => r.success).length} of ${tablesToTruncate.length} tables`,\n      results\n    })\n  } catch (error) {\n    console.error('Error truncating tables:', error)\n    return c.json({\n      success: false,\n      error: 'Failed to truncate tables'\n    }, 500)\n  }\n})\n\n// Save general settings\nadminSettingsRoutes.post('/general', async (c) => {\n  try {\n    const user = c.get('user')\n\n    if (!user || user.role !== 'admin') {\n      return c.json({\n        success: false,\n        error: 'Unauthorized. Admin access required.'\n      }, 403)\n    }\n\n    const formData = await c.req.formData()\n    const db = c.env.DB\n    const settingsService = new SettingsService(db)\n\n    // Extract general settings from form data\n    const settings = {\n      siteName: formData.get('siteName') as string,\n      siteDescription: formData.get('siteDescription') as string,\n      adminEmail: formData.get('adminEmail') as string,\n      timezone: formData.get('timezone') as string,\n      language: formData.get('language') as string,\n      maintenanceMode: formData.get('maintenanceMode') === 'true'\n    }\n\n    // Validate required fields\n    if (!settings.siteName || !settings.siteDescription) {\n      return c.json({\n        success: false,\n        error: 'Site name and description are required'\n      }, 400)\n    }\n\n    // Save settings to database\n    const success = await settingsService.saveGeneralSettings(settings)\n\n    if (success) {\n      return c.json({\n        success: true,\n        message: 'General settings saved successfully!'\n      })\n    } else {\n      return c.json({\n        success: false,\n        error: 'Failed to save settings'\n      }, 500)\n    }\n  } catch (error) {\n    console.error('Error saving general settings:', error)\n    return c.json({\n      success: false,\n      error: 'Failed to save settings. Please try again.'\n    }, 500)\n  }\n})\n\n// Save settings (legacy endpoint - redirect to general)\nadminSettingsRoutes.post('/', async (c) => {\n  return c.redirect('/admin/settings/general')\n})\n","/**\n * Routes Module Exports\n */\n\n// API routes\nexport { default as apiRoutes } from './api'\nexport { default as apiContentCrudRoutes } from './api-content-crud'\nexport { default as apiMediaRoutes } from './api-media'\nexport { default as apiSystemRoutes } from './api-system'\nexport { default as adminApiRoutes } from './admin-api'\n\n// Auth routes\nexport { default as authRoutes } from './auth'\n\n// Test routes (only for development/test environments)\nexport { default as testCleanupRoutes } from './test-cleanup'\n\n// Admin UI routes\nexport { default as adminContentRoutes } from './admin-content'\nexport { userRoutes as adminUsersRoutes } from './admin-users'\nexport { adminLogsRoutes } from './admin-logs'\nexport { adminDashboardRoutes } from './admin-dashboard'\nexport { adminSettingsRoutes } from './admin-settings'\n\nexport const ROUTES_INFO = {\n  message: 'Core routes available',\n  available: [\n    'apiRoutes',\n    'apiContentCrudRoutes',\n    'apiMediaRoutes',\n    'apiSystemRoutes',\n    'adminApiRoutes',\n    'authRoutes',\n    'testCleanupRoutes',\n    'adminContentRoutes',\n    'adminUsersRoutes',\n    'adminLogsRoutes',\n    'adminDashboardRoutes',\n    'adminSettingsRoutes',\n  ],\n  status: 'Core package routes ready',\n  reference: 'https://github.com/badmuriss/warpcms'\n} as const\n"]}